/*! Wardrobe 2013-06-01 */
(function(t,e){function n(t,e){var n=t.createElement("p"),r=t.getElementsByTagName("head")[0]||t.documentElement;return n.innerHTML="x<style>"+e+"</style>",r.insertBefore(n.lastChild,r.firstChild)}function r(){var t=h.elements;return"string"==typeof t?t.split(" "):t}function i(t){var e={},n=t.createElement,i=t.createDocumentFragment,o=i();t.createElement=function(t){if(!h.shivMethods)return n(t);var r;return r=e[t]?e[t].cloneNode():c.test(t)?(e[t]=n(t)).cloneNode():n(t),r.canHaveChildren&&!u.test(t)?o.appendChild(r):r},t.createDocumentFragment=Function("h,f","return function(){var n=f.cloneNode(),c=n.createElement;h.shivMethods&&("+r().join().replace(/\w+/g,function(t){return n(t),o.createElement(t),'c("'+t+'")'})+");return n}")(h,o)}function o(t){var e;return t.documentShived?t:(h.shivCSS&&!s&&(e=!!n(t,"article,aside,details,figcaption,figure,footer,header,hgroup,nav,section{display:block}audio{display:none}canvas,video{display:inline-block;*display:inline;*zoom:1}[hidden]{display:none}audio[controls]{display:inline-block;*display:inline;*zoom:1}mark{background:#FF0;color:#000}")),l||(e=!i(t)),e&&(t.documentShived=e),t)}var s,l,a=t.html5||{},u=/^<|^(?:button|form|map|select|textarea|object|iframe|option|optgroup)$/i,c=/^<|^(?:a|b|button|code|div|fieldset|form|h1|h2|h3|h4|h5|h6|i|iframe|img|input|label|li|link|ol|option|p|param|q|script|select|span|strong|style|table|tbody|td|textarea|tfoot|th|thead|tr|ul)$/i;(function(){var n=e.createElement("a");n.innerHTML="<xyz></xyz>",s="hidden"in n,s&&"function"==typeof injectElementWithStyles&&injectElementWithStyles("#modernizr{}",function(e){e.hidden=!0,s="none"==(t.getComputedStyle?getComputedStyle(e,null):e.currentStyle).display}),l=1==n.childNodes.length||function(){try{e.createElement("a")}catch(t){return!0}var n=e.createDocumentFragment();return n.cloneNode===void 0||n.createDocumentFragment===void 0||n.createElement===void 0}()})();var h={elements:a.elements||"abbr article aside audio bdi canvas data datalist details figcaption figure footer header hgroup mark meter nav output progress section summary time video",shivCSS:!(a.shivCSS===!1),shivMethods:!(a.shivMethods===!1),type:"default",shivDocument:o};t.html5=h,o(e)})(this,document),function(){var t=this,e=t._,n={},r=Array.prototype,i=Object.prototype,o=Function.prototype,s=r.push,l=r.slice,a=r.concat,u=i.toString,c=i.hasOwnProperty,h=r.forEach,f=r.map,d=r.reduce,p=r.reduceRight,g=r.filter,m=r.every,v=r.some,y=r.indexOf,_=r.lastIndexOf,w=Array.isArray,b=Object.keys,x=o.bind,C=function(t){return t instanceof C?t:this instanceof C?(this._wrapped=t,void 0):new C(t)};"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=C),exports._=C):t._=C,C.VERSION="1.4.4";var k=C.each=C.forEach=function(t,e,r){if(null!=t)if(h&&t.forEach===h)t.forEach(e,r);else if(t.length===+t.length){for(var i=0,o=t.length;o>i;i++)if(e.call(r,t[i],i,t)===n)return}else for(var s in t)if(C.has(t,s)&&e.call(r,t[s],s,t)===n)return};C.map=C.collect=function(t,e,n){var r=[];return null==t?r:f&&t.map===f?t.map(e,n):(k(t,function(t,i,o){r[r.length]=e.call(n,t,i,o)}),r)};var L="Reduce of empty array with no initial value";C.reduce=C.foldl=C.inject=function(t,e,n,r){var i=arguments.length>2;if(null==t&&(t=[]),d&&t.reduce===d)return r&&(e=C.bind(e,r)),i?t.reduce(e,n):t.reduce(e);if(k(t,function(t,o,s){i?n=e.call(r,n,t,o,s):(n=t,i=!0)}),!i)throw new TypeError(L);return n},C.reduceRight=C.foldr=function(t,e,n,r){var i=arguments.length>2;if(null==t&&(t=[]),p&&t.reduceRight===p)return r&&(e=C.bind(e,r)),i?t.reduceRight(e,n):t.reduceRight(e);var o=t.length;if(o!==+o){var s=C.keys(t);o=s.length}if(k(t,function(l,a,u){a=s?s[--o]:--o,i?n=e.call(r,n,t[a],a,u):(n=t[a],i=!0)}),!i)throw new TypeError(L);return n},C.find=C.detect=function(t,e,n){var r;return S(t,function(t,i,o){return e.call(n,t,i,o)?(r=t,!0):void 0}),r},C.filter=C.select=function(t,e,n){var r=[];return null==t?r:g&&t.filter===g?t.filter(e,n):(k(t,function(t,i,o){e.call(n,t,i,o)&&(r[r.length]=t)}),r)},C.reject=function(t,e,n){return C.filter(t,function(t,r,i){return!e.call(n,t,r,i)},n)},C.every=C.all=function(t,e,r){e||(e=C.identity);var i=!0;return null==t?i:m&&t.every===m?t.every(e,r):(k(t,function(t,o,s){return(i=i&&e.call(r,t,o,s))?void 0:n}),!!i)};var S=C.some=C.any=function(t,e,r){e||(e=C.identity);var i=!1;return null==t?i:v&&t.some===v?t.some(e,r):(k(t,function(t,o,s){return i||(i=e.call(r,t,o,s))?n:void 0}),!!i)};C.contains=C.include=function(t,e){return null==t?!1:y&&t.indexOf===y?-1!=t.indexOf(e):S(t,function(t){return t===e})},C.invoke=function(t,e){var n=l.call(arguments,2),r=C.isFunction(e);return C.map(t,function(t){return(r?e:t[e]).apply(t,n)})},C.pluck=function(t,e){return C.map(t,function(t){return t[e]})},C.where=function(t,e,n){return C.isEmpty(e)?n?null:[]:C[n?"find":"filter"](t,function(t){for(var n in e)if(e[n]!==t[n])return!1;return!0})},C.findWhere=function(t,e){return C.where(t,e,!0)},C.max=function(t,e,n){if(!e&&C.isArray(t)&&t[0]===+t[0]&&65535>t.length)return Math.max.apply(Math,t);if(!e&&C.isEmpty(t))return-1/0;var r={computed:-1/0,value:-1/0};return k(t,function(t,i,o){var s=e?e.call(n,t,i,o):t;s>=r.computed&&(r={value:t,computed:s})}),r.value},C.min=function(t,e,n){if(!e&&C.isArray(t)&&t[0]===+t[0]&&65535>t.length)return Math.min.apply(Math,t);if(!e&&C.isEmpty(t))return 1/0;var r={computed:1/0,value:1/0};return k(t,function(t,i,o){var s=e?e.call(n,t,i,o):t;r.computed>s&&(r={value:t,computed:s})}),r.value},C.shuffle=function(t){var e,n=0,r=[];return k(t,function(t){e=C.random(n++),r[n-1]=r[e],r[e]=t}),r};var M=function(t){return C.isFunction(t)?t:function(e){return e[t]}};C.sortBy=function(t,e,n){var r=M(e);return C.pluck(C.map(t,function(t,e,i){return{value:t,index:e,criteria:r.call(n,t,e,i)}}).sort(function(t,e){var n=t.criteria,r=e.criteria;if(n!==r){if(n>r||void 0===n)return 1;if(r>n||void 0===r)return-1}return t.index<e.index?-1:1}),"value")};var T=function(t,e,n,r){var i={},o=M(e||C.identity);return k(t,function(e,s){var l=o.call(n,e,s,t);r(i,l,e)}),i};C.groupBy=function(t,e,n){return T(t,e,n,function(t,e,n){(C.has(t,e)?t[e]:t[e]=[]).push(n)})},C.countBy=function(t,e,n){return T(t,e,n,function(t,e){C.has(t,e)||(t[e]=0),t[e]++})},C.sortedIndex=function(t,e,n,r){n=null==n?C.identity:M(n);for(var i=n.call(r,e),o=0,s=t.length;s>o;){var l=o+s>>>1;i>n.call(r,t[l])?o=l+1:s=l}return o},C.toArray=function(t){return t?C.isArray(t)?l.call(t):t.length===+t.length?C.map(t,C.identity):C.values(t):[]},C.size=function(t){return null==t?0:t.length===+t.length?t.length:C.keys(t).length},C.first=C.head=C.take=function(t,e,n){return null==t?void 0:null==e||n?t[0]:l.call(t,0,e)},C.initial=function(t,e,n){return l.call(t,0,t.length-(null==e||n?1:e))},C.last=function(t,e,n){return null==t?void 0:null==e||n?t[t.length-1]:l.call(t,Math.max(t.length-e,0))},C.rest=C.tail=C.drop=function(t,e,n){return l.call(t,null==e||n?1:e)},C.compact=function(t){return C.filter(t,C.identity)};var E=function(t,e,n){return k(t,function(t){C.isArray(t)?e?s.apply(n,t):E(t,e,n):n.push(t)}),n};C.flatten=function(t,e){return E(t,e,[])},C.without=function(t){return C.difference(t,l.call(arguments,1))},C.uniq=C.unique=function(t,e,n,r){C.isFunction(e)&&(r=n,n=e,e=!1);var i=n?C.map(t,n,r):t,o=[],s=[];return k(i,function(n,r){(e?r&&s[s.length-1]===n:C.contains(s,n))||(s.push(n),o.push(t[r]))}),o},C.union=function(){return C.uniq(a.apply(r,arguments))},C.intersection=function(t){var e=l.call(arguments,1);return C.filter(C.uniq(t),function(t){return C.every(e,function(e){return C.indexOf(e,t)>=0})})},C.difference=function(t){var e=a.apply(r,l.call(arguments,1));return C.filter(t,function(t){return!C.contains(e,t)})},C.zip=function(){for(var t=l.call(arguments),e=C.max(C.pluck(t,"length")),n=Array(e),r=0;e>r;r++)n[r]=C.pluck(t,""+r);return n},C.object=function(t,e){if(null==t)return{};for(var n={},r=0,i=t.length;i>r;r++)e?n[t[r]]=e[r]:n[t[r][0]]=t[r][1];return n},C.indexOf=function(t,e,n){if(null==t)return-1;var r=0,i=t.length;if(n){if("number"!=typeof n)return r=C.sortedIndex(t,e),t[r]===e?r:-1;r=0>n?Math.max(0,i+n):n}if(y&&t.indexOf===y)return t.indexOf(e,n);for(;i>r;r++)if(t[r]===e)return r;return-1},C.lastIndexOf=function(t,e,n){if(null==t)return-1;var r=null!=n;if(_&&t.lastIndexOf===_)return r?t.lastIndexOf(e,n):t.lastIndexOf(e);for(var i=r?n:t.length;i--;)if(t[i]===e)return i;return-1},C.range=function(t,e,n){1>=arguments.length&&(e=t||0,t=0),n=arguments[2]||1;for(var r=Math.max(Math.ceil((e-t)/n),0),i=0,o=Array(r);r>i;)o[i++]=t,t+=n;return o},C.bind=function(t,e){if(t.bind===x&&x)return x.apply(t,l.call(arguments,1));var n=l.call(arguments,2);return function(){return t.apply(e,n.concat(l.call(arguments)))}},C.partial=function(t){var e=l.call(arguments,1);return function(){return t.apply(this,e.concat(l.call(arguments)))}},C.bindAll=function(t){var e=l.call(arguments,1);return 0===e.length&&(e=C.functions(t)),k(e,function(e){t[e]=C.bind(t[e],t)}),t},C.memoize=function(t,e){var n={};return e||(e=C.identity),function(){var r=e.apply(this,arguments);return C.has(n,r)?n[r]:n[r]=t.apply(this,arguments)}},C.delay=function(t,e){var n=l.call(arguments,2);return setTimeout(function(){return t.apply(null,n)},e)},C.defer=function(t){return C.delay.apply(C,[t,1].concat(l.call(arguments,1)))},C.throttle=function(t,e){var n,r,i,o,s=0,l=function(){s=new Date,i=null,o=t.apply(n,r)};return function(){var a=new Date,u=e-(a-s);return n=this,r=arguments,0>=u?(clearTimeout(i),i=null,s=a,o=t.apply(n,r)):i||(i=setTimeout(l,u)),o}},C.debounce=function(t,e,n){var r,i;return function(){var o=this,s=arguments,l=function(){r=null,n||(i=t.apply(o,s))},a=n&&!r;return clearTimeout(r),r=setTimeout(l,e),a&&(i=t.apply(o,s)),i}},C.once=function(t){var e,n=!1;return function(){return n?e:(n=!0,e=t.apply(this,arguments),t=null,e)}},C.wrap=function(t,e){return function(){var n=[t];return s.apply(n,arguments),e.apply(this,n)}},C.compose=function(){var t=arguments;return function(){for(var e=arguments,n=t.length-1;n>=0;n--)e=[t[n].apply(this,e)];return e[0]}},C.after=function(t,e){return 0>=t?e():function(){return 1>--t?e.apply(this,arguments):void 0}},C.keys=b||function(t){if(t!==Object(t))throw new TypeError("Invalid object");var e=[];for(var n in t)C.has(t,n)&&(e[e.length]=n);return e},C.values=function(t){var e=[];for(var n in t)C.has(t,n)&&e.push(t[n]);return e},C.pairs=function(t){var e=[];for(var n in t)C.has(t,n)&&e.push([n,t[n]]);return e},C.invert=function(t){var e={};for(var n in t)C.has(t,n)&&(e[t[n]]=n);return e},C.functions=C.methods=function(t){var e=[];for(var n in t)C.isFunction(t[n])&&e.push(n);return e.sort()},C.extend=function(t){return k(l.call(arguments,1),function(e){if(e)for(var n in e)t[n]=e[n]}),t},C.pick=function(t){var e={},n=a.apply(r,l.call(arguments,1));return k(n,function(n){n in t&&(e[n]=t[n])}),e},C.omit=function(t){var e={},n=a.apply(r,l.call(arguments,1));for(var i in t)C.contains(n,i)||(e[i]=t[i]);return e},C.defaults=function(t){return k(l.call(arguments,1),function(e){if(e)for(var n in e)null==t[n]&&(t[n]=e[n])}),t},C.clone=function(t){return C.isObject(t)?C.isArray(t)?t.slice():C.extend({},t):t},C.tap=function(t,e){return e(t),t};var A=function(t,e,n,r){if(t===e)return 0!==t||1/t==1/e;if(null==t||null==e)return t===e;t instanceof C&&(t=t._wrapped),e instanceof C&&(e=e._wrapped);var i=u.call(t);if(i!=u.call(e))return!1;switch(i){case"[object String]":return t==e+"";case"[object Number]":return t!=+t?e!=+e:0==t?1/t==1/e:t==+e;case"[object Date]":case"[object Boolean]":return+t==+e;case"[object RegExp]":return t.source==e.source&&t.global==e.global&&t.multiline==e.multiline&&t.ignoreCase==e.ignoreCase}if("object"!=typeof t||"object"!=typeof e)return!1;for(var o=n.length;o--;)if(n[o]==t)return r[o]==e;n.push(t),r.push(e);var s=0,l=!0;if("[object Array]"==i){if(s=t.length,l=s==e.length)for(;s--&&(l=A(t[s],e[s],n,r)););}else{var a=t.constructor,c=e.constructor;if(a!==c&&!(C.isFunction(a)&&a instanceof a&&C.isFunction(c)&&c instanceof c))return!1;for(var h in t)if(C.has(t,h)&&(s++,!(l=C.has(e,h)&&A(t[h],e[h],n,r))))break;if(l){for(h in e)if(C.has(e,h)&&!s--)break;l=!s}}return n.pop(),r.pop(),l};C.isEqual=function(t,e){return A(t,e,[],[])},C.isEmpty=function(t){if(null==t)return!0;if(C.isArray(t)||C.isString(t))return 0===t.length;for(var e in t)if(C.has(t,e))return!1;return!0},C.isElement=function(t){return!(!t||1!==t.nodeType)},C.isArray=w||function(t){return"[object Array]"==u.call(t)},C.isObject=function(t){return t===Object(t)},k(["Arguments","Function","String","Number","Date","RegExp"],function(t){C["is"+t]=function(e){return u.call(e)=="[object "+t+"]"}}),C.isArguments(arguments)||(C.isArguments=function(t){return!(!t||!C.has(t,"callee"))}),C.isFunction=function(t){return"function"==typeof t},C.isFinite=function(t){return isFinite(t)&&!isNaN(parseFloat(t))},C.isNaN=function(t){return C.isNumber(t)&&t!=+t},C.isBoolean=function(t){return t===!0||t===!1||"[object Boolean]"==u.call(t)},C.isNull=function(t){return null===t},C.isUndefined=function(t){return void 0===t},C.has=function(t,e){return c.call(t,e)},C.noConflict=function(){return t._=e,this},C.identity=function(t){return t},C.times=function(t,e,n){for(var r=Array(t),i=0;t>i;i++)r[i]=e.call(n,i);return r},C.random=function(t,e){return null==e&&(e=t,t=0),t+Math.floor(Math.random()*(e-t+1))};var O={escape:{"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","/":"&#x2F;"}};O.unescape=C.invert(O.escape);var N={escape:RegExp("["+C.keys(O.escape).join("")+"]","g"),unescape:RegExp("("+C.keys(O.unescape).join("|")+")","g")};C.each(["escape","unescape"],function(t){C[t]=function(e){return null==e?"":(""+e).replace(N[t],function(e){return O[t][e]})}}),C.result=function(t,e){if(null==t)return null;var n=t[e];return C.isFunction(n)?n.call(t):n},C.mixin=function(t){k(C.functions(t),function(e){var n=C[e]=t[e];C.prototype[e]=function(){var t=[this._wrapped];return s.apply(t,arguments),D.call(this,n.apply(C,t))}})};var H=0;C.uniqueId=function(t){var e=++H+"";return t?t+e:e},C.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var P=/(.)^/,I={"'":"'","\\":"\\","\r":"r","\n":"n","	":"t","\u2028":"u2028","\u2029":"u2029"},R=/\\|'|\r|\n|\t|\u2028|\u2029/g;C.template=function(t,e,n){var r;n=C.defaults({},n,C.templateSettings);var i=RegExp([(n.escape||P).source,(n.interpolate||P).source,(n.evaluate||P).source].join("|")+"|$","g"),o=0,s="__p+='";t.replace(i,function(e,n,r,i,l){return s+=t.slice(o,l).replace(R,function(t){return"\\"+I[t]}),n&&(s+="'+\n((__t=("+n+"))==null?'':_.escape(__t))+\n'"),r&&(s+="'+\n((__t=("+r+"))==null?'':__t)+\n'"),i&&(s+="';\n"+i+"\n__p+='"),o=l+e.length,e}),s+="';\n",n.variable||(s="with(obj||{}){\n"+s+"}\n"),s="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+s+"return __p;\n";try{r=Function(n.variable||"obj","_",s)}catch(l){throw l.source=s,l}if(e)return r(e,C);var a=function(t){return r.call(this,t,C)};return a.source="function("+(n.variable||"obj")+"){\n"+s+"}",a},C.chain=function(t){return C(t).chain()};var D=function(t){return this._chain?C(t).chain():t};C.mixin(C),k(["pop","push","reverse","shift","sort","splice","unshift"],function(t){var e=r[t];C.prototype[t]=function(){var n=this._wrapped;return e.apply(n,arguments),"shift"!=t&&"splice"!=t||0!==n.length||delete n[0],D.call(this,n)}}),k(["concat","join","slice"],function(t){var e=r[t];C.prototype[t]=function(){return D.call(this,e.apply(this._wrapped,arguments))}}),C.extend(C.prototype,{chain:function(){return this._chain=!0,this},value:function(){return this._wrapped}})}.call(this),function(){var Backbone,t=this,e=t.Backbone,n=[],r=n.push,i=n.slice,o=n.splice;Backbone="undefined"!=typeof exports?exports:t.Backbone={},Backbone.VERSION="1.0.0";var s=t._;s||"undefined"==typeof require||(s=require("underscore")),Backbone.$=t.jQuery||t.Zepto||t.ender||t.$,Backbone.noConflict=function(){return t.Backbone=e,this},Backbone.emulateHTTP=!1,Backbone.emulateJSON=!1;var l=Backbone.Events={on:function(t,e,n){if(!u(this,"on",t,[e,n])||!e)return this;this._events||(this._events={});var r=this._events[t]||(this._events[t]=[]);return r.push({callback:e,context:n,ctx:n||this}),this},once:function(t,e,n){if(!u(this,"once",t,[e,n])||!e)return this;var r=this,i=s.once(function(){r.off(t,i),e.apply(this,arguments)});return i._callback=e,this.on(t,i,n)},off:function(t,e,n){var r,i,o,l,a,c,h,f;if(!this._events||!u(this,"off",t,[e,n]))return this;if(!t&&!e&&!n)return this._events={},this;for(l=t?[t]:s.keys(this._events),a=0,c=l.length;c>a;a++)if(t=l[a],o=this._events[t]){if(this._events[t]=r=[],e||n)for(h=0,f=o.length;f>h;h++)i=o[h],(e&&e!==i.callback&&e!==i.callback._callback||n&&n!==i.context)&&r.push(i);r.length||delete this._events[t]}return this},trigger:function(t){if(!this._events)return this;var e=i.call(arguments,1);if(!u(this,"trigger",t,e))return this;var n=this._events[t],r=this._events.all;return n&&c(n,e),r&&c(r,arguments),this},stopListening:function(t,e,n){var r=this._listeners;if(!r)return this;var i=!e&&!n;"object"==typeof e&&(n=this),t&&((r={})[t._listenerId]=t);for(var o in r)r[o].off(e,n,this),i&&delete this._listeners[o];return this}},a=/\s+/,u=function(t,e,n,r){if(!n)return!0;if("object"==typeof n){for(var i in n)t[e].apply(t,[i,n[i]].concat(r));return!1}if(a.test(n)){for(var o=n.split(a),s=0,l=o.length;l>s;s++)t[e].apply(t,[o[s]].concat(r));return!1}return!0},c=function(t,e){var n,r=-1,i=t.length,o=e[0],s=e[1],l=e[2];switch(e.length){case 0:for(;i>++r;)(n=t[r]).callback.call(n.ctx);return;case 1:for(;i>++r;)(n=t[r]).callback.call(n.ctx,o);return;case 2:for(;i>++r;)(n=t[r]).callback.call(n.ctx,o,s);return;case 3:for(;i>++r;)(n=t[r]).callback.call(n.ctx,o,s,l);return;default:for(;i>++r;)(n=t[r]).callback.apply(n.ctx,e)}},h={listenTo:"on",listenToOnce:"once"};s.each(h,function(t,e){l[e]=function(e,n,r){var i=this._listeners||(this._listeners={}),o=e._listenerId||(e._listenerId=s.uniqueId("l"));return i[o]=e,"object"==typeof n&&(r=this),e[t](n,r,this),this}}),l.bind=l.on,l.unbind=l.off,s.extend(Backbone,l);var f=Backbone.Model=function(t,e){var n,r=t||{};e||(e={}),this.cid=s.uniqueId("c"),this.attributes={},s.extend(this,s.pick(e,d)),e.parse&&(r=this.parse(r,e)||{}),(n=s.result(this,"defaults"))&&(r=s.defaults({},r,n)),this.set(r,e),this.changed={},this.initialize.apply(this,arguments)},d=["url","urlRoot","collection"];s.extend(f.prototype,l,{changed:null,validationError:null,idAttribute:"id",initialize:function(){},toJSON:function(){return s.clone(this.attributes)},sync:function(){return Backbone.sync.apply(this,arguments)},get:function(t){return this.attributes[t]},escape:function(t){return s.escape(this.get(t))},has:function(t){return null!=this.get(t)},set:function(t,e,n){var r,i,o,l,a,u,c,h;if(null==t)return this;if("object"==typeof t?(i=t,n=e):(i={})[t]=e,n||(n={}),!this._validate(i,n))return!1;o=n.unset,a=n.silent,l=[],u=this._changing,this._changing=!0,u||(this._previousAttributes=s.clone(this.attributes),this.changed={}),h=this.attributes,c=this._previousAttributes,this.idAttribute in i&&(this.id=i[this.idAttribute]);for(r in i)e=i[r],s.isEqual(h[r],e)||l.push(r),s.isEqual(c[r],e)?delete this.changed[r]:this.changed[r]=e,o?delete h[r]:h[r]=e;if(!a){l.length&&(this._pending=!0);for(var f=0,d=l.length;d>f;f++)this.trigger("change:"+l[f],this,h[l[f]],n)}if(u)return this;if(!a)for(;this._pending;)this._pending=!1,this.trigger("change",this,n);return this._pending=!1,this._changing=!1,this},unset:function(t,e){return this.set(t,void 0,s.extend({},e,{unset:!0}))},clear:function(t){var e={};for(var n in this.attributes)e[n]=void 0;return this.set(e,s.extend({},t,{unset:!0}))},hasChanged:function(t){return null==t?!s.isEmpty(this.changed):s.has(this.changed,t)},changedAttributes:function(t){if(!t)return this.hasChanged()?s.clone(this.changed):!1;var e,n=!1,r=this._changing?this._previousAttributes:this.attributes;for(var i in t)s.isEqual(r[i],e=t[i])||((n||(n={}))[i]=e);return n},previous:function(t){return null!=t&&this._previousAttributes?this._previousAttributes[t]:null},previousAttributes:function(){return s.clone(this._previousAttributes)},fetch:function(t){t=t?s.clone(t):{},void 0===t.parse&&(t.parse=!0);var e=this,n=t.success;return t.success=function(r){return e.set(e.parse(r,t),t)?(n&&n(e,r,t),e.trigger("sync",e,r,t),void 0):!1},R(this,t),this.sync("read",this,t)},save:function(t,e,n){var r,i,o,l=this.attributes;if(null==t||"object"==typeof t?(r=t,n=e):(r={})[t]=e,!(!r||n&&n.wait||this.set(r,n)))return!1;if(n=s.extend({validate:!0},n),!this._validate(r,n))return!1;r&&n.wait&&(this.attributes=s.extend({},l,r)),void 0===n.parse&&(n.parse=!0);var a=this,u=n.success;return n.success=function(t){a.attributes=l;var e=a.parse(t,n);return n.wait&&(e=s.extend(r||{},e)),s.isObject(e)&&!a.set(e,n)?!1:(u&&u(a,t,n),a.trigger("sync",a,t,n),void 0)},R(this,n),i=this.isNew()?"create":n.patch?"patch":"update","patch"===i&&(n.attrs=r),o=this.sync(i,this,n),r&&n.wait&&(this.attributes=l),o},destroy:function(t){t=t?s.clone(t):{};var e=this,n=t.success,r=function(){e.trigger("destroy",e,e.collection,t)};if(t.success=function(i){(t.wait||e.isNew())&&r(),n&&n(e,i,t),e.isNew()||e.trigger("sync",e,i,t)},this.isNew())return t.success(),!1;R(this,t);var i=this.sync("delete",this,t);return t.wait||r(),i},url:function(){var t=s.result(this,"urlRoot")||s.result(this.collection,"url")||I();return this.isNew()?t:t+("/"===t.charAt(t.length-1)?"":"/")+encodeURIComponent(this.id)},parse:function(t){return t},clone:function(){return new this.constructor(this.attributes)},isNew:function(){return null==this.id},isValid:function(t){return this._validate({},s.extend(t||{},{validate:!0}))},_validate:function(t,e){if(!e.validate||!this.validate)return!0;t=s.extend({},this.attributes,t);var n=this.validationError=this.validate(t,e)||null;return n?(this.trigger("invalid",this,n,s.extend(e||{},{validationError:n})),!1):!0}});var p=["keys","values","pairs","invert","pick","omit"];s.each(p,function(t){f.prototype[t]=function(){var e=i.call(arguments);return e.unshift(this.attributes),s[t].apply(s,e)}});var g=Backbone.Collection=function(t,e){e||(e={}),e.url&&(this.url=e.url),e.model&&(this.model=e.model),void 0!==e.comparator&&(this.comparator=e.comparator),this._reset(),this.initialize.apply(this,arguments),t&&this.reset(t,s.extend({silent:!0},e))},m={add:!0,remove:!0,merge:!0},v={add:!0,merge:!1,remove:!1};s.extend(g.prototype,l,{model:f,initialize:function(){},toJSON:function(t){return this.map(function(e){return e.toJSON(t)})},sync:function(){return Backbone.sync.apply(this,arguments)},add:function(t,e){return this.set(t,s.defaults(e||{},v))},remove:function(t,e){t=s.isArray(t)?t.slice():[t],e||(e={});var n,r,i,o;for(n=0,r=t.length;r>n;n++)o=this.get(t[n]),o&&(delete this._byId[o.id],delete this._byId[o.cid],i=this.indexOf(o),this.models.splice(i,1),this.length--,e.silent||(e.index=i,o.trigger("remove",o,this,e)),this._removeReference(o));return this},set:function(t,e){e=s.defaults(e||{},m),e.parse&&(t=this.parse(t,e)),s.isArray(t)||(t=t?[t]:[]);var n,i,l,a,u,c=e.at,h=this.comparator&&null==c&&e.sort!==!1,f=s.isString(this.comparator)?this.comparator:null,d=[],p=[],g={};for(n=0,i=t.length;i>n;n++)(l=this._prepareModel(t[n],e))&&((a=this.get(l))?(e.remove&&(g[a.cid]=!0),e.merge&&(a.set(l.attributes,e),h&&!u&&a.hasChanged(f)&&(u=!0))):e.add&&(d.push(l),l.on("all",this._onModelEvent,this),this._byId[l.cid]=l,null!=l.id&&(this._byId[l.id]=l)));if(e.remove){for(n=0,i=this.length;i>n;++n)g[(l=this.models[n]).cid]||p.push(l);p.length&&this.remove(p,e)}if(d.length&&(h&&(u=!0),this.length+=d.length,null!=c?o.apply(this.models,[c,0].concat(d)):r.apply(this.models,d)),u&&this.sort({silent:!0}),e.silent)return this;for(n=0,i=d.length;i>n;n++)(l=d[n]).trigger("add",l,this,e);return u&&this.trigger("sort",this,e),this},reset:function(t,e){e||(e={});for(var n=0,r=this.models.length;r>n;n++)this._removeReference(this.models[n]);return e.previousModels=this.models,this._reset(),this.add(t,s.extend({silent:!0},e)),e.silent||this.trigger("reset",this,e),this},push:function(t,e){return t=this._prepareModel(t,e),this.add(t,s.extend({at:this.length},e)),t},pop:function(t){var e=this.at(this.length-1);return this.remove(e,t),e},unshift:function(t,e){return t=this._prepareModel(t,e),this.add(t,s.extend({at:0},e)),t},shift:function(t){var e=this.at(0);return this.remove(e,t),e},slice:function(t,e){return this.models.slice(t,e)},get:function(t){return null==t?void 0:this._byId[null!=t.id?t.id:t.cid||t]},at:function(t){return this.models[t]},where:function(t,e){return s.isEmpty(t)?e?void 0:[]:this[e?"find":"filter"](function(e){for(var n in t)if(t[n]!==e.get(n))return!1;return!0})},findWhere:function(t){return this.where(t,!0)},sort:function(t){if(!this.comparator)throw Error("Cannot sort a set without a comparator");return t||(t={}),s.isString(this.comparator)||1===this.comparator.length?this.models=this.sortBy(this.comparator,this):this.models.sort(s.bind(this.comparator,this)),t.silent||this.trigger("sort",this,t),this},sortedIndex:function(t,e,n){e||(e=this.comparator);var r=s.isFunction(e)?e:function(t){return t.get(e)};return s.sortedIndex(this.models,t,r,n)},pluck:function(t){return s.invoke(this.models,"get",t)},fetch:function(t){t=t?s.clone(t):{},void 0===t.parse&&(t.parse=!0);var e=t.success,n=this;return t.success=function(r){var i=t.reset?"reset":"set";n[i](r,t),e&&e(n,r,t),n.trigger("sync",n,r,t)},R(this,t),this.sync("read",this,t)},create:function(t,e){if(e=e?s.clone(e):{},!(t=this._prepareModel(t,e)))return!1;e.wait||this.add(t,e);var n=this,r=e.success;return e.success=function(i){e.wait&&n.add(t,e),r&&r(t,i,e)},t.save(null,e),t},parse:function(t){return t},clone:function(){return new this.constructor(this.models)},_reset:function(){this.length=0,this.models=[],this._byId={}},_prepareModel:function(t,e){if(t instanceof f)return t.collection||(t.collection=this),t;e||(e={}),e.collection=this;var n=new this.model(t,e);return n._validate(t,e)?n:(this.trigger("invalid",this,t,e),!1)},_removeReference:function(t){this===t.collection&&delete t.collection,t.off("all",this._onModelEvent,this)},_onModelEvent:function(t,e,n,r){("add"!==t&&"remove"!==t||n===this)&&("destroy"===t&&this.remove(e,r),e&&t==="change:"+e.idAttribute&&(delete this._byId[e.previous(e.idAttribute)],null!=e.id&&(this._byId[e.id]=e)),this.trigger.apply(this,arguments))}});var y=["forEach","each","map","collect","reduce","foldl","inject","reduceRight","foldr","find","detect","filter","select","reject","every","all","some","any","include","contains","invoke","max","min","toArray","size","first","head","take","initial","rest","tail","drop","last","without","indexOf","shuffle","lastIndexOf","isEmpty","chain"];s.each(y,function(t){g.prototype[t]=function(){var e=i.call(arguments);return e.unshift(this.models),s[t].apply(s,e)}});var _=["groupBy","countBy","sortBy"];s.each(_,function(t){g.prototype[t]=function(e,n){var r=s.isFunction(e)?e:function(t){return t.get(e)};return s[t](this.models,r,n)}});var w=Backbone.View=function(t){this.cid=s.uniqueId("view"),this._configure(t||{}),this._ensureElement(),this.initialize.apply(this,arguments),this.delegateEvents()},b=/^(\S+)\s*(.*)$/,x=["model","collection","el","id","attributes","className","tagName","events"];s.extend(w.prototype,l,{tagName:"div",$:function(t){return this.$el.find(t)},initialize:function(){},render:function(){return this},remove:function(){return this.$el.remove(),this.stopListening(),this},setElement:function(t,e){return this.$el&&this.undelegateEvents(),this.$el=t instanceof Backbone.$?t:Backbone.$(t),this.el=this.$el[0],e!==!1&&this.delegateEvents(),this},delegateEvents:function(t){if(!t&&!(t=s.result(this,"events")))return this;this.undelegateEvents();for(var e in t){var n=t[e];if(s.isFunction(n)||(n=this[t[e]]),n){var r=e.match(b),i=r[1],o=r[2];n=s.bind(n,this),i+=".delegateEvents"+this.cid,""===o?this.$el.on(i,n):this.$el.on(i,o,n)}}return this},undelegateEvents:function(){return this.$el.off(".delegateEvents"+this.cid),this},_configure:function(t){this.options&&(t=s.extend({},s.result(this,"options"),t)),s.extend(this,s.pick(t,x)),this.options=t},_ensureElement:function(){if(this.el)this.setElement(s.result(this,"el"),!1);else{var t=s.extend({},s.result(this,"attributes"));this.id&&(t.id=s.result(this,"id")),this.className&&(t["class"]=s.result(this,"className"));var e=Backbone.$("<"+s.result(this,"tagName")+">").attr(t);this.setElement(e,!1)}}}),Backbone.sync=function(t,e,n){var r=C[t];s.defaults(n||(n={}),{emulateHTTP:Backbone.emulateHTTP,emulateJSON:Backbone.emulateJSON});var i={type:r,dataType:"json"};if(n.url||(i.url=s.result(e,"url")||I()),null!=n.data||!e||"create"!==t&&"update"!==t&&"patch"!==t||(i.contentType="application/json",i.data=JSON.stringify(n.attrs||e.toJSON(n))),n.emulateJSON&&(i.contentType="application/x-www-form-urlencoded",i.data=i.data?{model:i.data}:{}),n.emulateHTTP&&("PUT"===r||"DELETE"===r||"PATCH"===r)){i.type="POST",n.emulateJSON&&(i.data._method=r);var o=n.beforeSend;n.beforeSend=function(t){return t.setRequestHeader("X-HTTP-Method-Override",r),o?o.apply(this,arguments):void 0}}"GET"===i.type||n.emulateJSON||(i.processData=!1),"PATCH"!==i.type||!window.ActiveXObject||window.external&&window.external.msActiveXFilteringEnabled||(i.xhr=function(){return new ActiveXObject("Microsoft.XMLHTTP")});var l=n.xhr=Backbone.ajax(s.extend(i,n));return e.trigger("request",e,l,n),l};var C={create:"POST",update:"PUT",patch:"PATCH","delete":"DELETE",read:"GET"};Backbone.ajax=function(){return Backbone.$.ajax.apply(Backbone.$,arguments)};var k=Backbone.Router=function(t){t||(t={}),t.routes&&(this.routes=t.routes),this._bindRoutes(),this.initialize.apply(this,arguments)},L=/\((.*?)\)/g,S=/(\(\?)?:\w+/g,M=/\*\w+/g,T=/[\-{}\[\]+?.,\\\^$|#\s]/g;s.extend(k.prototype,l,{initialize:function(){},route:function(t,e,n){s.isRegExp(t)||(t=this._routeToRegExp(t)),s.isFunction(e)&&(n=e,e=""),n||(n=this[e]);var r=this;return Backbone.history.route(t,function(i){var o=r._extractParameters(t,i);n&&n.apply(r,o),r.trigger.apply(r,["route:"+e].concat(o)),r.trigger("route",e,o),Backbone.history.trigger("route",r,e,o)}),this},navigate:function(t,e){return Backbone.history.navigate(t,e),this},_bindRoutes:function(){if(this.routes){this.routes=s.result(this,"routes");for(var t,e=s.keys(this.routes);null!=(t=e.pop());)this.route(t,this.routes[t])}},_routeToRegExp:function(t){return t=t.replace(T,"\\$&").replace(L,"(?:$1)?").replace(S,function(t,e){return e?t:"([^/]+)"}).replace(M,"(.*?)"),RegExp("^"+t+"$")},_extractParameters:function(t,e){var n=t.exec(e).slice(1);return s.map(n,function(t){return t?decodeURIComponent(t):null})}});var E=Backbone.History=function(){this.handlers=[],s.bindAll(this,"checkUrl"),"undefined"!=typeof window&&(this.location=window.location,this.history=window.history)},A=/^[#\/]|\s+$/g,O=/^\/+|\/+$/g,N=/msie [\w.]+/,H=/\/$/;E.started=!1,s.extend(E.prototype,l,{interval:50,getHash:function(t){var e=(t||this).location.href.match(/#(.*)$/);return e?e[1]:""},getFragment:function(t,e){if(null==t)if(this._hasPushState||!this._wantsHashChange||e){t=this.location.pathname;var n=this.root.replace(H,"");t.indexOf(n)||(t=t.substr(n.length))}else t=this.getHash();return t.replace(A,"")},start:function(t){if(E.started)throw Error("Backbone.history has already been started");E.started=!0,this.options=s.extend({},{root:"/"},this.options,t),this.root=this.options.root,this._wantsHashChange=this.options.hashChange!==!1,this._wantsPushState=!!this.options.pushState,this._hasPushState=!!(this.options.pushState&&this.history&&this.history.pushState);var e=this.getFragment(),n=document.documentMode,r=N.exec(navigator.userAgent.toLowerCase())&&(!n||7>=n);this.root=("/"+this.root+"/").replace(O,"/"),r&&this._wantsHashChange&&(this.iframe=Backbone.$('<iframe src="javascript:0" tabindex="-1" />').hide().appendTo("body")[0].contentWindow,this.navigate(e)),this._hasPushState?Backbone.$(window).on("popstate",this.checkUrl):this._wantsHashChange&&"onhashchange"in window&&!r?Backbone.$(window).on("hashchange",this.checkUrl):this._wantsHashChange&&(this._checkUrlInterval=setInterval(this.checkUrl,this.interval)),this.fragment=e;
var i=this.location,o=i.pathname.replace(/[^\/]$/,"$&/")===this.root;return this._wantsHashChange&&this._wantsPushState&&!this._hasPushState&&!o?(this.fragment=this.getFragment(null,!0),this.location.replace(this.root+this.location.search+"#"+this.fragment),!0):(this._wantsPushState&&this._hasPushState&&o&&i.hash&&(this.fragment=this.getHash().replace(A,""),this.history.replaceState({},document.title,this.root+this.fragment+i.search)),this.options.silent?void 0:this.loadUrl())},stop:function(){Backbone.$(window).off("popstate",this.checkUrl).off("hashchange",this.checkUrl),clearInterval(this._checkUrlInterval),E.started=!1},route:function(t,e){this.handlers.unshift({route:t,callback:e})},checkUrl:function(){var t=this.getFragment();return t===this.fragment&&this.iframe&&(t=this.getFragment(this.getHash(this.iframe))),t===this.fragment?!1:(this.iframe&&this.navigate(t),this.loadUrl()||this.loadUrl(this.getHash()),void 0)},loadUrl:function(t){var e=this.fragment=this.getFragment(t),n=s.any(this.handlers,function(t){return t.route.test(e)?(t.callback(e),!0):void 0});return n},navigate:function(t,e){if(!E.started)return!1;if(e&&e!==!0||(e={trigger:e}),t=this.getFragment(t||""),this.fragment!==t){this.fragment=t;var n=this.root+t;if(this._hasPushState)this.history[e.replace?"replaceState":"pushState"]({},document.title,n);else{if(!this._wantsHashChange)return this.location.assign(n);this._updateHash(this.location,t,e.replace),this.iframe&&t!==this.getFragment(this.getHash(this.iframe))&&(e.replace||this.iframe.document.open().close(),this._updateHash(this.iframe.location,t,e.replace))}e.trigger&&this.loadUrl(t)}},_updateHash:function(t,e,n){if(n){var r=t.href.replace(/(javascript:|#).*$/,"");t.replace(r+"#"+e)}else t.hash="#"+e}}),Backbone.history=new E;var P=function(t,e){var n,r=this;n=t&&s.has(t,"constructor")?t.constructor:function(){return r.apply(this,arguments)},s.extend(n,r,e);var i=function(){this.constructor=n};return i.prototype=r.prototype,n.prototype=new i,t&&s.extend(n.prototype,t),n.__super__=r.prototype,n};f.extend=g.extend=k.extend=w.extend=E.extend=P;var I=function(){throw Error('A "url" property or function must be specified')},R=function(t,e){var n=e.error;e.error=function(r){n&&n(t,r,e),t.trigger("error",t,r,e)}}}.call(this),Backbone.ChildViewContainer=function(Backbone,t){var e=function(t){this._views={},this._indexByModel={},this._indexByCollection={},this._indexByCustom={},this._updateLength(),this._addInitialViews(t)};t.extend(e.prototype,{add:function(t,e){var n=t.cid;this._views[n]=t,t.model&&(this._indexByModel[t.model.cid]=n),t.collection&&(this._indexByCollection[t.collection.cid]=n),e&&(this._indexByCustom[e]=n),this._updateLength()},findByModel:function(t){var e=this._indexByModel[t.cid];return this.findByCid(e)},findByCollection:function(t){var e=this._indexByCollection[t.cid];return this.findByCid(e)},findByCustom:function(t){var e=this._indexByCustom[t];return this.findByCid(e)},findByIndex:function(e){return t.values(this._views)[e]},findByCid:function(t){return this._views[t]},remove:function(t){var e=t.cid;t.model&&delete this._indexByModel[t.model.cid],t.collection&&delete this._indexByCollection[t.collection.cid];var n;for(var r in this._indexByCustom)if(this._indexByCustom.hasOwnProperty(r)&&this._indexByCustom[r]===e){n=r;break}n&&delete this._indexByCustom[n],delete this._views[e],this._updateLength()},call:function(t,e){e=Array.prototype.slice.call(arguments,1),this.apply(t,e)},apply:function(e,n){n=n||[],t.each(this._views,function(r){t.isFunction(r[e])&&r[e].apply(r,n)})},_updateLength:function(){this.length=t.size(this._views)},_addInitialViews:function(t){if(t){var e,n,r=t.length;for(n=0;r>n;n++)e=t[n],this.add(e)}}});var n=["forEach","each","map","find","detect","filter","select","reject","every","all","some","any","include","contains","invoke","toArray","first","initial","rest","last","without","isEmpty","pluck"];return t.each(n,function(n){e.prototype[n]=function(){var e=t.values(this._views),r=[e].concat(t.toArray(arguments));return t[n].apply(t,r)}}),e}(Backbone,_),Backbone.Wreqr=function(Backbone,t,e){"use strict";var n={};return n.Handlers=function(Backbone,t){var e=function(e){this.options=e,this._wreqrHandlers={},t.isFunction(this.initialize)&&this.initialize(e)};return e.extend=Backbone.Model.extend,t.extend(e.prototype,Backbone.Events,{setHandlers:function(e){t.each(e,function(e,n){var r=null;t.isObject(e)&&!t.isFunction(e)&&(r=e.context,e=e.callback),this.setHandler(n,e,r)},this)},setHandler:function(t,e,n){var r={callback:e,context:n};this._wreqrHandlers[t]=r,this.trigger("handler:add",t,e,n)},hasHandler:function(t){return!!this._wreqrHandlers[t]},getHandler:function(t){var e=this._wreqrHandlers[t];if(!e)throw Error("Handler not found for '"+t+"'");return function(){var t=Array.prototype.slice.apply(arguments);return e.callback.apply(e.context,t)}},removeHandler:function(t){delete this._wreqrHandlers[t]},removeAllHandlers:function(){this._wreqrHandlers={}}}),e}(Backbone,e),n.CommandStorage=function(){var t=function(t){this.options=t,this._commands={},e.isFunction(this.initialize)&&this.initialize(t)};return e.extend(t.prototype,Backbone.Events,{getCommands:function(t){var e=this._commands[t];return e||(e={command:t,instances:[]},this._commands[t]=e),e},addCommand:function(t,e){var n=this.getCommands(t);n.instances.push(e)},clearCommands:function(t){var e=this.getCommands(t);e.instances=[]}}),t}(),n.Commands=function(t){return t.Handlers.extend({storageType:t.CommandStorage,constructor:function(e){this.options=e||{},this._initializeStorage(this.options),this.on("handler:add",this._executeCommands,this);var n=Array.prototype.slice.call(arguments);t.Handlers.prototype.constructor.apply(this,n)},execute:function(t,e){t=arguments[0],e=Array.prototype.slice.call(arguments,1),this.hasHandler(t)?this.getHandler(t).apply(this,e):this.storage.addCommand(t,e)},_executeCommands:function(t,n,r){var i=this.storage.getCommands(t);e.each(i.instances,function(t){n.apply(r,t)}),this.storage.clearCommands(t)},_initializeStorage:function(t){var n,r=t.storageType||this.storageType;n=e.isFunction(r)?new r:r,this.storage=n}})}(n),n.RequestResponse=function(t){return t.Handlers.extend({request:function(){var t=arguments[0],e=Array.prototype.slice.call(arguments,1);return this.getHandler(t).apply(this,e)}})}(n),n.EventAggregator=function(Backbone,t){var e=function(){};return e.extend=Backbone.Model.extend,t.extend(e.prototype,Backbone.Events),e}(Backbone,e),n}(Backbone,Backbone.Marionette,_);var Marionette=function(t,Backbone,e){"use strict";function n(t){return o.call(t)}function r(t,e){var n=Error(t);throw n.name=e||"Error",n}var i={};Backbone.Marionette=i,i.$=Backbone.$;var o=Array.prototype.slice;return i.extend=Backbone.Model.extend,i.getOption=function(t,e){if(t&&e){var n;return n=t.options&&e in t.options&&void 0!==t.options[e]?t.options[e]:t[e]}},i.triggerMethod=function(){function t(t,e,n){return n.toUpperCase()}var n=/(^|:)(\w)/gi,r=function(r){var i="on"+r.replace(n,t),o=this[i];return this.trigger.apply(this,arguments),e.isFunction(o)?o.apply(this,e.tail(arguments)):void 0};return r}(),i.MonitorDOMRefresh=function(){function t(t){t._isShown=!0,r(t)}function n(t){t._isRendered=!0,r(t)}function r(t){t._isShown&&t._isRendered&&e.isFunction(t.triggerMethod)&&t.triggerMethod("dom:refresh")}return function(e){e.listenTo(e,"show",function(){t(e)}),e.listenTo(e,"render",function(){n(e)})}}(),function(t){function n(t,n,i,o){var s=o.split(/\s+/);e.each(s,function(e){var o=t[e];o||r("Method '"+e+"' was configured as an event handler, but does not exist."),t.listenTo(n,i,o,t)})}function i(t,e,n,r){t.listenTo(e,n,r,t)}function o(t,n,r,i){var o=i.split(/\s+/);e.each(o,function(){var e=t[e];t.stopListening(n,r,e,t)})}function s(t,e,n,r){t.stopListening(e,n,r,t)}function l(t,n,r,i,o){n&&r&&(e.isFunction(r)&&(r=r.call(t)),e.each(r,function(r,s){e.isFunction(r)?i(t,n,s,r):o(t,n,s,r)}))}t.bindEntityEvents=function(t,e,r){l(t,e,r,i,n)},t.unbindEntityEvents=function(t,e,n){l(t,e,n,s,o)}}(i),i.Callbacks=function(){this._deferred=i.$.Deferred(),this._callbacks=[]},e.extend(i.Callbacks.prototype,{add:function(t,e){this._callbacks.push({cb:t,ctx:e}),this._deferred.done(function(n,r){e&&(n=e),t.call(n,r)})},run:function(t,e){this._deferred.resolve(e,t)},reset:function(){var t=this._callbacks;this._deferred=i.$.Deferred(),this._callbacks=[],e.each(t,function(t){this.add(t.cb,t.ctx)},this)}}),i.Controller=function(t){this.triggerMethod=i.triggerMethod,this.options=t||{},e.isFunction(this.initialize)&&this.initialize(this.options)},i.Controller.extend=i.extend,e.extend(i.Controller.prototype,Backbone.Events,{close:function(){this.stopListening(),this.triggerMethod("close"),this.unbind()}}),i.Region=function(t){if(this.options=t||{},this.el=i.getOption(this,"el"),!this.el){var e=Error("An 'el' must be specified for a region.");throw e.name="NoElError",e}if(this.initialize){var n=Array.prototype.slice.apply(arguments);this.initialize.apply(this,n)}},e.extend(i.Region,{buildRegion:function(t,n){var r="string"==typeof t,i="string"==typeof t.selector,o=t.regionType===void 0,s="function"==typeof t;if(!s&&!r&&!i)throw Error("Region must be specified as a Region type, a selector string or an object with selector property");var l,a;r&&(l=t),t.selector&&(l=t.selector),s&&(a=t),!s&&o&&(a=n),t.regionType&&(a=t.regionType);var u=new a({el:l});return t.parentEl&&(u.getEl=function(n){var r=t.parentEl;return e.isFunction(r)&&(r=r()),r.find(n)}),u}}),e.extend(i.Region.prototype,Backbone.Events,{show:function(t){this.ensureEl(),t!==this.currentView?(this.close(),t.render(),this.open(t)):t.render(),i.triggerMethod.call(t,"show"),i.triggerMethod.call(this,"show",t),this.currentView=t},ensureEl:function(){this.$el&&0!==this.$el.length||(this.$el=this.getEl(this.el))},getEl:function(t){return i.$(t)},open:function(t){this.$el.empty().append(t.el)},close:function(){var t=this.currentView;t&&!t.isClosed&&(t.close?t.close():t.remove&&t.remove(),i.triggerMethod.call(this,"close"),delete this.currentView)},attachView:function(t){this.currentView=t},reset:function(){this.close(),delete this.$el}}),i.Region.extend=i.extend,i.RegionManager=function(t){var n=t.Controller.extend({constructor:function(e){this._regions={},t.Controller.prototype.constructor.call(this,e)},addRegions:function(t,n){var r={};return e.each(t,function(t,i){"string"==typeof t&&(t={selector:t}),t.selector&&(t=e.defaults({},t,n));var o=this.addRegion(i,t);r[i]=o},this),r},addRegion:function(n,r){var i,o=e.isObject(r),s=e.isString(r),l=!!r.selector;return i=s||o&&l?t.Region.buildRegion(r,t.Region):e.isFunction(r)?t.Region.buildRegion(r,t.Region):r,this._store(n,i),this.triggerMethod("region:add",n,i),i},get:function(t){return this._regions[t]},removeRegion:function(t){var e=this._regions[t];this._remove(t,e)},removeRegions:function(){e.each(this._regions,function(t,e){this._remove(e,t)},this)},closeRegions:function(){e.each(this._regions,function(t){t.close()},this)},close:function(){this.removeRegions();var e=Array.prototype.slice.call(arguments);t.Controller.prototype.close.apply(this,e)},_store:function(t,n){this._regions[t]=n,this.length=e.size(this._regions)},_remove:function(t,e){e.close(),delete this._regions[t],this.triggerMethod("region:remove",t,e)}}),r=["forEach","each","map","find","detect","filter","select","reject","every","all","some","any","include","contains","invoke","toArray","first","initial","rest","last","without","isEmpty","pluck"];return e.each(r,function(t){n.prototype[t]=function(){var n=e.values(this._regions),r=[n].concat(e.toArray(arguments));return e[t].apply(e,r)}}),n}(i),i.TemplateCache=function(t){this.templateId=t},e.extend(i.TemplateCache,{templateCaches:{},get:function(t){var e=this.templateCaches[t];return e||(e=new i.TemplateCache(t),this.templateCaches[t]=e),e.load()},clear:function(){var t,e=n(arguments),r=e.length;if(r>0)for(t=0;r>t;t++)delete this.templateCaches[e[t]];else this.templateCaches={}}}),e.extend(i.TemplateCache.prototype,{load:function(){if(this.compiledTemplate)return this.compiledTemplate;var t=this.loadTemplate(this.templateId);return this.compiledTemplate=this.compileTemplate(t),this.compiledTemplate},loadTemplate:function(t){var e=i.$(t).html();return e&&0!==e.length||r("Could not find template: '"+t+"'","NoTemplateError"),e},compileTemplate:function(t){return e.template(t)}}),i.Renderer={render:function(t,e){var n="function"==typeof t?t:i.TemplateCache.get(t);return n(e)}},i.View=Backbone.View.extend({constructor:function(){e.bindAll(this,"render");var t=Array.prototype.slice.apply(arguments);Backbone.View.prototype.constructor.apply(this,t),i.MonitorDOMRefresh(this),this.listenTo(this,"show",this.onShowCalled,this)},triggerMethod:i.triggerMethod,getTemplate:function(){return i.getOption(this,"template")},mixinTemplateHelpers:function(t){t=t||{};var n=this.templateHelpers;return e.isFunction(n)&&(n=n.call(this)),e.extend(t,n)},configureTriggers:function(){if(this.triggers){var t={},n=e.result(this,"triggers");return e.each(n,function(e,n){t[n]=function(t){t&&t.preventDefault&&t.preventDefault(),t&&t.stopPropagation&&t.stopPropagation();var n={view:this,model:this.model,collection:this.collection};this.triggerMethod(e,n)}},this),t}},delegateEvents:function(t){this._delegateDOMEvents(t),i.bindEntityEvents(this,this.model,i.getOption(this,"modelEvents")),i.bindEntityEvents(this,this.collection,i.getOption(this,"collectionEvents"))},_delegateDOMEvents:function(t){t=t||this.events,e.isFunction(t)&&(t=t.call(this));var n={},r=this.configureTriggers();e.extend(n,t,r),Backbone.View.prototype.delegateEvents.call(this,n)},undelegateEvents:function(){var t=Array.prototype.slice.call(arguments);Backbone.View.prototype.undelegateEvents.apply(this,t),i.unbindEntityEvents(this,this.model,i.getOption(this,"modelEvents")),i.unbindEntityEvents(this,this.collection,i.getOption(this,"collectionEvents"))},onShowCalled:function(){},close:function(){if(!this.isClosed){var t=this.triggerMethod("before:close");t!==!1&&(this.isClosed=!0,this.triggerMethod("close"),this.unbindUIElements(),this.remove())}},bindUIElements:function(){if(this.ui){this._uiBindings||(this._uiBindings=this.ui);var t=e.result(this,"_uiBindings");this.ui={},e.each(e.keys(t),function(e){var n=t[e];this.ui[e]=this.$(n)},this)}},unbindUIElements:function(){this.ui&&(e.each(this.ui,function(t,e){delete this.ui[e]},this),this.ui=this._uiBindings,delete this._uiBindings)}}),i.ItemView=i.View.extend({constructor:function(){i.View.prototype.constructor.apply(this,n(arguments))},serializeData:function(){var t={};return this.model?t=this.model.toJSON():this.collection&&(t={items:this.collection.toJSON()}),t},render:function(){this.isClosed=!1,this.triggerMethod("before:render",this),this.triggerMethod("item:before:render",this);var t=this.serializeData();t=this.mixinTemplateHelpers(t);var e=this.getTemplate(),n=i.Renderer.render(e,t);return this.$el.html(n),this.bindUIElements(),this.triggerMethod("render",this),this.triggerMethod("item:rendered",this),this},close:function(){this.isClosed||(this.triggerMethod("item:before:close"),i.View.prototype.close.apply(this,n(arguments)),this.triggerMethod("item:closed"))}}),i.CollectionView=i.View.extend({itemViewEventPrefix:"itemview",constructor:function(){this._initChildViewStorage(),i.View.prototype.constructor.apply(this,n(arguments)),this._initialEvents()},_initialEvents:function(){this.collection&&(this.listenTo(this.collection,"add",this.addChildView,this),this.listenTo(this.collection,"remove",this.removeItemView,this),this.listenTo(this.collection,"reset",this.render,this))},addChildView:function(t){this.closeEmptyView();var e=this.getItemView(t),n=this.collection.indexOf(t);this.addItemView(t,e,n)},onShowCalled:function(){this.children.each(function(t){i.triggerMethod.call(t,"show")})},triggerBeforeRender:function(){this.triggerMethod("before:render",this),this.triggerMethod("collection:before:render",this)},triggerRendered:function(){this.triggerMethod("render",this),this.triggerMethod("collection:rendered",this)},render:function(){return this.isClosed=!1,this.triggerBeforeRender(),this._renderChildren(),this.triggerRendered(),this},_renderChildren:function(){this.closeEmptyView(),this.closeChildren(),this.collection&&this.collection.length>0?this.showCollection():this.showEmptyView()},showCollection:function(){var t;this.collection.each(function(e,n){t=this.getItemView(e),this.addItemView(e,t,n)},this)},showEmptyView:function(){var t=i.getOption(this,"emptyView");if(t&&!this._showingEmptyView){this._showingEmptyView=!0;var e=new Backbone.Model;this.addItemView(e,t,0)}},closeEmptyView:function(){this._showingEmptyView&&(this.closeChildren(),delete this._showingEmptyView)},getItemView:function(){var t=i.getOption(this,"itemView");return t||r("An `itemView` must be specified","NoItemViewError"),t},addItemView:function(t,n,r){var o=i.getOption(this,"itemViewOptions");e.isFunction(o)&&(o=o.call(this,t,r));var s=this.buildItemView(t,n,o);this.addChildViewEventForwarding(s),this.triggerMethod("before:item:added",s),this.children.add(s),this.renderItemView(s,r),this._isShown&&i.triggerMethod.call(s,"show"),this.triggerMethod("after:item:added",s)},addChildViewEventForwarding:function(t){var e=i.getOption(this,"itemViewEventPrefix");this.listenTo(t,"all",function(){var r=n(arguments);r[0]=e+":"+r[0],r.splice(1,0,t),i.triggerMethod.apply(this,r)},this)},renderItemView:function(t,e){t.render(),this.appendHtml(this,t,e)},buildItemView:function(t,n,r){var i=e.extend({model:t},r);return new n(i)},removeItemView:function(t){var e=this.children.findByModel(t);this.removeChildView(e),this.checkEmpty()},removeChildView:function(t){t&&(this.stopListening(t),t.close?t.close():t.remove&&t.remove(),this.children.remove(t)),this.triggerMethod("item:removed",t)},checkEmpty:function(){this.collection&&0!==this.collection.length||this.showEmptyView()},appendHtml:function(t,e){t.$el.append(e.el)},_initChildViewStorage:function(){this.children=new Backbone.ChildViewContainer},close:function(){this.isClosed||(this.triggerMethod("collection:before:close"),this.closeChildren(),this.triggerMethod("collection:closed"),i.View.prototype.close.apply(this,n(arguments)))},closeChildren:function(){this.children.each(function(t){this.removeChildView(t)},this),this.checkEmpty()}}),i.CompositeView=i.CollectionView.extend({constructor:function(){i.CollectionView.apply(this,n(arguments)),this.itemView=this.getItemView()},_initialEvents:function(){this.collection&&(this.listenTo(this.collection,"add",this.addChildView,this),this.listenTo(this.collection,"remove",this.removeItemView,this),this.listenTo(this.collection,"reset",this._renderChildren,this))},getItemView:function(){var t=i.getOption(this,"itemView")||this.constructor;return t||r("An `itemView` must be specified","NoItemViewError"),t},serializeData:function(){var t={};return this.model&&(t=this.model.toJSON()),t},render:function(){this.isRendered=!0,this.isClosed=!1,this.resetItemViewContainer(),this.triggerBeforeRender();var t=this.renderModel();return this.$el.html(t),this.bindUIElements(),this.triggerMethod("composite:model:rendered"),this._renderChildren(),this.triggerMethod("composite:rendered"),this.triggerRendered(),this},_renderChildren:function(){this.isRendered&&(i.CollectionView.prototype._renderChildren.call(this),this.triggerMethod("composite:collection:rendered"))},renderModel:function(){var t={};t=this.serializeData(),t=this.mixinTemplateHelpers(t);var e=this.getTemplate();return i.Renderer.render(e,t)},appendHtml:function(t,e){var n=this.getItemViewContainer(t);n.append(e.el)},getItemViewContainer:function(t){if("$itemViewContainer"in t)return t.$itemViewContainer;var n;if(t.itemViewContainer){var i=e.result(t,"itemViewContainer");n=t.$(i),0>=n.length&&r("The specified `itemViewContainer` was not found: "+t.itemViewContainer,"ItemViewContainerMissingError")}else n=t.$el;return t.$itemViewContainer=n,n},resetItemViewContainer:function(){this.$itemViewContainer&&delete this.$itemViewContainer}}),i.Layout=i.ItemView.extend({regionType:i.Region,constructor:function(t){t=t||{},this._firstRender=!0,this._initializeRegions(t),i.ItemView.call(this,t)},render:function(){this._firstRender?this._firstRender=!1:this.isClosed?this._initializeRegions():this._reInitializeRegions();var t=Array.prototype.slice.apply(arguments),e=i.ItemView.prototype.render.apply(this,t);return e},close:function(){if(!this.isClosed){this.regionManager.close();var t=Array.prototype.slice.apply(arguments);i.ItemView.prototype.close.apply(this,t)}},addRegion:function(t,e){var n={};return n[t]=e,this.addRegions(n)[t]},addRegions:function(t){return this.regions=e.extend(this.regions||{},t),this._buildRegions(t)},removeRegion:function(t){return this.regionManager.removeRegion(t)},_buildRegions:function(t){var e=this,n={parentEl:function(){return e.$el}};return this.regionManager.addRegions(t,n)},_initializeRegions:function(t){var n;this._initRegionManager(),n=e.isFunction(this.regions)?this.regions(t):this.regions||{},this.addRegions(n)},_reInitializeRegions:function(){this.regionManager.closeRegions(),this.regionManager.each(function(t){t.reset()})},_initRegionManager:function(){this.regionManager=new i.RegionManager,this.listenTo(this.regionManager,"region:add",function(t,e){this[t]=e,this.trigger("region:add",t,e)}),this.listenTo(this.regionManager,"region:remove",function(t,e){delete this[t],this.trigger("region:remove",t,e)})}}),i.AppRouter=Backbone.Router.extend({constructor:function(t){if(Backbone.Router.prototype.constructor.apply(this,n(arguments)),this.options=t,this.appRoutes){var e=i.getOption(this,"controller");this.processAppRoutes(e,this.appRoutes)}},processAppRoutes:function(t,n){var r=e.keys(n).reverse();e.each(r,function(r){var i=n[r],o=t[i];if(!o)throw Error("Method '"+i+"' was not found on the controller");this.route(r,i,e.bind(o,t))},this)}}),i.Application=function(t){this._initRegionManager(),this._initCallbacks=new i.Callbacks,this.vent=new Backbone.Wreqr.EventAggregator,this.commands=new Backbone.Wreqr.Commands,this.reqres=new Backbone.Wreqr.RequestResponse,this.submodules={},e.extend(this,t),this.triggerMethod=i.triggerMethod},e.extend(i.Application.prototype,Backbone.Events,{execute:function(){var t=Array.prototype.slice.apply(arguments);this.commands.execute.apply(this.commands,t)},request:function(){var t=Array.prototype.slice.apply(arguments);return this.reqres.request.apply(this.reqres,t)},addInitializer:function(t){this._initCallbacks.add(t)},start:function(t){this.triggerMethod("initialize:before",t),this._initCallbacks.run(t,this),this.triggerMethod("initialize:after",t),this.triggerMethod("start",t)},addRegions:function(t){return this._regionManager.addRegions(t)},removeRegion:function(t){this._regionManager.removeRegion(t)},module:function(){var t=n(arguments);return t.unshift(this),i.Module.create.apply(i.Module,t)},_initRegionManager:function(){this._regionManager=new i.RegionManager,this.listenTo(this._regionManager,"region:add",function(t,e){this[t]=e}),this.listenTo(this._regionManager,"region:remove",function(t){delete this[t]})}}),i.Application.extend=i.extend,i.Module=function(t,e){this.moduleName=t,this.submodules={},this._setupInitializersAndFinalizers(),this.app=e,this.startWithParent=!0,this.triggerMethod=i.triggerMethod},e.extend(i.Module.prototype,Backbone.Events,{addInitializer:function(t){this._initializerCallbacks.add(t)},addFinalizer:function(t){this._finalizerCallbacks.add(t)},start:function(t){this._isInitialized||(e.each(this.submodules,function(e){e.startWithParent&&e.start(t)}),this.triggerMethod("before:start",t),this._initializerCallbacks.run(t,this),this._isInitialized=!0,this.triggerMethod("start",t))},stop:function(){this._isInitialized&&(this._isInitialized=!1,i.triggerMethod.call(this,"before:stop"),e.each(this.submodules,function(t){t.stop()}),this._finalizerCallbacks.run(void 0,this),this._initializerCallbacks.reset(),this._finalizerCallbacks.reset(),i.triggerMethod.call(this,"stop"))},addDefinition:function(t,e){this._runModuleDefinition(t,e)},_runModuleDefinition:function(t,n){if(t){var r=e.flatten([this,this.app,Backbone,i,i.$,e,n]);t.apply(this,r)}},_setupInitializersAndFinalizers:function(){this._initializerCallbacks=new i.Callbacks,this._finalizerCallbacks=new i.Callbacks}}),e.extend(i.Module,{create:function(t,r,i){var o=t,s=n(arguments);s.splice(0,3),r=r.split(".");var l=r.length,a=[];return a[l-1]=i,e.each(r,function(e,n){var r=o;o=this._getModule(r,e,t),this._addModuleDefinition(r,o,a[n],s)},this),o},_getModule:function(t,e,n){var r=t[e];return r||(r=new i.Module(e,n),t[e]=r,t.submodules[e]=r),r},_addModuleDefinition:function(t,n,r,i){var o,s;e.isFunction(r)?(o=r,s=!0):e.isObject(r)?(o=r.define,s=r.startWithParent):s=!0,o&&n.addDefinition(o,i),n.startWithParent=n.startWithParent&&s,n.startWithParent&&!n.startWithParentIsConfigured&&(n.startWithParentIsConfigured=!0,t.addInitializer(function(t){n.startWithParent&&n.start(t)}))}}),i}(this,Backbone,_);(function(t){function e(t){this.init(t)}function n(t,e){e=e||t.getCursor("start");var n=t.getTokenAt(e);if(!n.type)return{};for(var r,i,o=n.type.split(" "),s={},l=0;o.length>l;l++)r=o[l],"strong"===r?s.bold=!0:"variable-2"===r?(i=t.getLine(e.line),/^\s*\d+\.\s/.test(i)?s["ordered-list"]=!0:s["unordered-list"]=!0):"atom"===r?s.quote=!0:"em"===r&&(s.italic=!0);return s}function r(t){return t=a?t.replace("Ctrl","Cmd"):t.replace("Cmd","Ctrl")}function i(t){var e=document,n=e.fullScreen||e.mozFullScreen||e.webkitFullScreen,r=function(){t.requestFullScreen?t.requestFullScreen():t.mozRequestFullScreen?t.mozRequestFullScreen():t.webkitRequestFullScreen&&t.webkitRequestFullScreen(Element.ALLOW_KEYBOARD_INPUT)},i=function(){e.cancelFullScreen?e.cancelFullScreen():e.mozCancelFullScreen?e.mozCancelFullScreen():e.webkitCancelFullScreen&&e.webkitCancelFullScreen()};n?i&&i():r()}var o=function(){"use strict";function t(n,r){if(!(this instanceof t))return new t(n,r);this.options=r=r||{};for(var i in Ui)!r.hasOwnProperty(i)&&Ui.hasOwnProperty(i)&&(r[i]=Ui[i]);f(r);var o="string"==typeof r.value?0:r.value.first,s=this.display=e(n,o);s.wrapper.CodeMirror=this,u(this),r.autofocus&&!Ti&&ue(this),this.state={keyMaps:[],overlays:[],modeGen:0,overwrite:!1,focused:!1,suppressEdits:!1,pasteIncoming:!1,draggingText:!1,highlight:new zr},l(this),r.lineWrapping&&(this.display.wrapper.className+=" CodeMirror-wrap");var a=r.value;"string"==typeof a&&(a=new io(r.value,r.mode)),ee(this,ar)(this,a),gi&&setTimeout(Jr(ae,this,!0),20),he(this);var c;try{c=document.activeElement==s.input}catch(h){}c||r.autofocus&&!Ti?setTimeout(Jr(Me,this),20):Te(this),ee(this,function(){for(var t in qi)qi.propertyIsEnumerable(t)&&qi[t](this,r[t],Gi);for(var e=0;Yi.length>e;++e)Yi[e](this)})()}function e(t,e){var n={},r=n.input=Zr("textarea",null,null,"position: absolute; padding: 0; width: 1px; height: 1em; outline: none; font-size: 4px;");yi?r.style.width="1000px":r.setAttribute("wrap","off"),Mi&&(r.style.border="1px solid black"),r.setAttribute("autocorrect","off"),r.setAttribute("autocapitalize","off"),n.inputDiv=Zr("div",[r],null,"overflow: hidden; position: relative; width: 3px; height: 0px;"),n.scrollbarH=Zr("div",[Zr("div",null,null,"height: 1px")],"CodeMirror-hscrollbar"),n.scrollbarV=Zr("div",[Zr("div",null,null,"width: 1px")],"CodeMirror-vscrollbar"),n.scrollbarFiller=Zr("div",null,"CodeMirror-scrollbar-filler"),n.lineDiv=Zr("div"),n.selectionDiv=Zr("div",null,null,"position: relative; z-index: 1"),n.cursor=Zr("div","","CodeMirror-cursor"),n.otherCursor=Zr("div","","CodeMirror-cursor CodeMirror-secondarycursor"),n.measure=Zr("div",null,"CodeMirror-measure"),n.lineSpace=Zr("div",[n.measure,n.selectionDiv,n.lineDiv,n.cursor,n.otherCursor],null,"position: relative; outline: none"),n.mover=Zr("div",[Zr("div",[n.lineSpace],"CodeMirror-lines")],null,"position: relative"),n.sizer=Zr("div",[n.mover],"CodeMirror-sizer"),n.heightForcer=Zr("div",null,null,"position: absolute; height: "+uo+"px; width: 1px;"),n.gutters=Zr("div",null,"CodeMirror-gutters"),n.lineGutter=null;var i=Zr("div",[n.sizer,n.heightForcer,n.gutters],null,"position: relative; min-height: 100%");return n.scroller=Zr("div",[i],"CodeMirror-scroll"),n.scroller.setAttribute("tabIndex","-1"),n.wrapper=Zr("div",[n.inputDiv,n.scrollbarH,n.scrollbarV,n.scrollbarFiller,n.scroller],"CodeMirror"),mi&&(n.gutters.style.zIndex=-1,n.scroller.style.paddingRight=0),t.appendChild?t.appendChild(n.wrapper):t(n.wrapper),Mi&&(r.style.width="0px"),yi||(n.scroller.draggable=!0),Ci?(n.inputDiv.style.height="1px",n.inputDiv.style.position="absolute"):mi&&(n.scrollbarH.style.minWidth=n.scrollbarV.style.minWidth="18px"),n.viewOffset=n.lastSizeC=0,n.showingFrom=n.showingTo=e,n.lineNumWidth=n.lineNumInnerWidth=n.lineNumChars=null,n.prevInput="",n.alignWidgets=!1,n.pollingFast=!1,n.poll=new zr,n.cachedCharWidth=n.cachedTextHeight=null,n.measureLineCache=[],n.measureLineCachePos=0,n.inaccurateSelection=!1,n.maxLine=null,n.maxLineLength=0,n.maxLineChanged=!1,n.wheelDX=n.wheelDY=n.wheelStartX=n.wheelStartY=null,n}function n(e){e.doc.mode=t.getMode(e.options,e.doc.modeOption),e.doc.iter(function(t){t.stateAfter&&(t.stateAfter=null),t.styles&&(t.styles=null)}),e.doc.frontier=e.doc.first,O(e,100),e.state.modeGen++,e.curOp&&ie(e)}function r(t){t.options.lineWrapping?(t.display.wrapper.className+=" CodeMirror-wrap",t.display.sizer.style.minWidth=""):(t.display.wrapper.className=t.display.wrapper.className.replace(" CodeMirror-wrap",""),h(t)),o(t),ie(t),j(t),setTimeout(function(){d(t.display,t.doc.height)},100)}function i(t){var e=Y(t.display),n=t.options.lineWrapping,r=n&&Math.max(5,t.display.scroller.clientWidth/Z(t.display)-3);return function(i){return Dn(t.doc,i)?0:n?(Math.ceil(i.text.length/r)||1)*e:e}}function o(t){var e=t.doc,n=i(t);e.iter(function(t){var e=n(t);e!=t.height&&fr(t,e)})}function s(t){var e=Qi[t.options.keyMap].style;t.display.wrapper.className=t.display.wrapper.className.replace(/\s*cm-keymap-\S+/g,"")+(e?" cm-keymap-"+e:"")}function l(t){t.display.wrapper.className=t.display.wrapper.className.replace(/\s*cm-s-\S+/g,"")+t.options.theme.replace(/(^|\s)\s*/g," cm-s-"),j(t)}function a(t){u(t),ie(t)}function u(t){var e=t.display.gutters,n=t.options.gutters;Qr(e);for(var r=0;n.length>r;++r){var i=n[r],o=e.appendChild(Zr("div",null,"CodeMirror-gutter "+i));"CodeMirror-linenumbers"==i&&(t.display.lineGutter=o,o.style.width=(t.display.lineNumWidth||1)+"px")}e.style.display=r?"":"none"}function c(t,e){if(0==e.height)return 0;for(var n,r=e.text.length,i=e;n=Pn(i);){var o=n.find();i=ur(t,o.from.line),r+=o.from.ch-o.to.ch}for(i=e;n=In(i);){var o=n.find();r-=i.text.length-o.from.ch,i=ur(t,o.to.line),r+=i.text.length-o.to.ch}return r}function h(t){var e=t.display,n=t.doc;e.maxLine=ur(n,n.first),e.maxLineLength=c(n,e.maxLine),e.maxLineChanged=!0,n.iter(function(t){var r=c(n,t);r>e.maxLineLength&&(e.maxLineLength=r,e.maxLine=t)})}function f(t){for(var e=!1,n=0;t.gutters.length>n;++n)"CodeMirror-linenumbers"==t.gutters[n]&&(t.lineNumbers?e=!0:t.gutters.splice(n--,1));!e&&t.lineNumbers&&t.gutters.push("CodeMirror-linenumbers")}function d(t,e){var n=e+R(t);t.sizer.style.minHeight=t.heightForcer.style.top=n+"px";var r=Math.max(n,t.scroller.scrollHeight),i=t.scroller.scrollWidth>t.scroller.clientWidth,o=r>t.scroller.clientHeight;o?(t.scrollbarV.style.display="block",t.scrollbarV.style.bottom=i?ri(t.measure)+"px":"0",t.scrollbarV.firstChild.style.height=r-t.scroller.clientHeight+t.scrollbarV.clientHeight+"px"):t.scrollbarV.style.display="",i?(t.scrollbarH.style.display="block",t.scrollbarH.style.right=o?ri(t.measure)+"px":"0",t.scrollbarH.firstChild.style.width=t.scroller.scrollWidth-t.scroller.clientWidth+t.scrollbarH.clientWidth+"px"):t.scrollbarH.style.display="",i&&o?(t.scrollbarFiller.style.display="block",t.scrollbarFiller.style.height=t.scrollbarFiller.style.width=ri(t.measure)+"px"):t.scrollbarFiller.style.display="",ki&&0===ri(t.measure)&&(t.scrollbarV.style.minWidth=t.scrollbarH.style.minHeight=Li?"18px":"12px")
}function p(t,e,n){var r=t.scroller.scrollTop,i=t.wrapper.clientHeight;"number"==typeof n?r=n:n&&(r=n.top,i=n.bottom-n.top),r=Math.floor(r-I(t));var o=Math.ceil(r+i);return{from:pr(e,r),to:pr(e,o)}}function g(t){var e=t.display;if(e.alignWidgets||e.gutters.firstChild&&t.options.fixedGutter){for(var n=y(e)-e.scroller.scrollLeft+t.doc.scrollLeft,r=e.gutters.offsetWidth,i=n+"px",o=e.lineDiv.firstChild;o;o=o.nextSibling)if(o.alignable)for(var s=0,l=o.alignable;l.length>s;++s)l[s].style.left=i;t.options.fixedGutter&&(e.gutters.style.left=n+r+"px")}}function m(t){if(!t.options.lineNumbers)return!1;var e=t.doc,n=v(t.options,e.first+e.size-1),r=t.display;if(n.length!=r.lineNumChars){var i=r.measure.appendChild(Zr("div",[Zr("div",n)],"CodeMirror-linenumber CodeMirror-gutter-elt")),o=i.firstChild.offsetWidth,s=i.offsetWidth-o;return r.lineGutter.style.width="",r.lineNumInnerWidth=Math.max(o,r.lineGutter.offsetWidth-s),r.lineNumWidth=r.lineNumInnerWidth+s,r.lineNumChars=r.lineNumInnerWidth?n.length:-1,r.lineGutter.style.width=r.lineNumWidth+"px",!0}return!1}function v(t,e){return t.lineNumberFormatter(e+t.firstLineNumber)+""}function y(t){return ni(t.scroller).left-ni(t.sizer).left}function _(t,e,n){for(var r,i=t.display.showingFrom,o=t.display.showingTo,s=p(t.display,t.doc,n);w(t,e,s)&&(r=!0,Dr(t,"update",t),(t.display.showingFrom!=i||t.display.showingTo!=o)&&Dr(t,"viewportChange",t,t.display.showingFrom,t.display.showingTo),M(t),d(t.display,t.doc.height),n&&(n=Math.min(t.display.scroller.scrollHeight-t.display.scroller.clientHeight,"number"==typeof n?n:n.top)),s=p(t.display,t.doc,n),!(s.from>=t.display.showingFrom&&s.to<=t.display.showingTo));)e=[];return r}function w(t,e,n){var r=t.display,i=t.doc;if(!r.wrapper.clientWidth)return r.showingFrom=r.showingTo=i.first,r.viewOffset=0,void 0;if(!(0==e.length&&n.from>r.showingFrom&&n.to<r.showingTo)){m(t)&&(e=[{from:i.first,to:i.first+i.size}]);var o=r.sizer.style.marginLeft=r.gutters.offsetWidth+"px";r.scrollbarH.style.left=t.options.fixedGutter?o:"0";var s=1/0;if(t.options.lineNumbers)for(var l=0;e.length>l;++l)if(e[l].diff){s=e[l].from;break}var a=i.first+i.size,u=Math.max(n.from-t.options.viewportMargin,i.first),c=Math.min(a,n.to+t.options.viewportMargin);if(u>r.showingFrom&&20>u-r.showingFrom&&(u=Math.max(i.first,r.showingFrom)),r.showingTo>c&&20>r.showingTo-c&&(c=Math.min(a,r.showingTo)),Wi)for(u=dr(Rn(i,ur(i,u)));a>c&&Dn(i,ur(i,c));)++c;var h=[{from:Math.max(r.showingFrom,i.first),to:Math.min(r.showingTo,a)}];if(h=h[0].from>=h[0].to?[]:x(h,e),Wi)for(var l=0;h.length>l;++l)for(var f,d=h[l];f=In(ur(i,d.to-1));){var p=f.find().from.line;if(!(p>d.from)){h.splice(l--,1);break}d.to=p}for(var g=0,l=0;h.length>l;++l){var d=h[l];u>d.from&&(d.from=u),d.to>c&&(d.to=c),d.from>=d.to?h.splice(l--,1):g+=d.to-d.from}if(g==c-u&&u==r.showingFrom&&c==r.showingTo)return b(t),void 0;h.sort(function(t,e){return t.from-e.from});try{var v=document.activeElement}catch(y){}.7*(c-u)>g&&(r.lineDiv.style.display="none"),k(t,u,c,h,s),r.lineDiv.style.display="",v&&document.activeElement!=v&&v.offsetHeight&&v.focus();var _=u!=r.showingFrom||c!=r.showingTo||r.lastSizeC!=r.wrapper.clientHeight;_&&(r.lastSizeC=r.wrapper.clientHeight),r.showingFrom=u,r.showingTo=c,O(t,100);for(var w,C=r.lineDiv.offsetTop,L=r.lineDiv.firstChild;L;L=L.nextSibling)if(L.lineObj){if(mi){var S=L.offsetTop+L.offsetHeight;w=S-C,C=S}else{var M=ni(L);w=M.bottom-M.top}var T=L.lineObj.height-w;if(2>w&&(w=Y(r)),T>.001||-.001>T){fr(L.lineObj,w);var E=L.lineObj.widgets;if(E)for(var l=0;E.length>l;++l)E[l].height=E[l].node.offsetHeight}}return b(t),!0}}function b(t){var e=t.display.viewOffset=gr(t,ur(t.doc,t.display.showingFrom));t.display.mover.style.top=e+"px"}function x(t,e){for(var n=0,r=e.length||0;r>n;++n){for(var i=e[n],o=[],s=i.diff||0,l=0,a=t.length;a>l;++l){var u=t[l];i.to<=u.from&&i.diff?o.push({from:u.from+s,to:u.to+s}):i.to<=u.from||i.from>=u.to?o.push(u):(i.from>u.from&&o.push({from:u.from,to:i.from}),i.to<u.to&&o.push({from:i.to+s,to:u.to+s}))}t=o}return t}function C(t){for(var e=t.display,n={},r={},i=e.gutters.firstChild,o=0;i;i=i.nextSibling,++o)n[t.options.gutters[o]]=i.offsetLeft,r[t.options.gutters[o]]=i.offsetWidth;return{fixedPos:y(e),gutterTotalWidth:e.gutters.offsetWidth,gutterLeft:n,gutterWidth:r,wrapperWidth:e.wrapper.clientWidth}}function k(t,e,n,r,i){function o(e){var n=e.nextSibling;return yi&&Ei&&t.display.currentWheelTarget==e?(e.style.display="none",e.lineObj=null):e.parentNode.removeChild(e),n}var s=C(t),l=t.display,a=t.options.lineNumbers;r.length||yi&&t.display.currentWheelTarget||Qr(l.lineDiv);var u=l.lineDiv,c=u.firstChild,h=r.shift(),f=e;for(t.doc.iter(e,n,function(e){if(h&&h.to==f&&(h=r.shift()),Dn(t.doc,e)){if(0!=e.height&&fr(e,0),e.widgets&&c.previousSibling)for(var n=0;e.widgets.length>n;++n)if(e.widgets[n].showIfHidden){var l=c.previousSibling;if(/pre/i.test(l.nodeName)){var d=Zr("div",null,null,"position: relative");l.parentNode.replaceChild(d,l),d.appendChild(l),l=d}var p=l.appendChild(Zr("div",[e.widgets[n].node],"CodeMirror-linewidget"));S(e.widgets[n],p,l,s)}}else if(h&&f>=h.from&&h.to>f){for(;c.lineObj!=e;)c=o(c);a&&f>=i&&c.lineNumber&&ei(c.lineNumber,v(t.options,f)),c=c.nextSibling}else{if(e.widgets)for(var g,m=0,y=c;y&&20>m;++m,y=y.nextSibling)if(y.lineObj==e&&/div/i.test(y.nodeName)){g=y;break}var _=L(t,e,f,s,g);if(_!=g)u.insertBefore(_,c);else{for(;c!=g;)c=o(c);c=c.nextSibling}_.lineObj=e}++f});c;)c=o(c)}function L(t,e,n,r,i){var o,s=Zn(t,e),l=e.gutterMarkers,a=t.display;if(!(t.options.lineNumbers||l||e.bgClass||e.wrapClass||e.widgets))return s;if(i){i.alignable=null;for(var u,c=!0,h=0,f=i.firstChild;f;f=u)if(u=f.nextSibling,/\bCodeMirror-linewidget\b/.test(f.className)){for(var d=0,p=!0;e.widgets.length>d;++d){var g=e.widgets[d],m=!1;if(g.above||(m=p,p=!1),g.node==f.firstChild){S(g,f,i,r),++h,m&&i.insertBefore(s,f);break}}if(d==e.widgets.length){c=!1;break}}else i.removeChild(f);c&&h==e.widgets.length&&(o=i,i.className=e.wrapClass||"")}if(o||(o=Zr("div",null,e.wrapClass,"position: relative"),o.appendChild(s)),e.bgClass&&o.insertBefore(Zr("div",null,e.bgClass+" CodeMirror-linebackground"),o.firstChild),t.options.lineNumbers||l){var y=o.insertBefore(Zr("div",null,null,"position: absolute; left: "+(t.options.fixedGutter?r.fixedPos:-r.gutterTotalWidth)+"px"),o.firstChild);if(t.options.fixedGutter&&(o.alignable||(o.alignable=[])).push(y),!t.options.lineNumbers||l&&l["CodeMirror-linenumbers"]||(o.lineNumber=y.appendChild(Zr("div",v(t.options,n),"CodeMirror-linenumber CodeMirror-gutter-elt","left: "+r.gutterLeft["CodeMirror-linenumbers"]+"px; width: "+a.lineNumInnerWidth+"px"))),l)for(var _=0;t.options.gutters.length>_;++_){var w=t.options.gutters[_],b=l.hasOwnProperty(w)&&l[w];b&&y.appendChild(Zr("div",[b],"CodeMirror-gutter-elt","left: "+r.gutterLeft[w]+"px; width: "+r.gutterWidth[w]+"px"))}}if(mi&&(o.style.zIndex=2),e.widgets&&o!=i)for(var d=0,x=e.widgets;x.length>d;++d){var g=x[d],C=Zr("div",[g.node],"CodeMirror-linewidget");S(g,C,o,r),g.above?o.insertBefore(C,t.options.lineNumbers&&0!=e.height?y:s):o.appendChild(C),Dr(g,"redraw")}return o}function S(t,e,n,r){if(t.noHScroll){(n.alignable||(n.alignable=[])).push(e);var i=r.wrapperWidth;e.style.left=r.fixedPos+"px",t.coverGutter||(i-=r.gutterTotalWidth,e.style.paddingLeft=r.gutterTotalWidth+"px"),e.style.width=i+"px"}t.coverGutter&&(e.style.zIndex=5,e.style.position="relative",t.noHScroll||(e.style.marginLeft=-r.gutterTotalWidth+"px"))}function M(t){var e=t.display,n=Be(t.doc.sel.from,t.doc.sel.to);if(n||t.options.showCursorWhenSelecting?T(t):e.cursor.style.display=e.otherCursor.style.display="none",n?e.selectionDiv.style.display="none":E(t),t.options.moveInputWithCursor){var r=G(t,t.doc.sel.head,"div"),i=ni(e.wrapper),o=ni(e.lineDiv);e.inputDiv.style.top=Math.max(0,Math.min(e.wrapper.clientHeight-10,r.top+o.top-i.top))+"px",e.inputDiv.style.left=Math.max(0,Math.min(e.wrapper.clientWidth-10,r.left+o.left-i.left))+"px"}}function T(t){var e=t.display,n=G(t,t.doc.sel.head,"div");e.cursor.style.left=n.left+"px",e.cursor.style.top=n.top+"px",e.cursor.style.height=Math.max(0,n.bottom-n.top)*t.options.cursorHeight+"px",e.cursor.style.display="",n.other?(e.otherCursor.style.display="",e.otherCursor.style.left=n.other.left+"px",e.otherCursor.style.top=n.other.top+"px",e.otherCursor.style.height=.85*(n.other.bottom-n.other.top)+"px"):e.otherCursor.style.display="none"}function E(t){function e(t,e,n,r){0>e&&(e=0),s.appendChild(Zr("div",null,"CodeMirror-selected","position: absolute; left: "+t+"px; top: "+e+"px; width: "+(null==n?l-t:n)+"px; height: "+(r-e)+"px"))}function n(n,r,o,s){function u(e){return U(t,Fe(n,e),"div",c)}var c=ur(i,n),h=c.text.length,f=s?1/0:-1/0;return oi(mr(c),r||0,null==o?h:o,function(t,n,i){var c,d,p,g=u(t);if(t==n)c=g,d=p=g.left;else{if(c=u(n-1),"rtl"==i){var m=g;g=c,c=m}d=g.left,p=c.right}c.top-g.top>3&&(e(d,g.top,null,g.bottom),d=a,g.bottom<c.top&&e(d,g.bottom,null,c.top)),null==o&&n==h&&(p=l),null==r&&0==t&&(d=a),f=s?Math.min(c.top,f):Math.max(c.bottom,f),a+1>d&&(d=a),e(d,c.top,p-d,c.bottom)}),f}var r=t.display,i=t.doc,o=t.doc.sel,s=document.createDocumentFragment(),l=r.lineSpace.offsetWidth,a=D(t.display);if(o.from.line==o.to.line)n(o.from.line,o.from.ch,o.to.ch);else{for(var u,c,h=ur(i,o.from.line),f=h,d=[o.from.line,o.from.ch];u=In(f);){var p=u.find();if(d.push(p.from.ch,p.to.line,p.to.ch),p.to.line==o.to.line){d.push(o.to.ch),c=!0;break}f=ur(i,p.to.line)}if(c)for(var g=0;d.length>g;g+=3)n(d[g],d[g+1],d[g+2]);else{var m,v,y=ur(i,o.to.line);m=o.from.ch?n(o.from.line,o.from.ch,null,!1):gr(t,h)-r.viewOffset,v=o.to.ch?n(o.to.line,Pn(y)?null:0,o.to.ch,!0):gr(t,y)-r.viewOffset,v>m&&e(a,m,null,v)}}ti(r.selectionDiv,s),r.selectionDiv.style.display=""}function A(t){if(t.state.focused){var e=t.display;clearInterval(e.blinker);var n=!0;e.cursor.style.visibility=e.otherCursor.style.visibility="",e.blinker=setInterval(function(){e.cursor.style.visibility=e.otherCursor.style.visibility=(n=!n)?"":"hidden"},t.options.cursorBlinkRate)}}function O(t,e){t.doc.mode.startState&&t.doc.frontier<t.display.showingTo&&t.state.highlight.set(e,Jr(N,t))}function N(t){var e=t.doc;if(e.frontier<e.first&&(e.frontier=e.first),!(e.frontier>=t.display.showingTo)){var n,r=+new Date+t.options.workTime,i=pn(e.mode,P(t,e.frontier)),o=[];e.iter(e.frontier,Math.min(e.first+e.size,t.display.showingTo+500),function(s){if(e.frontier>=t.display.showingFrom){var l=s.styles;s.styles=Kn(t,s,i);for(var a=!l||l.length!=s.styles.length,u=0;!a&&l.length>u;++u)a=l[u]!=s.styles[u];a&&(n&&n.end==e.frontier?n.end++:o.push(n={start:e.frontier,end:e.frontier+1})),s.stateAfter=pn(e.mode,i)}else Xn(t,s,i),s.stateAfter=0==e.frontier%5?pn(e.mode,i):null;return++e.frontier,+new Date>r?(O(t,t.options.workDelay),!0):void 0}),o.length&&ee(t,function(){for(var t=0;o.length>t;++t)ie(this,o[t].start,o[t].end)})()}}function H(t,e){for(var n,r,i=t.doc,o=e,s=e-100;o>s;--o){if(i.first>=o)return i.first;var l=ur(i,o-1);if(l.stateAfter)return o;var a=Fr(l.text,null,t.options.tabSize);(null==r||n>a)&&(r=o-1,n=a)}return r}function P(t,e){var n=t.doc,r=t.display;if(!n.mode.startState)return!0;var i=H(t,e),o=i>n.first&&ur(n,i-1).stateAfter;return o=o?pn(n.mode,o):gn(n.mode),n.iter(i,e,function(s){Xn(t,s,o);var l=i==e-1||0==i%5||i>=r.showingFrom&&r.showingTo>i;s.stateAfter=l?pn(n.mode,o):null,++i}),o}function I(t){return t.lineSpace.offsetTop}function R(t){return t.mover.offsetHeight-t.lineSpace.offsetHeight}function D(t){var e=ti(t.measure,Zr("pre",null,null,"text-align: left")).appendChild(Zr("span","x"));return e.offsetLeft}function W(t,e,n,r){var i=-1;r=r||z(t,e);for(var o=n;;o+=i){var s=r[o];if(s)break;0>i&&0==o&&(i=1)}return{left:n>o?s.right:s.left,right:o>n?s.left:s.right,top:s.top,bottom:s.bottom}}function V(t,e){for(var n=t.display.measureLineCache,r=0;n.length>r;++r){var i=n[r];if(i.text==e.text&&i.markedSpans==e.markedSpans&&t.display.scroller.clientWidth==i.width&&i.classes==e.textClass+"|"+e.bgClass+"|"+e.wrapClass)return i.measure}}function z(t,e){var n=V(t,e);if(!n){n=F(t,e);var r=t.display.measureLineCache,i={text:e.text,width:t.display.scroller.clientWidth,markedSpans:e.markedSpans,measure:n,classes:e.textClass+"|"+e.bgClass+"|"+e.wrapClass};16==r.length?r[++t.display.measureLineCachePos%16]=i:r.push(i)}return n}function F(t,e){var n=t.display,r=Kr(e.text.length),i=Zn(t,e,r);if(gi&&!mi&&!t.options.lineWrapping&&i.childNodes.length>100){for(var o=document.createDocumentFragment(),s=10,l=i.childNodes.length,a=0,u=Math.ceil(l/s);u>a;++a){for(var c=Zr("div",null,null,"display: inline-block"),h=0;s>h&&l;++h)c.appendChild(i.firstChild),--l;o.appendChild(c)}i.appendChild(o)}ti(n.measure,i);var f=ni(n.lineDiv),d=[],p=Kr(e.text.length),g=i.offsetHeight;vi&&n.measure.first!=i&&ti(n.measure,i);for(var m,a=0;r.length>a;++a)if(m=r[a]){for(var v=ni(m),y=Math.max(0,v.top-f.top),_=Math.min(v.bottom-f.top,g),h=0;d.length>h;h+=2){var w=d[h],b=d[h+1];if(!(w>_||y>b)&&(y>=w&&b>=_||w>=y&&_>=b||Math.min(_,b)-Math.max(y,w)>=_-y>>1)){d[h]=Math.min(y,w),d[h+1]=Math.max(_,b);break}}h==d.length&&d.push(y,_);var x=v.right;m.measureRight&&(x=ni(m.measureRight).left),p[a]={left:v.left-f.left,right:x-f.left,top:h}}for(var m,a=0;p.length>a;++a)if(m=p[a]){var C=m.top;m.top=d[C],m.bottom=d[C+1]}return p}function B(t,e){var n=!1;if(e.markedSpans)for(var r=0;e.markedSpans>r;++r){var i=e.markedSpans[r];!i.collapsed||null!=i.to&&i.to!=e.text.length||(n=!0)}var o=!n&&V(t,e);if(o)return W(t,e,e.text.length,o).right;var s=Zn(t,e),l=s.appendChild(ii(t.display.measure));return ti(t.display.measure,s),ni(l).right-ni(t.display.lineDiv).left}function j(t){t.display.measureLineCache.length=t.display.measureLineCachePos=0,t.display.cachedCharWidth=t.display.cachedTextHeight=null,t.options.lineWrapping||(t.display.maxLineChanged=!0),t.display.lineNumChars=null}function $(t,e,n,r){if(e.widgets)for(var i=0;e.widgets.length>i;++i)if(e.widgets[i].above){var o=Bn(e.widgets[i]);n.top+=o,n.bottom+=o}if("line"==r)return n;r||(r="local");var s=gr(t,e);if("local"!=r&&(s-=t.display.viewOffset),"page"==r){var l=ni(t.display.lineSpace);s+=l.top+(window.pageYOffset||(document.documentElement||document.body).scrollTop);var a=l.left+(window.pageXOffset||(document.documentElement||document.body).scrollLeft);n.left+=a,n.right+=a}return n.top+=s,n.bottom+=s,n}function q(t,e,n){if("div"==n)return e;var r=e.left,i=e.top;"page"==n&&(r-=window.pageXOffset||(document.documentElement||document.body).scrollLeft,i-=window.pageYOffset||(document.documentElement||document.body).scrollTop);var o=ni(t.display.lineSpace);if(r-=o.left,i-=o.top,"local"==n||!n){var s=ni(t.display.wrapper);r+=s.left,i+=s.top}return{left:r,top:i}}function U(t,e,n,r){return r||(r=ur(t.doc,e.line)),$(t,r,W(t,r,e.ch),n)}function G(t,e,n,r,i){function o(e,o){var s=W(t,r,e,i);return o?s.left=s.right:s.right=s.left,$(t,r,s,n)}r=r||ur(t.doc,e.line),i||(i=z(t,r));var s=mr(r),l=e.ch;if(!s)return o(l);for(var a,u,c=s[0].level,h=0;s.length>h;++h){var f,d,p=s[h],g=p.level%2;if(l>p.from&&p.to>l)return o(l,g);var m=g?p.to:p.from,v=g?p.from:p.to;if(m==l)d=h&&p.level<(f=s[h-1]).level?o(f.level%2?f.from:f.to-1,!0):o(g&&p.from!=p.to?l-1:l),g==c?a=d:u=d;else if(v==l){var f=s.length-1>h&&s[h+1];if(!g&&f&&f.from==f.to)continue;d=f&&p.level<f.level?o(f.level%2?f.to-1:f.from):o(g?l:l-1,!0),g==c?a=d:u=d}}return c&&!l&&(u=o(s[0].to-1)),a?(u&&(a.other=u),a):u}function K(t,e,n){var r=new Fe(t,e);return n&&(r.outside=!0),r}function J(t,e,n){var r=t.doc;if(n+=t.display.viewOffset,0>n)return K(r.first,0,!0);var i=pr(r,n),o=r.first+r.size-1;if(i>o)return K(r.first+r.size-1,ur(r,o).text.length,!0);for(0>e&&(e=0);;){var s=ur(r,i),l=X(t,s,i,e,n),a=In(s),u=a&&a.find();if(!(a&&l.ch>=u.from.ch))return l;i=u.to.line}}function X(t,e,n,r,i){function o(r){var i=G(t,Fe(n,r),"line",e,u);return l=!0,s>i.bottom?i.left-a:i.top>s?i.left+a:(l=!1,i.left)}var s=i-gr(t,e),l=!1,a=2*t.display.wrapper.clientWidth,u=z(t,e),c=mr(e),h=e.text.length,f=ai(e),d=ui(e),p=o(f),g=l,m=o(d),v=l;if(r>m)return K(n,d,v);for(;;){if(c?d==f||d==fi(e,f,1):1>=d-f){for(var y=m-r>r-p,_=y?f:d;po.test(e.text.charAt(_));)++_;var w=K(n,_,y?g:v);return w.after=y,w}var b=Math.ceil(h/2),x=f+b;if(c){x=f;for(var C=0;b>C;++C)x=fi(e,x,1)}var k=o(x);k>r?(d=x,m=k,(v=l)&&(m+=1e3),h=b):(f=x,p=k,g=l,h-=b)}}function Y(t){if(null!=t.cachedTextHeight)return t.cachedTextHeight;if(null==Ni){Ni=Zr("pre");for(var e=0;49>e;++e)Ni.appendChild(document.createTextNode("x")),Ni.appendChild(Zr("br"));Ni.appendChild(document.createTextNode("x"))}ti(t.measure,Ni);var n=Ni.offsetHeight/50;return n>3&&(t.cachedTextHeight=n),Qr(t.measure),n||1}function Z(t){if(null!=t.cachedCharWidth)return t.cachedCharWidth;var e=Zr("span","x"),n=Zr("pre",[e]);ti(t.measure,n);var r=e.offsetWidth;return r>2&&(t.cachedCharWidth=r),r||10}function Q(t){t.curOp={changes:[],updateInput:null,userSelChange:null,textChanged:null,selectionChanged:!1,cursorActivity:!1,updateMaxLine:!1,updateScrollPos:!1,id:++Vi},ao++||(lo=[])}function te(t){var e=t.curOp,n=t.doc,r=t.display;if(t.curOp=null,e.updateMaxLine&&h(t),r.maxLineChanged&&!t.options.lineWrapping&&r.maxLine){var i=B(t,r.maxLine);r.sizer.style.minWidth=Math.max(0,i+3+uo)+"px",r.maxLineChanged=!1;var o=Math.max(0,r.sizer.offsetLeft+r.sizer.offsetWidth-r.scroller.clientWidth);n.scrollLeft>o&&!e.updateScrollPos&&_e(t,Math.min(r.scroller.scrollLeft,o),!0)}var s,l;if(e.updateScrollPos)s=e.updateScrollPos;else if(e.selectionChanged&&r.scroller.clientHeight){var a=G(t,n.sel.head);s=rn(t,a.left,a.top,a.left,a.bottom)}(e.changes.length||s&&null!=s.scrollTop)&&(l=_(t,e.changes,s&&s.scrollTop),t.display.scroller.offsetHeight&&(t.doc.scrollTop=t.display.scroller.scrollTop)),!l&&e.selectionChanged&&M(t),e.updateScrollPos?(r.scroller.scrollTop=r.scrollbarV.scrollTop=n.scrollTop=s.scrollTop,r.scroller.scrollLeft=r.scrollbarH.scrollLeft=n.scrollLeft=s.scrollLeft,g(t),e.scrollToPos&&en(t,Ue(t.doc,e.scrollToPos),e.scrollToPosMargin)):s&&tn(t),e.selectionChanged&&A(t),t.state.focused&&e.updateInput&&ae(t,e.userSelChange);var u=e.maybeHiddenMarkers,c=e.maybeUnhiddenMarkers;if(u)for(var f=0;u.length>f;++f)u[f].lines.length||Rr(u[f],"hide");if(c)for(var f=0;c.length>f;++f)c[f].lines.length&&Rr(c[f],"unhide");var d;if(--ao||(d=lo,lo=null),e.textChanged&&Rr(t,"change",t,e.textChanged),e.cursorActivity&&Rr(t,"cursorActivity",t),d)for(var f=0;d.length>f;++f)d[f]()}function ee(t,e){return function(){var n=t||this,r=!n.curOp;r&&Q(n);try{var i=e.apply(n,arguments)}finally{r&&te(n)}return i}}function ne(t){return function(){var e,n=this.cm&&!this.cm.curOp;n&&Q(this.cm);try{e=t.apply(this,arguments)}finally{n&&te(this.cm)}return e}}function re(t,e){var n,r=!t.curOp;r&&Q(t);try{n=e()}finally{r&&te(t)}return n}function ie(t,e,n,r){null==e&&(e=t.doc.first),null==n&&(n=t.doc.first+t.doc.size),t.curOp.changes.push({from:e,to:n,diff:r})}function oe(t){t.display.pollingFast||t.display.poll.set(t.options.pollInterval,function(){le(t),t.state.focused&&oe(t)})}function se(t){function e(){var r=le(t);r||n?(t.display.pollingFast=!1,oe(t)):(n=!0,t.display.poll.set(60,e))}var n=!1;t.display.pollingFast=!0,t.display.poll.set(20,e)}function le(t){var e=t.display.input,n=t.display.prevInput,r=t.doc,i=r.sel;if(!t.state.focused||wo(e)||ce(t))return!1;var o=e.value;if(o==n&&Be(i.from,i.to))return!1;if(gi&&!vi&&t.display.inputHasSelection===o)return ae(t,!0),!1;var s=!t.curOp;s&&Q(t),i.shift=!1;for(var l=0,a=Math.min(n.length,o.length);a>l&&n.charCodeAt(l)==o.charCodeAt(l);)++l;var u=i.from,c=i.to;n.length>l?u=Fe(u.line,u.ch-(n.length-l)):t.state.overwrite&&Be(u,c)&&!t.state.pasteIncoming&&(c=Fe(c.line,Math.min(ur(r,c.line).text.length,c.ch+(o.length-l))));var h=t.curOp.updateInput;return Pe(t.doc,{from:u,to:c,text:_o(o.slice(l)),origin:t.state.pasteIncoming?"paste":"+input"},"end"),t.curOp.updateInput=h,o.length>1e3||o.indexOf("\n")>-1?e.value=t.display.prevInput="":t.display.prevInput=o,s&&te(t),t.state.pasteIncoming=!1,!0}function ae(t,e){var n,r,i=t.doc;if(Be(i.sel.from,i.sel.to))e&&(t.display.prevInput=t.display.input.value="",gi&&!vi&&(t.display.inputHasSelection=null));else{t.display.prevInput="",n=bo&&(i.sel.to.line-i.sel.from.line>100||(r=t.getSelection()).length>1e3);var o=n?"-":r||t.getSelection();t.display.input.value=o,t.state.focused&&$r(t.display.input),gi&&!vi&&(t.display.inputHasSelection=o)}t.display.inaccurateSelection=n}function ue(t){"nocursor"==t.options.readOnly||Ti&&document.activeElement==t.display.input||t.display.input.focus()}function ce(t){return t.options.readOnly||t.doc.cantEdit}function he(t){function e(){t.state.focused&&setTimeout(Jr(ue,t),0)}function n(){s.cachedCharWidth=s.cachedTextHeight=null,j(t),re(t,Jr(ie,t))}function r(){for(var t=s.wrapper.parentNode;t&&t!=document.body;t=t.parentNode);t?setTimeout(r,5e3):Ir(window,"resize",n)}function i(e){t.options.onDragEvent&&t.options.onDragEvent(t,Tr(e))||Or(e)}function o(){s.inaccurateSelection&&(s.prevInput="",s.inaccurateSelection=!1,s.input.value=t.getSelection(),$r(s.input))}var s=t.display;Pr(s.scroller,"mousedown",ee(t,pe)),gi?Pr(s.scroller,"dblclick",ee(t,function(e){var n=de(t,e);if(n&&!me(t,e)&&!fe(t.display,e)){Er(e);var r=hn(ur(t.doc,n.line).text,n);Je(t.doc,r.from,r.to)}})):Pr(s.scroller,"dblclick",Er),Pr(s.lineSpace,"selectstart",function(t){fe(s,t)||Er(t)}),Ri||Pr(s.scroller,"contextmenu",function(e){Ee(t,e)}),Pr(s.scroller,"scroll",function(){s.scroller.clientHeight&&(ye(t,s.scroller.scrollTop),_e(t,s.scroller.scrollLeft,!0),Rr(t,"scroll",t))}),Pr(s.scrollbarV,"scroll",function(){s.scroller.clientHeight&&ye(t,s.scrollbarV.scrollTop)}),Pr(s.scrollbarH,"scroll",function(){s.scroller.clientHeight&&_e(t,s.scrollbarH.scrollLeft)}),Pr(s.scroller,"mousewheel",function(e){we(t,e)}),Pr(s.scroller,"DOMMouseScroll",function(e){we(t,e)}),Pr(s.scrollbarH,"mousedown",e),Pr(s.scrollbarV,"mousedown",e),Pr(s.wrapper,"scroll",function(){s.wrapper.scrollTop=s.wrapper.scrollLeft=0}),Pr(window,"resize",n),setTimeout(r,5e3),Pr(s.input,"keyup",ee(t,function(e){t.options.onKeyEvent&&t.options.onKeyEvent(t,Tr(e))||16==e.keyCode&&(t.doc.sel.shift=!1)})),Pr(s.input,"input",Jr(se,t)),Pr(s.input,"keydown",ee(t,Le)),Pr(s.input,"keypress",ee(t,Se)),Pr(s.input,"focus",Jr(Me,t)),Pr(s.input,"blur",Jr(Te,t)),t.options.dragDrop&&(Pr(s.scroller,"dragstart",function(e){ve(t,e)}),Pr(s.scroller,"dragenter",i),Pr(s.scroller,"dragover",i),Pr(s.scroller,"drop",ee(t,ge))),Pr(s.scroller,"paste",function(e){fe(s,e)||(ue(t),se(t))}),Pr(s.input,"paste",function(){t.state.pasteIncoming=!0,se(t)}),Pr(s.input,"cut",o),Pr(s.input,"copy",o),Ci&&Pr(s.sizer,"mouseup",function(){document.activeElement==s.input&&s.input.blur(),ue(t)})}function fe(t,e){for(var n=Nr(e);n!=t.wrapper;n=n.parentNode){if(!n)return!0;if(/\bCodeMirror-(?:line)?widget\b/.test(n.className)||n.parentNode==t.sizer&&n!=t.mover)return!0}}function de(t,e,n){var r=t.display;if(!n){var i=Nr(e);if(i==r.scrollbarH||i==r.scrollbarH.firstChild||i==r.scrollbarV||i==r.scrollbarV.firstChild||i==r.scrollbarFiller)return null}var o,s,l=ni(r.lineSpace);try{o=e.clientX,s=e.clientY}catch(e){return null}return J(t,o-l.left,s-l.top)}function pe(t){function e(t){if(!Be(v,t)){if(v=t,"single"==c)return Je(i.doc,Ue(s,a),t),void 0;if(g=Ue(s,g),m=Ue(s,m),"double"==c){var e=hn(ur(s,t.line).text,t);je(t,g)?Je(i.doc,e.from,m):Je(i.doc,g,e.to)}else"triple"==c&&(je(t,g)?Je(i.doc,m,Ue(s,Fe(t.line,0))):Je(i.doc,g,Ue(s,Fe(t.line+1,0))))}}function n(t){var r=++_,l=de(i,t,!0);if(l)if(Be(l,f)){var a=t.clientY<y.top?-20:t.clientY>y.bottom?20:0;a&&setTimeout(ee(i,function(){_==r&&(o.scroller.scrollTop+=a,n(t))}),50)}else{i.state.focused||Me(i),f=l,e(l);var u=p(o,s);(l.line>=u.to||l.line<u.from)&&setTimeout(ee(i,function(){_==r&&n(t)}),150)}}function r(t){_=1/0;var n=de(i,t);n&&e(n),Er(t),ue(i),Ir(document,"mousemove",w),Ir(document,"mouseup",b)}var i=this,o=i.display,s=i.doc,l=s.sel;if(l.shift=t.shiftKey,fe(o,t))return yi||(o.scroller.draggable=!1,setTimeout(function(){o.scroller.draggable=!0},100)),void 0;if(!me(i,t)){var a=de(i,t);switch(Hr(t)){case 3:return Ri&&Ee.call(i,i,t),void 0;case 2:return a&&Je(i.doc,a),setTimeout(Jr(ue,i),20),Er(t),void 0}if(!a)return Nr(t)==o.scroller&&Er(t),void 0;i.state.focused||Me(i);var u=+new Date,c="single";if(Pi&&Pi.time>u-400&&Be(Pi.pos,a))c="triple",Er(t),setTimeout(Jr(ue,i),20),fn(i,a.line);else if(Hi&&Hi.time>u-400&&Be(Hi.pos,a)){c="double",Pi={time:u,pos:a},Er(t);var h=hn(ur(s,a.line).text,a);Je(i.doc,h.from,h.to)}else Hi={time:u,pos:a};var f=a;if(i.options.dragDrop&&go&&!ce(i)&&!Be(l.from,l.to)&&!je(a,l.from)&&!je(l.to,a)&&"single"==c){var d=ee(i,function(e){yi&&(o.scroller.draggable=!1),i.state.draggingText=!1,Ir(document,"mouseup",d),Ir(o.scroller,"drop",d),10>Math.abs(t.clientX-e.clientX)+Math.abs(t.clientY-e.clientY)&&(Er(e),Je(i.doc,a),ue(i))});return yi&&(o.scroller.draggable=!0),i.state.draggingText=d,o.scroller.dragDrop&&o.scroller.dragDrop(),Pr(document,"mouseup",d),Pr(o.scroller,"drop",d),void 0}Er(t),"single"==c&&Je(i.doc,Ue(s,a));var g=l.from,m=l.to,v=a,y=ni(o.wrapper),_=0,w=ee(i,function(t){gi||Hr(t)?n(t):r(t)}),b=ee(i,r);Pr(document,"mousemove",w),Pr(document,"mouseup",b)}}function ge(t){var e=this;if(!(fe(e.display,t)||e.options.onDragEvent&&e.options.onDragEvent(e,Tr(t)))){Er(t);var n=de(e,t,!0),r=t.dataTransfer.files;if(n&&!ce(e))if(r&&r.length&&window.FileReader&&window.File)for(var i=r.length,o=Array(i),s=0,l=function(t,r){var l=new FileReader;l.onload=function(){o[r]=l.result,++s==i&&(n=Ue(e.doc,n),Pe(e.doc,{from:n,to:n,text:_o(o.join("\n")),origin:"paste"},"around"))},l.readAsText(t)},a=0;i>a;++a)l(r[a],a);else{if(e.state.draggingText&&!je(n,e.doc.sel.from)&&!je(e.doc.sel.to,n))return e.state.draggingText(t),setTimeout(Jr(ue,e),20),void 0;try{var o=t.dataTransfer.getData("Text");if(o){var u=e.doc.sel.from,c=e.doc.sel.to;Ye(e.doc,n,n),e.state.draggingText&&ze(e.doc,"",u,c,"paste"),e.replaceSelection(o,null,"paste"),ue(e),Me(e)}}catch(t){}}}}function me(t,e){var n=t.display;try{var r=e.clientX,i=e.clientY}catch(e){return!1}if(r>=Math.floor(ni(n.gutters).right))return!1;if(Er(e),!Vr(t,"gutterClick"))return!0;var o=ni(n.lineDiv);if(i>o.bottom)return!0;i-=o.top-n.viewOffset;for(var s=0;t.options.gutters.length>s;++s){var l=n.gutters.childNodes[s];if(l&&ni(l).right>=r){var a=pr(t.doc,i),u=t.options.gutters[s];Dr(t,"gutterClick",t,a,u,e);break}}return!0}function ve(t,e){if(gi&&!t.state.draggingText)return Or(e),void 0;if(!fe(t.display,e)){var n=t.getSelection();if(e.dataTransfer.setData("Text",n),e.dataTransfer.setDragImage){var r=Zr("img",null,null,"position: fixed; left: 0; top: 0;");bi&&(r.width=r.height=1,t.display.wrapper.appendChild(r),r._top=r.offsetTop),xi&&(t.display.dragImg?r=t.display.dragImg:(t.display.dragImg=r,r.src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==",t.display.wrapper.appendChild(r))),e.dataTransfer.setDragImage(r,0,0),bi&&r.parentNode.removeChild(r)}}}function ye(t,e){2>Math.abs(t.doc.scrollTop-e)||(t.doc.scrollTop=e,pi||_(t,[],e),t.display.scroller.scrollTop!=e&&(t.display.scroller.scrollTop=e),t.display.scrollbarV.scrollTop!=e&&(t.display.scrollbarV.scrollTop=e),pi&&_(t,[]))}function _e(t,e,n){(n?e==t.doc.scrollLeft:2>Math.abs(t.doc.scrollLeft-e))||(e=Math.min(e,t.display.scroller.scrollWidth-t.display.scroller.clientWidth),t.doc.scrollLeft=e,g(t),t.display.scroller.scrollLeft!=e&&(t.display.scroller.scrollLeft=e),t.display.scrollbarH.scrollLeft!=e&&(t.display.scrollbarH.scrollLeft=e))}function we(t,e){var n=e.wheelDeltaX,r=e.wheelDeltaY;null==n&&e.detail&&e.axis==e.HORIZONTAL_AXIS&&(n=e.detail),null==r&&e.detail&&e.axis==e.VERTICAL_AXIS?r=e.detail:null==r&&(r=e.wheelDelta);var i=t.display,o=i.scroller;if(n&&o.scrollWidth>o.clientWidth||r&&o.scrollHeight>o.clientHeight){if(r&&Ei&&yi)for(var s=e.target;s!=o;s=s.parentNode)if(s.lineObj){t.display.currentWheelTarget=s;break}if(n&&!pi&&!bi&&null!=Fi)return r&&ye(t,Math.max(0,Math.min(o.scrollTop+r*Fi,o.scrollHeight-o.clientHeight))),_e(t,Math.max(0,Math.min(o.scrollLeft+n*Fi,o.scrollWidth-o.clientWidth))),Er(e),i.wheelStartX=null,void 0;if(r&&null!=Fi){var l=r*Fi,a=t.doc.scrollTop,u=a+i.wrapper.clientHeight;0>l?a=Math.max(0,a+l-50):u=Math.min(t.doc.height,u+l+50),_(t,[],{top:a,bottom:u})}20>zi&&(null==i.wheelStartX?(i.wheelStartX=o.scrollLeft,i.wheelStartY=o.scrollTop,i.wheelDX=n,i.wheelDY=r,setTimeout(function(){if(null!=i.wheelStartX){var t=o.scrollLeft-i.wheelStartX,e=o.scrollTop-i.wheelStartY,n=e&&i.wheelDY&&e/i.wheelDY||t&&i.wheelDX&&t/i.wheelDX;i.wheelStartX=i.wheelStartY=null,n&&(Fi=(Fi*zi+n)/(zi+1),++zi)}},200)):(i.wheelDX+=n,i.wheelDY+=r))}}function be(t,e,n){if("string"==typeof e&&(e=Zi[e],!e))return!1;t.display.pollingFast&&le(t)&&(t.display.pollingFast=!1);var r=t.doc,i=r.sel.shift,o=!1;try{ce(t)&&(t.state.suppressEdits=!0),n&&(r.sel.shift=!1),o=e(t)!=co}finally{r.sel.shift=i,t.state.suppressEdits=!1}return o}function xe(t){var e=t.state.keyMaps.slice(0);return t.options.extraKeys&&e.push(t.options.extraKeys),e.push(t.options.keyMap),e}function Ce(t,e){var n=mn(t.options.keyMap),r=n.auto;clearTimeout(Bi),r&&!yn(e)&&(Bi=setTimeout(function(){mn(t.options.keyMap)==n&&(t.options.keyMap=r.call?r.call(null,t):r)},50));var i=_n(e,!0),o=!1;if(!i)return!1;var s=xe(t);return o=e.shiftKey?vn("Shift-"+i,s,function(e){return be(t,e,!0)})||vn(i,s,function(e){return"string"==typeof e&&/^go[A-Z]/.test(e)?be(t,e):void 0}):vn(i,s,function(e){return be(t,e)}),"stop"==o&&(o=!1),o&&(Er(e),A(t),vi&&(e.oldKeyCode=e.keyCode,e.keyCode=0)),o}function ke(t,e,n){var r=vn("'"+n+"'",xe(t),function(e){return be(t,e,!0)});return r&&(Er(e),A(t)),r}function Le(t){var e=this;if(e.state.focused||Me(e),gi&&27==t.keyCode&&(t.returnValue=!1),!e.options.onKeyEvent||!e.options.onKeyEvent(e,Tr(t))){var n=t.keyCode;e.doc.sel.shift=16==n||t.shiftKey;var r=Ce(e,t);bi&&($i=r?n:null,!r&&88==n&&!bo&&(Ei?t.metaKey:t.ctrlKey)&&e.replaceSelection(""))}}function Se(t){var e=this;if(!e.options.onKeyEvent||!e.options.onKeyEvent(e,Tr(t))){var n=t.keyCode,r=t.charCode;if(bi&&n==$i)return $i=null,Er(t),void 0;if(!(bi&&(!t.which||10>t.which)||Ci)||!Ce(e,t)){var i=String.fromCharCode(null==r?n:r);this.options.electricChars&&this.doc.mode.electricChars&&this.options.smartIndent&&!ce(this)&&this.doc.mode.electricChars.indexOf(i)>-1&&setTimeout(ee(e,function(){ln(e,e.doc.sel.to.line,"smart")}),75),ke(e,t,i)||(gi&&!vi&&(e.display.inputHasSelection=null),se(e))}}}function Me(t){"nocursor"!=t.options.readOnly&&(t.state.focused||(Rr(t,"focus",t),t.state.focused=!0,-1==t.display.wrapper.className.search(/\bCodeMirror-focused\b/)&&(t.display.wrapper.className+=" CodeMirror-focused"),ae(t,!0)),oe(t),A(t))}function Te(t){t.state.focused&&(Rr(t,"blur",t),t.state.focused=!1,t.display.wrapper.className=t.display.wrapper.className.replace(" CodeMirror-focused","")),clearInterval(t.display.blinker),setTimeout(function(){t.state.focused||(t.doc.sel.shift=!1)},150)}function Ee(t,e){function n(){if(r.inputDiv.style.position="relative",r.input.style.cssText=l,vi&&(r.scrollbarV.scrollTop=r.scroller.scrollTop=s),oe(t),null!=r.input.selectionStart&&(!gi||vi)){clearTimeout(ji);var e=r.input.value=" "+(Be(i.from,i.to)?"":r.input.value),n=0;r.prevInput=" ",r.input.selectionStart=1,r.input.selectionEnd=e.length;var o=function(){" "==r.prevInput&&0==r.input.selectionStart?ee(t,Zi.selectAll)(t):10>n++?ji=setTimeout(o,500):ae(t)};ji=setTimeout(o,200)}}var r=t.display,i=t.doc.sel;if(!fe(r,e)){var o=de(t,e),s=r.scroller.scrollTop;if(o&&!bi){(Be(i.from,i.to)||je(o,i.from)||!je(o,i.to))&&ee(t,Ye)(t.doc,o,o);var l=r.input.style.cssText;if(r.inputDiv.style.position="absolute",r.input.style.cssText="position: fixed; width: 30px; height: 30px; top: "+(e.clientY-5)+"px; left: "+(e.clientX-5)+"px; z-index: 1000; background: white; outline: none;"+"border-width: 0; outline: none; overflow: hidden; opacity: .05; -ms-opacity: .05; filter: alpha(opacity=5);",ue(t),ae(t,!0),Be(i.from,i.to)&&(r.input.value=r.prevInput=" "),Ri){Or(e);var a=function(){Ir(window,"mouseup",a),setTimeout(n,20)};Pr(window,"mouseup",a)}else setTimeout(n,50)}}}function Ae(t){return t.text?Fe(t.from.line+t.text.length-1,jr(t.text).length+(1==t.text.length?t.from.ch:0)):t.to
}function Oe(t,e,n){if(!je(e.from,n))return Ue(t,n);var r=e.text.length-1-(e.to.line-e.from.line);if(n.line>e.to.line+r){var i=n.line-r,o=t.first+t.size-1;return i>o?Fe(o,ur(t,o).text.length):Ge(n,ur(t,i).text.length)}if(n.line==e.to.line+r)return Ge(n,jr(e.text).length+(1==e.text.length?e.from.ch:0)+ur(t,e.to.line).text.length-e.to.ch);var s=n.line-e.from.line;return Ge(n,e.text[s].length+(s?0:e.from.ch))}function Ne(t,e,n){if(n&&"object"==typeof n)return{anchor:Oe(t,e,n.anchor),head:Oe(t,e,n.head)};if("start"==n)return{anchor:e.from,head:e.from};var r=Ae(e);if("around"==n)return{anchor:e.from,head:r};if("end"==n)return{anchor:r,head:r};var i=function(t){if(je(t,e.from))return t;if(!je(e.to,t))return r;var n=t.line+e.text.length-(e.to.line-e.from.line)-1,i=t.ch;return t.line==e.to.line&&(i+=r.ch-e.to.ch),Fe(n,i)};return{anchor:i(t.sel.anchor),head:i(t.sel.head)}}function He(t,e){var n={canceled:!1,from:e.from,to:e.to,text:e.text,origin:e.origin,update:function(e,n,r,i){e&&(this.from=Ue(t,e)),n&&(this.to=Ue(t,n)),r&&(this.text=r),void 0!==i&&(this.origin=i)},cancel:function(){this.canceled=!0}};return Rr(t,"beforeChange",t,n),t.cm&&Rr(t.cm,"beforeChange",t.cm,n),n.canceled?null:{from:n.from,to:n.to,text:n.text,origin:n.origin}}function Pe(t,e,n,r){if(t.cm){if(!t.cm.curOp)return ee(t.cm,Pe)(t,e,n,r);if(t.cm.state.suppressEdits)return}if(!(Vr(t,"beforeChange")||t.cm&&Vr(t.cm,"beforeChange"))||(e=He(t,e))){var i=Di&&!r&&Nn(t,e.from,e.to);if(i){for(var o=i.length-1;o>=1;--o)Ie(t,{from:i[o].from,to:i[o].to,text:[""]});i.length&&Ie(t,{from:i[0].from,to:i[0].to,text:e.text},n)}else Ie(t,e,n)}}function Ie(t,e,n){var r=Ne(t,e,n);wr(t,e,r,t.cm?t.cm.curOp.id:0/0),We(t,e,r,An(t,e));var i=[];lr(t,function(t,n){n||-1!=qr(i,t.history)||(Sr(t.history,e),i.push(t.history)),We(t,e,null,An(t,e))})}function Re(t,e){if(!t.cm||!t.cm.state.suppressEdits){var n=t.history,r=("undo"==e?n.done:n.undone).pop();if(r){n.dirtyCounter+="undo"==e?-1:1;var i={changes:[],anchorBefore:r.anchorAfter,headBefore:r.headAfter,anchorAfter:r.anchorBefore,headAfter:r.headBefore};("undo"==e?n.undone:n.done).push(i);for(var o=r.changes.length-1;o>=0;--o){var s=r.changes[o];s.origin=e,i.changes.push(_r(t,s));var l=o?Ne(t,s,null):{anchor:r.anchorBefore,head:r.headBefore};We(t,s,l,On(t,s));var a=[];lr(t,function(t,e){e||-1!=qr(a,t.history)||(Sr(t.history,s),a.push(t.history)),We(t,s,null,On(t,s))})}}}}function De(t,e){function n(t){return Fe(t.line+e,t.ch)}t.first+=e,t.cm&&ie(t.cm,t.first,t.first,e),t.sel.head=n(t.sel.head),t.sel.anchor=n(t.sel.anchor),t.sel.from=n(t.sel.from),t.sel.to=n(t.sel.to)}function We(t,e,n,r){if(t.cm&&!t.cm.curOp)return ee(t.cm,We)(t,e,n,r);if(e.to.line<t.first)return De(t,e.text.length-1-(e.to.line-e.from.line)),void 0;if(!(e.from.line>t.lastLine())){if(e.from.line<t.first){var i=e.text.length-1-(t.first-e.from.line);De(t,i),e={from:Fe(t.first,0),to:Fe(e.to.line+i,e.to.ch),text:[jr(e.text)],origin:e.origin}}var o=t.lastLine();e.to.line>o&&(e={from:e.from,to:Fe(o,ur(t,o).text.length),text:[e.text[0]],origin:e.origin}),e.removed=cr(t,e.from,e.to),n||(n=Ne(t,e,null)),t.cm?Ve(t.cm,e,r,n):ir(t,e,r,n)}}function Ve(t,e,n,r){var o=t.doc,s=t.display,l=e.from,a=e.to,u=!1,h=l.line;t.options.lineWrapping||(h=dr(Rn(o,ur(o,l.line))),o.iter(h,a.line+1,function(t){return t==s.maxLine?(u=!0,!0):void 0})),je(o.sel.head,e.from)||je(e.to,o.sel.head)||(t.curOp.cursorActivity=!0),ir(o,e,n,r,i(t)),t.options.lineWrapping||(o.iter(h,l.line+e.text.length,function(t){var e=c(o,t);e>s.maxLineLength&&(s.maxLine=t,s.maxLineLength=e,s.maxLineChanged=!0,u=!1)}),u&&(t.curOp.updateMaxLine=!0)),o.frontier=Math.min(o.frontier,l.line),O(t,400);var f=e.text.length-(a.line-l.line)-1;if(ie(t,l.line,a.line+1,f),Vr(t,"change")){var d={from:l,to:a,text:e.text,removed:e.removed,origin:e.origin};if(t.curOp.textChanged){for(var p=t.curOp.textChanged;p.next;p=p.next);p.next=d}else t.curOp.textChanged=d}}function ze(t,e,n,r,i){if(r||(r=n),je(r,n)){var o=r;r=n,n=o}"string"==typeof e&&(e=_o(e)),Pe(t,{from:n,to:r,text:e,origin:i},null)}function Fe(t,e){return this instanceof Fe?(this.line=t,this.ch=e,void 0):new Fe(t,e)}function Be(t,e){return t.line==e.line&&t.ch==e.ch}function je(t,e){return t.line<e.line||t.line==e.line&&t.ch<e.ch}function $e(t){return Fe(t.line,t.ch)}function qe(t,e){return Math.max(t.first,Math.min(e,t.first+t.size-1))}function Ue(t,e){if(e.line<t.first)return Fe(t.first,0);var n=t.first+t.size-1;return e.line>n?Fe(n,ur(t,n).text.length):Ge(e,ur(t,e.line).text.length)}function Ge(t,e){var n=t.ch;return null==n||n>e?Fe(t.line,e):0>n?Fe(t.line,0):t}function Ke(t,e){return e>=t.first&&t.first+t.size>e}function Je(t,e,n,r){if(t.sel.shift||t.sel.extend){var i=t.sel.anchor;if(n){var o=je(e,i);o!=je(n,i)?(i=e,e=n):o!=je(e,n)&&(e=n)}Ye(t,i,e,r)}else Ye(t,e,n||e,r);t.cm&&(t.cm.curOp.userSelChange=!0)}function Xe(t,e,n){var r={anchor:e,head:n};return Rr(t,"beforeSelectionChange",t,r),t.cm&&Rr(t.cm,"beforeSelectionChange",t.cm,r),r.anchor=Ue(t,r.anchor),r.head=Ue(t,r.head),r}function Ye(t,e,n,r,i){if(!i&&Vr(t,"beforeSelectionChange")||t.cm&&Vr(t.cm,"beforeSelectionChange")){var o=Xe(t,e,n);n=o.head,e=o.anchor}var s=t.sel;if(s.goalColumn=null,(i||!Be(e,s.anchor))&&(e=Qe(t,e,r,"push"!=i)),(i||!Be(n,s.head))&&(n=Qe(t,n,r,"push"!=i)),!Be(s.anchor,e)||!Be(s.head,n)){s.anchor=e,s.head=n;var l=je(n,e);s.from=l?n:e,s.to=l?e:n,t.cm&&(t.cm.curOp.updateInput=t.cm.curOp.selectionChanged=t.cm.curOp.cursorActivity=!0),Dr(t,"cursorActivity",t)}}function Ze(t){Ye(t.doc,t.doc.sel.from,t.doc.sel.to,null,"push")}function Qe(t,e,n,r){var i=!1,o=e,s=n||1;t.cantEdit=!1;t:for(;;){var l=ur(t,o.line);if(l.markedSpans)for(var a=0;l.markedSpans.length>a;++a){var u=l.markedSpans[a],c=u.marker;if((null==u.from||(c.inclusiveLeft?u.from<=o.ch:u.from<o.ch))&&(null==u.to||(c.inclusiveRight?u.to>=o.ch:u.to>o.ch))){if(r&&(Rr(c,"beforeCursorEnter"),c.explicitlyCleared)){if(l.markedSpans){--a;continue}break}if(!c.atomic)continue;var h=c.find()[0>s?"from":"to"];if(Be(h,o)&&(h.ch+=s,0>h.ch?h=h.line>t.first?Ue(t,Fe(h.line-1)):null:h.ch>l.text.length&&(h=h.line<t.first+t.size-1?Fe(h.line+1,0):null),!h)){if(i)return r?(t.cantEdit=!0,Fe(t.first,0)):Qe(t,e,n,!0);i=!0,h=e,s=-s}o=h;continue t}}return o}}function tn(t){var e=en(t,t.doc.sel.head);if(t.state.focused){var n=t.display,r=ni(n.sizer),i=null,o=I(t.display);if(0>e.top+o+r.top?i=!0:e.bottom+o+r.top>(window.innerHeight||document.documentElement.clientHeight)&&(i=!1),null!=i&&!Si){var s="none"==n.cursor.style.display;s&&(n.cursor.style.display="",n.cursor.style.left=e.left+"px",n.cursor.style.top=e.top-n.viewOffset+"px"),n.cursor.scrollIntoView(i),s&&(n.cursor.style.display="none")}}}function en(t,e,n){for(null==n&&(n=0);;){var r=!1,i=G(t,e),o=rn(t,i.left,i.top-n,i.left,i.bottom+n),s=t.doc.scrollTop,l=t.doc.scrollLeft;if(null!=o.scrollTop&&(ye(t,o.scrollTop),Math.abs(t.doc.scrollTop-s)>1&&(r=!0)),null!=o.scrollLeft&&(_e(t,o.scrollLeft),Math.abs(t.doc.scrollLeft-l)>1&&(r=!0)),!r)return i}}function nn(t,e,n,r,i){var o=rn(t,e,n,r,i);null!=o.scrollTop&&ye(t,o.scrollTop),null!=o.scrollLeft&&_e(t,o.scrollLeft)}function rn(t,e,n,r,i){var o=t.display,s=I(o);n+=s,i+=s,0>n&&(n=0);var l=o.scroller.clientHeight-uo,a=o.scroller.scrollTop,u={},c=t.doc.height+R(o),h=s+10>n,f=i+s>c-10;if(a>n)u.scrollTop=h?0:n;else if(i>a+l){var d=Math.min(n,(f?c:i)-l);d!=a&&(u.scrollTop=d)}var p=o.scroller.clientWidth-uo,g=o.scroller.scrollLeft;e+=o.gutters.offsetWidth,r+=o.gutters.offsetWidth;var m=o.gutters.offsetWidth,v=m+10>e;return g+m>e||v?(v&&(e=0),u.scrollLeft=Math.max(0,e-10-m)):r>p+g-3&&(u.scrollLeft=r+10-p),u}function on(t,e,n){t.curOp.updateScrollPos={scrollLeft:null==e?t.doc.scrollLeft:e,scrollTop:null==n?t.doc.scrollTop:n}}function sn(t,e,n){var r=t.curOp.updateScrollPos||(t.curOp.updateScrollPos={scrollLeft:t.doc.scrollLeft,scrollTop:t.doc.scrollTop}),i=t.display.scroller;r.scrollTop=Math.max(0,Math.min(i.scrollHeight-i.clientHeight,r.scrollTop+n)),r.scrollLeft=Math.max(0,Math.min(i.scrollWidth-i.clientWidth,r.scrollLeft+e))}function ln(t,e,n,r){var i=t.doc;if(n||(n="add"),"smart"==n)if(t.doc.mode.indent)var o=P(t,e);else n="prev";var s,l=t.options.tabSize,a=ur(i,e),u=Fr(a.text,null,l),c=a.text.match(/^\s*/)[0];if("smart"==n&&(s=t.doc.mode.indent(o,a.text.slice(c.length),a.text),s==co)){if(!r)return;n="prev"}"prev"==n?s=e>i.first?Fr(ur(i,e-1).text,null,l):0:"add"==n?s=u+t.options.indentUnit:"subtract"==n&&(s=u-t.options.indentUnit),s=Math.max(0,s);var h="",f=0;if(t.options.indentWithTabs)for(var d=Math.floor(s/l);d;--d)f+=l,h+="	";s>f&&(h+=Br(s-f)),h!=c&&ze(t.doc,h,Fe(e,0),Fe(e,c.length),"+input"),a.stateAfter=null}function an(t,e,n){var r=e,i=e,o=t.doc;return"number"==typeof e?i=ur(o,qe(o,e)):r=dr(e),null==r?null:n(i,r)?(ie(t,r,r+1),i):null}function un(t,e,n,r,i){function o(){var e=l+n;return t.first>e||e>=t.first+t.size?c=!1:(l=e,u=ur(t,e))}function s(t){var e=(i?fi:di)(u,a,n,!0);if(null==e){if(t||!o())return c=!1;a=i?(0>n?ui:ai)(u):0>n?u.text.length:0}else a=e;return!0}var l=e.line,a=e.ch,u=ur(t,l),c=!0;if("char"==r)s();else if("column"==r)s(!0);else if("word"==r||"group"==r)for(var h=null,f="group"==r,d=!0;!(0>n)||s(!d);d=!1){var p=u.text.charAt(a)||"\n",g=Xr(p)?"w":f?/\s/.test(p)?null:"p":null;if(h&&h!=g){0>n&&(n=1,s());break}if(g&&(h=g),n>0&&!s(!d))break}var m=Qe(t,Fe(l,a),n,!0);return c||(m.hitSide=!0),m}function cn(t,e,n,r){var i,o=t.doc,s=e.left;if("page"==r){var l=Math.min(t.display.wrapper.clientHeight,window.innerHeight||document.documentElement.clientHeight);i=e.top+n*(l-(0>n?1.5:.5)*Y(t.display))}else"line"==r&&(i=n>0?e.bottom+3:e.top-3);for(;;){var a=J(t,s,i);if(!a.outside)break;if(0>n?0>=i:i>=o.height){a.hitSide=!0;break}i+=5*n}return a}function hn(t,e){var n=e.ch,r=e.ch;if(t){e.after===!1||r==t.length?--n:++r;for(var i=t.charAt(n),o=Xr(i)?Xr:/\s/.test(i)?function(t){return/\s/.test(t)}:function(t){return!/\s/.test(t)&&!Xr(t)};n>0&&o(t.charAt(n-1));)--n;for(;t.length>r&&o(t.charAt(r));)++r}return{from:Fe(e.line,n),to:Fe(e.line,r)}}function fn(t,e){Je(t.doc,Fe(e,0),Ue(t.doc,Fe(e+1,0)))}function dn(e,n,r,i){t.defaults[e]=n,r&&(qi[e]=i?function(t,e,n){n!=Gi&&r(t,e,n)}:r)}function pn(t,e){if(e===!0)return e;if(t.copyState)return t.copyState(e);var n={};for(var r in e){var i=e[r];i instanceof Array&&(i=i.concat([])),n[r]=i}return n}function gn(t,e,n){return t.startState?t.startState(e,n):!0}function mn(t){return"string"==typeof t?Qi[t]:t}function vn(t,e,n){function r(e){e=mn(e);var i=e[t];if(i===!1)return"stop";if(null!=i&&n(i))return!0;if(e.nofallthrough)return"stop";var o=e.fallthrough;if(null==o)return!1;if("[object Array]"!=Object.prototype.toString.call(o))return r(o);for(var s=0,l=o.length;l>s;++s){var a=r(o[s]);if(a)return a}return!1}for(var i=0;e.length>i;++i){var o=r(e[i]);if(o)return o}}function yn(t){var e=xo[t.keyCode];return"Ctrl"==e||"Alt"==e||"Shift"==e||"Mod"==e}function _n(t,e){if(bi&&34==t.keyCode&&t["char"])return!1;var n=xo[t.keyCode];return null==n||t.altGraphKey?!1:(t.altKey&&(n="Alt-"+n),(Ii?t.metaKey:t.ctrlKey)&&(n="Ctrl-"+n),(Ii?t.ctrlKey:t.metaKey)&&(n="Cmd-"+n),!e&&t.shiftKey&&(n="Shift-"+n),n)}function wn(t,e){this.pos=this.start=0,this.string=t,this.tabSize=e||8,this.lastColumnPos=this.lastColumnValue=0}function bn(t,e){this.lines=[],this.type=e,this.doc=t}function xn(t,e,n,r,i){if(r&&r.shared)return kn(t,e,n,r,i);if(t.cm&&!t.cm.curOp)return ee(t.cm,xn)(t,e,n,r,i);var o=new bn(t,i);if("range"==i&&!je(e,n))return o;r&&Gr(r,o),o.replacedWith&&(o.collapsed=!0,o.replacedWith=Zr("span",[o.replacedWith],"CodeMirror-widget")),o.collapsed&&(Wi=!0),o.addToHistory&&wr(t,{from:e,to:n,origin:"markText"},{head:t.sel.head,anchor:t.sel.anchor},0/0);var s,l,a,u=e.line,c=0,h=t.cm;if(t.iter(u,n.line+1,function(r){h&&o.collapsed&&!h.options.lineWrapping&&Rn(t,r)==h.display.maxLine&&(a=!0);var i={from:null,to:null,marker:o};c+=r.text.length,u==e.line&&(i.from=e.ch,c-=e.ch),u==n.line&&(i.to=n.ch,c-=r.text.length-n.ch),o.collapsed&&(u==n.line&&(l=Hn(r,n.ch)),u==e.line?s=Hn(r,e.ch):fr(r,0)),Mn(r,i),++u}),o.collapsed&&t.iter(e.line,n.line+1,function(e){Dn(t,e)&&fr(e,0)}),o.clearOnEnter&&Pr(o,"beforeCursorEnter",function(){o.clear()}),o.readOnly&&(Di=!0,(t.history.done.length||t.history.undone.length)&&t.clearHistory()),o.collapsed){if(s!=l)throw Error("Inserting collapsed marker overlapping an existing one");o.size=c,o.atomic=!0}return h&&(a&&(h.curOp.updateMaxLine=!0),(o.className||o.startStyle||o.endStyle||o.collapsed)&&ie(h,e.line,n.line+1),o.atomic&&Ze(h)),o}function Cn(t,e){this.markers=t,this.primary=e;for(var n=0,r=this;t.length>n;++n)t[n].parent=this,Pr(t[n],"clear",function(){r.clear()})}function kn(t,e,n,r,i){r=Gr(r),r.shared=!1;var o=[xn(t,e,n,r,i)],s=o[0],l=r.replacedWith;return lr(t,function(t){l&&(r.replacedWith=l.cloneNode(!0)),o.push(xn(t,Ue(t,e),Ue(t,n),r,i));for(var a=0;t.linked.length>a;++a)if(t.linked[a].isParent)return;s=jr(o)}),new Cn(o,s)}function Ln(t,e){if(t)for(var n=0;t.length>n;++n){var r=t[n];if(r.marker==e)return r}}function Sn(t,e){for(var n,r=0;t.length>r;++r)t[r]!=e&&(n||(n=[])).push(t[r]);return n}function Mn(t,e){t.markedSpans=t.markedSpans?t.markedSpans.concat([e]):[e],e.marker.attachLine(t)}function Tn(t,e,n){if(t)for(var r,i=0;t.length>i;++i){var o=t[i],s=o.marker,l=null==o.from||(s.inclusiveLeft?e>=o.from:e>o.from);if(l||"bookmark"==s.type&&o.from==e&&(!n||!o.marker.insertLeft)){var a=null==o.to||(s.inclusiveRight?o.to>=e:o.to>e);(r||(r=[])).push({from:o.from,to:a?null:o.to,marker:s})}}return r}function En(t,e,n){if(t)for(var r,i=0;t.length>i;++i){var o=t[i],s=o.marker,l=null==o.to||(s.inclusiveRight?o.to>=e:o.to>e);if(l||"bookmark"==s.type&&o.from==e&&(!n||o.marker.insertLeft)){var a=null==o.from||(s.inclusiveLeft?e>=o.from:e>o.from);(r||(r=[])).push({from:a?null:o.from-e,to:null==o.to?null:o.to-e,marker:s})}}return r}function An(t,e){var n=Ke(t,e.from.line)&&ur(t,e.from.line).markedSpans,r=Ke(t,e.to.line)&&ur(t,e.to.line).markedSpans;if(!n&&!r)return null;var i=e.from.ch,o=e.to.ch,s=Be(e.from,e.to),l=Tn(n,i,s),a=En(r,o,s),u=1==e.text.length,c=jr(e.text).length+(u?i:0);if(l)for(var h=0;l.length>h;++h){var f=l[h];if(null==f.to){var d=Ln(a,f.marker);d?u&&(f.to=null==d.to?null:d.to+c):f.to=i}}if(a)for(var h=0;a.length>h;++h){var f=a[h];if(null!=f.to&&(f.to+=c),null==f.from){var d=Ln(l,f.marker);d||(f.from=c,u&&(l||(l=[])).push(f))}else f.from+=c,u&&(l||(l=[])).push(f)}var p=[l];if(!u){var g,m=e.text.length-2;if(m>0&&l)for(var h=0;l.length>h;++h)null==l[h].to&&(g||(g=[])).push({from:null,to:null,marker:l[h].marker});for(var h=0;m>h;++h)p.push(g);p.push(a)}return p}function On(t,e){var n=xr(t,e),r=An(t,e);if(!n)return r;if(!r)return n;for(var i=0;n.length>i;++i){var o=n[i],s=r[i];if(o&&s)t:for(var l=0;s.length>l;++l){for(var a=s[l],u=0;o.length>u;++u)if(o[u].marker==a.marker)continue t;o.push(a)}else s&&(n[i]=s)}return n}function Nn(t,e,n){var r=null;if(t.iter(e.line,n.line+1,function(t){if(t.markedSpans)for(var e=0;t.markedSpans.length>e;++e){var n=t.markedSpans[e].marker;!n.readOnly||r&&-1!=qr(r,n)||(r||(r=[])).push(n)}}),!r)return null;for(var i=[{from:e,to:n}],o=0;r.length>o;++o)for(var s=r[o],l=s.find(),a=0;i.length>a;++a){var u=i[a];if(!je(u.to,l.from)&&!je(l.to,u.from)){var c=[a,1];(je(u.from,l.from)||!s.inclusiveLeft&&Be(u.from,l.from))&&c.push({from:u.from,to:l.from}),(je(l.to,u.to)||!s.inclusiveRight&&Be(u.to,l.to))&&c.push({from:l.to,to:u.to}),i.splice.apply(i,c),a+=c.length-1}}return i}function Hn(t,e){var n,r=Wi&&t.markedSpans;if(r)for(var i,o=0;r.length>o;++o)i=r[o],i.marker.collapsed&&(null==i.from||e>i.from)&&(null==i.to||i.to>e)&&(!n||n.width<i.marker.width)&&(n=i.marker);return n}function Pn(t){return Hn(t,-1)}function In(t){return Hn(t,t.text.length+1)}function Rn(t,e){for(var n;n=Pn(e);)e=ur(t,n.find().from.line);return e}function Dn(t,e){var n=Wi&&e.markedSpans;if(n)for(var r,i=0;n.length>i;++i)if(r=n[i],r.marker.collapsed){if(null==r.from)return!0;if(0==r.from&&r.marker.inclusiveLeft&&Wn(t,e,r))return!0}}function Wn(t,e,n){if(null==n.to){var r=n.marker.find().to,i=ur(t,r.line);return Wn(t,i,Ln(i.markedSpans,n.marker))}if(n.marker.inclusiveRight&&n.to==e.text.length)return!0;for(var o,s=0;e.markedSpans.length>s;++s)if(o=e.markedSpans[s],o.marker.collapsed&&o.from==n.to&&(o.marker.inclusiveLeft||n.marker.inclusiveRight)&&Wn(t,e,o))return!0}function Vn(t){var e=t.markedSpans;if(e){for(var n=0;e.length>n;++n)e[n].marker.detachLine(t);t.markedSpans=null}}function zn(t,e){if(e){for(var n=0;e.length>n;++n)e[n].marker.attachLine(t);t.markedSpans=e}}function Fn(t){return function(){var e=!this.cm.curOp;e&&Q(this.cm);try{var n=t.apply(this,arguments)}finally{e&&te(this.cm)}return n}}function Bn(t){return null!=t.height?t.height:(t.node.parentNode&&1==t.node.parentNode.nodeType||ti(t.cm.display.measure,Zr("div",[t.node],null,"position: relative")),t.height=t.node.offsetHeight)}function jn(t,e,n,r){var i=new to(t,n,r);return i.noHScroll&&(t.display.alignWidgets=!0),an(t,e,function(e){if((e.widgets||(e.widgets=[])).push(i),i.line=e,!Dn(t.doc,e)||i.showIfHidden){var n=gr(t,e)<t.display.scroller.scrollTop;fr(e,e.height+Bn(i)),n&&sn(t,0,i.height)}return!0}),i}function $n(t,e,n){var r={text:t};return zn(r,e),r.height=n?n(r):1,r}function qn(t,e,n,r){t.text=e,t.stateAfter&&(t.stateAfter=null),t.styles&&(t.styles=null),null!=t.order&&(t.order=null),Vn(t),zn(t,n);var i=r?r(t):1;i!=t.height&&fr(t,i)}function Un(t){t.parent=null,Vn(t)}function Gn(t,e,n,r,i){var o=n.flattenSpans;null==o&&(o=t.options.flattenSpans);var s,l="",a=null,u=new wn(e,t.options.tabSize);for(""==e&&n.blankLine&&n.blankLine(r);!u.eol();){u.pos>t.options.maxHighlightLength?(o=!1,u.pos=Math.min(e.length,u.start+5e4),s=null):s=n.token(u,r);var c=u.current();u.start=u.pos,o&&a==s?l+=c:(l&&i(l,a),l=c,a=s)}l&&i(l,a)}function Kn(t,e,n){var r=[t.state.modeGen];Gn(t,e.text,t.doc.mode,n,function(t,e){r.push(t,e)});for(var i=0;t.state.overlays.length>i;++i){var o=t.state.overlays[i],s=1;Gn(t,e.text,o.mode,!0,function(t,e){for(var n=s,i=t.length;i;){var l=r[s],a=l.length;i>=a?i-=a:(r.splice(s,1,l.slice(0,i),r[s+1],l.slice(i)),i=0),s+=2}if(e)if(o.opaque)r.splice(n,s-n,t,e),s=n+2;else for(;s>n;n+=2){var l=r[n+1];r[n+1]=l?l+" "+e:e}})}return r}function Jn(t,e){return e.styles&&e.styles[0]==t.state.modeGen||(e.styles=Kn(t,e,e.stateAfter=P(t,dr(e)))),e.styles}function Xn(t,e,n){var r=t.doc.mode,i=new wn(e.text,t.options.tabSize);for(""==e.text&&r.blankLine&&r.blankLine(n);!i.eol()&&i.pos<=t.options.maxHighlightLength;)r.token(i,n),i.start=i.pos}function Yn(t){return t?eo[t]||(eo[t]="cm-"+t.replace(/ +/g," cm-")):null}function Zn(t,e,n){for(var r,i,o,s=e,l=!0;r=Pn(s);)l=!1,s=ur(t.doc,r.find().from.line),i||(i=s);var a={pre:Zr("pre"),col:0,pos:0,display:!n,measure:null,addedOne:!1,cm:t};s.textClass&&(a.pre.className=s.textClass);do{a.measure=s==e&&n,a.pos=0,a.addToken=a.measure?tr:Qn,(gi||yi)&&t.getOption("lineWrapping")&&(a.addToken=er(a.addToken)),n&&o&&s!=e&&!a.addedOne&&(n[0]=a.pre.appendChild(ii(t.display.measure)),a.addedOne=!0);var u=rr(s,a,Jn(t,s));o=s==i,u&&(s=ur(t.doc,u.to.line),l=!1)}while(u);n&&!a.addedOne&&(n[0]=a.pre.appendChild(l?Zr("span",""):ii(t.display.measure))),a.pre.firstChild||Dn(t.doc,e)||a.pre.appendChild(document.createTextNode(""));var c;if(n&&gi&&(c=mr(s))){var h=c.length-1;c[h].from==c[h].to&&--h;var f=c[h],d=c[h-1];if(f.from+1==f.to&&d&&f.level<d.level){var p=n[a.pos-1];p&&p.parentNode.insertBefore(p.measureRight=ii(t.display.measure),p.nextSibling)}}return Rr(t,"renderLine",t,e,a.pre),a.pre}function Qn(t,e,n,r,i){if(e){if(no.test(e))for(var o=document.createDocumentFragment(),s=0;;){no.lastIndex=s;var l=no.exec(e),a=l?l.index-s:e.length-s;if(a&&(o.appendChild(document.createTextNode(e.slice(s,s+a))),t.col+=a),!l)break;if(s+=a+1,"	"==l[0]){var u=t.cm.options.tabSize,c=u-t.col%u;o.appendChild(Zr("span",Br(c),"cm-tab")),t.col+=c}else{var h=Zr("span","","cm-invalidchar");h.title="\\u"+l[0].charCodeAt(0).toString(16),o.appendChild(h),t.col+=1}}else{t.col+=e.length;var o=document.createTextNode(e)}if(n||r||i||t.measure){var f=n||"";return r&&(f+=r),i&&(f+=i),t.pre.appendChild(Zr("span",[o],f))}t.pre.appendChild(o)}}function tr(t,e,n,r,i){for(var o=t.cm.options.lineWrapping,s=0;e.length>s;++s){var l=e.charAt(s),a=0==s;l>=""&&"">l&&e.length-1>s?(l=e.slice(s,s+2),++s):s&&o&&mo.test(e.slice(s-1,s+1))&&t.pre.appendChild(Zr("wbr"));var u=t.measure[t.pos]=Qn(t,l,n,a&&r,s==e.length-1&&i);gi&&o&&" "==l&&s&&!/\s/.test(e.charAt(s-1))&&e.length-1>s&&!/\s/.test(e.charAt(s+1))&&(u.style.whiteSpace="normal"),t.pos+=l.length}e.length&&(t.addedOne=!0)}function er(t){function e(t){for(var e=" ",n=0;t.length-2>n;++n)e+=n%2?" ":"";return e+=" "}return function(n,r,i,o,s){return t(n,r.replace(/ {3,}/,e),i,o,s)}}function nr(t,e,n){n&&(t.display||(n=n.cloneNode(!0)),t.pre.appendChild(n),t.measure&&e&&(t.measure[t.pos]=n,t.addedOne=!0)),t.pos+=e}function rr(t,e,n){var r=t.markedSpans;if(r)for(var i,o,s,l,a,u=t.text,c=u.length,h=0,f=1,d="",p=0;;){if(p==h){o=s=l="",a=null,p=1/0;for(var g=null,m=0;r.length>m;++m){var v=r[m],y=v.marker;h>=v.from&&(null==v.to||v.to>h)?(null!=v.to&&p>v.to&&(p=v.to,s=""),y.className&&(o+=" "+y.className),y.startStyle&&v.from==h&&(l+=" "+y.startStyle),y.endStyle&&v.to==p&&(s+=" "+y.endStyle),y.collapsed&&(!a||a.marker.width<y.width)&&(a=v)):v.from>h&&p>v.from&&(p=v.from),"bookmark"==y.type&&v.from==h&&y.replacedWith&&(g=y.replacedWith)}if(a&&(a.from||0)==h&&(nr(e,(null==a.to?c:a.to)-h,null!=a.from&&a.marker.replacedWith),null==a.to))return a.marker.find();g&&!a&&nr(e,0,g)}if(h>=c)break;for(var _=Math.min(c,p);;){if(d){var w=h+d.length;if(!a){var b=w>_?d.slice(0,_-h):d;e.addToken(e,b,i?i+o:o,l,h+b.length==p?s:"")}if(w>=_){d=d.slice(_-h),h=_;break}h=w,l=""}d=n[f++],i=Yn(n[f++])}}else for(var f=1;n.length>f;f+=2)e.addToken(e,n[f],Yn(n[f+1]))}function ir(t,e,n,r,i){function o(t){return n?n[t]:null}function s(t,n,r){qn(t,n,r,i),Dr(t,"change",t,e)}var l=e.from,a=e.to,u=e.text,c=ur(t,l.line),h=ur(t,a.line),f=jr(u),d=o(u.length-1),p=a.line-l.line;if(0==l.ch&&0==a.ch&&""==f){for(var g=0,m=u.length-1,v=[];m>g;++g)v.push($n(u[g],o(g),i));s(h,h.text,d),p&&t.remove(l.line,p),v.length&&t.insert(l.line,v)}else if(c==h)if(1==u.length)s(c,c.text.slice(0,l.ch)+f+c.text.slice(a.ch),d);else{for(var v=[],g=1,m=u.length-1;m>g;++g)v.push($n(u[g],o(g),i));v.push($n(f+c.text.slice(a.ch),d,i)),s(c,c.text.slice(0,l.ch)+u[0],o(0)),t.insert(l.line+1,v)}else if(1==u.length)s(c,c.text.slice(0,l.ch)+u[0]+h.text.slice(a.ch),o(0)),t.remove(l.line+1,p);else{s(c,c.text.slice(0,l.ch)+u[0],o(0)),s(h,f+h.text.slice(a.ch),d);for(var g=1,m=u.length-1,v=[];m>g;++g)v.push($n(u[g],o(g),i));p>1&&t.remove(l.line+1,p-1),t.insert(l.line+1,v)}Dr(t,"change",t,e),Ye(t,r.anchor,r.head,null,!0)}function or(t){this.lines=t,this.parent=null;for(var e=0,n=t.length,r=0;n>e;++e)t[e].parent=this,r+=t[e].height;this.height=r}function sr(t){this.children=t;for(var e=0,n=0,r=0,i=t.length;i>r;++r){var o=t[r];e+=o.chunkSize(),n+=o.height,o.parent=this}this.size=e,this.height=n,this.parent=null}function lr(t,e,n){function r(t,i,o){if(t.linked)for(var s=0;t.linked.length>s;++s){var l=t.linked[s];if(l.doc!=i){var a=o&&l.sharedHist;(!n||a)&&(e(l.doc,a),r(l.doc,t,a))}}}r(t,null,!0)}function ar(t,e){if(e.cm)throw Error("This document is already in use.");t.doc=e,e.cm=t,o(t),n(t),t.options.lineWrapping||h(t),t.options.mode=e.modeOption,ie(t)}function ur(t,e){for(e-=t.first;!t.lines;)for(var n=0;;++n){var r=t.children[n],i=r.chunkSize();if(i>e){t=r;break}e-=i}return t.lines[e]}function cr(t,e,n){var r=[],i=e.line;return t.iter(e.line,n.line+1,function(t){var o=t.text;i==n.line&&(o=o.slice(0,n.ch)),i==e.line&&(o=o.slice(e.ch)),r.push(o),++i}),r}function hr(t,e,n){var r=[];return t.iter(e,n,function(t){r.push(t.text)}),r}function fr(t,e){for(var n=e-t.height,r=t;r;r=r.parent)r.height+=n}function dr(t){if(null==t.parent)return null;for(var e=t.parent,n=qr(e.lines,t),r=e.parent;r;e=r,r=r.parent)for(var i=0;r.children[i]!=e;++i)n+=r.children[i].chunkSize();return n+e.first}function pr(t,e){var n=t.first;t:do{for(var r=0,i=t.children.length;i>r;++r){var o=t.children[r],s=o.height;if(s>e){t=o;continue t}e-=s,n+=o.chunkSize()}return n}while(!t.lines);for(var r=0,i=t.lines.length;i>r;++r){var l=t.lines[r],a=l.height;if(a>e)break;e-=a}return n+r}function gr(t,e){e=Rn(t.doc,e);for(var n=0,r=e.parent,i=0;r.lines.length>i;++i){var o=r.lines[i];if(o==e)break;n+=o.height}for(var s=r.parent;s;r=s,s=r.parent)for(var i=0;s.children.length>i;++i){var l=s.children[i];if(l==r)break;n+=l.height}return n}function mr(t){var e=t.order;return null==e&&(e=t.order=Co(t.text)),e}function vr(){return{done:[],undone:[],undoDepth:1/0,lastTime:0,lastOp:null,lastOrigin:null,dirtyCounter:0}}function yr(t,e,n,r){var i=e["spans_"+t.id],o=0;t.iter(Math.max(t.first,n),Math.min(t.first+t.size,r),function(n){n.markedSpans&&((i||(i=e["spans_"+t.id]={}))[o]=n.markedSpans),++o})}function _r(t,e){var n={from:e.from,to:Ae(e),text:cr(t,e.from,e.to)};return yr(t,n,e.from.line,e.to.line+1),lr(t,function(t){yr(t,n,e.from.line,e.to.line+1)},!0),n}function wr(t,e,n,r){var i=t.history;i.undone.length=0;var o=+new Date,s=jr(i.done);if(s&&(i.lastOp==r||i.lastOrigin==e.origin&&e.origin&&("+"==e.origin.charAt(0)&&t.cm&&i.lastTime>o-t.cm.options.historyEventDelay||"*"==e.origin.charAt(0)))){var l=jr(s.changes);Be(e.from,e.to)&&Be(e.from,l.to)?l.to=Ae(e):s.changes.push(_r(t,e)),s.anchorAfter=n.anchor,s.headAfter=n.head}else{for(s={changes:[_r(t,e)],anchorBefore:t.sel.anchor,headBefore:t.sel.head,anchorAfter:n.anchor,headAfter:n.head},i.done.push(s);i.done.length>i.undoDepth;)i.done.shift();0>i.dirtyCounter?i.dirtyCounter=0/0:i.dirtyCounter++}i.lastTime=o,i.lastOp=r,i.lastOrigin=e.origin}function br(t){if(!t)return null;for(var e,n=0;t.length>n;++n)t[n].marker.explicitlyCleared?e||(e=t.slice(0,n)):e&&e.push(t[n]);return e?e.length?e:null:t}function xr(t,e){var n=e["spans_"+t.id];if(!n)return null;for(var r=0,i=[];e.text.length>r;++r)i.push(br(n[r]));return i}function Cr(t,e){for(var n=0,r=[];t.length>n;++n){var i=t[n],o=i.changes,s=[];r.push({changes:s,anchorBefore:i.anchorBefore,headBefore:i.headBefore,anchorAfter:i.anchorAfter,headAfter:i.headAfter});for(var l=0;o.length>l;++l){var a,u=o[l];if(s.push({from:u.from,to:u.to,text:u.text}),e)for(var c in u)(a=c.match(/^spans_(\d+)$/))&&qr(e,Number(a[1]))>-1&&(jr(s)[c]=u[c],delete u[c])}}return r}function kr(t,e,n,r){t.line>n?t.line+=r:t.line>e&&(t.line=e,t.ch=0)}function Lr(t,e,n,r){for(var i=0;t.length>i;++i){for(var o=t[i],s=!0,l=0;o.changes.length>l;++l){var a=o.changes[l];if(o.copied||(a.from=$e(a.from),a.to=$e(a.to)),a.from.line>n)a.from.line+=r,a.to.line+=r;else if(a.to.line>=e){s=!1;break}}o.copied||(o.anchorBefore=$e(o.anchorBefore),o.headBefore=$e(o.headBefore),o.anchorAfter=$e(o.anchorAfter),o.readAfter=$e(o.headAfter),o.copied=!0),s?(kr(o.anchorBefore),kr(o.headBefore),kr(o.anchorAfter),kr(o.headAfter)):(t.splice(0,i+1),i=0)}}function Sr(t,e){var n=e.from.line,r=e.to.line,i=e.text.length-(r-n)-1;Lr(t.done,n,r,i),Lr(t.undone,n,r,i)}function Mr(){Or(this)}function Tr(t){return t.stop||(t.stop=Mr),t}function Er(t){t.preventDefault?t.preventDefault():t.returnValue=!1}function Ar(t){t.stopPropagation?t.stopPropagation():t.cancelBubble=!0}function Or(t){Er(t),Ar(t)}function Nr(t){return t.target||t.srcElement}function Hr(t){var e=t.which;return null==e&&(1&t.button?e=1:2&t.button?e=3:4&t.button&&(e=2)),Ei&&t.ctrlKey&&1==e&&(e=3),e}function Pr(t,e,n){if(t.addEventListener)t.addEventListener(e,n,!1);else if(t.attachEvent)t.attachEvent("on"+e,n);else{var r=t._handlers||(t._handlers={}),i=r[e]||(r[e]=[]);i.push(n)}}function Ir(t,e,n){if(t.removeEventListener)t.removeEventListener(e,n,!1);else if(t.detachEvent)t.detachEvent("on"+e,n);else{var r=t._handlers&&t._handlers[e];if(!r)return;for(var i=0;r.length>i;++i)if(r[i]==n){r.splice(i,1);break}}}function Rr(t,e){var n=t._handlers&&t._handlers[e];if(n)for(var r=Array.prototype.slice.call(arguments,2),i=0;n.length>i;++i)n[i].apply(null,r)}function Dr(t,e){function n(t){return function(){t.apply(null,i)}}var r=t._handlers&&t._handlers[e];if(r){var i=Array.prototype.slice.call(arguments,2);lo||(++ao,lo=[],setTimeout(Wr,0));for(var o=0;r.length>o;++o)lo.push(n(r[o]))}}function Wr(){--ao;var t=lo;lo=null;for(var e=0;t.length>e;++e)t[e]()}function Vr(t,e){var n=t._handlers&&t._handlers[e];return n&&n.length>0}function zr(){this.id=null}function Fr(t,e,n,r,i){null==e&&(e=t.search(/[^\s\u00a0]/),-1==e&&(e=t.length));for(var o=r||0,s=i||0;e>o;++o)"	"==t.charAt(o)?s+=n-s%n:++s;return s}function Br(t){for(;t>=ho.length;)ho.push(jr(ho)+" ");return ho[t]}function jr(t){return t[t.length-1]}function $r(t){Mi?(t.selectionStart=0,t.selectionEnd=t.value.length):t.select()}function qr(t,e){if(t.indexOf)return t.indexOf(e);for(var n=0,r=t.length;r>n;++n)if(t[n]==e)return n;return-1}function Ur(t,e){function n(){}n.prototype=t;var r=new n;return e&&Gr(e,r),r}function Gr(t,e){e||(e={});for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);return e}function Kr(t){for(var e=[],n=0;t>n;++n)e.push(void 0);return e}function Jr(t){var e=Array.prototype.slice.call(arguments,1);return function(){return t.apply(null,e)}}function Xr(t){return/\w/.test(t)||t>""&&(t.toUpperCase()!=t.toLowerCase()||fo.test(t))}function Yr(t){for(var e in t)if(t.hasOwnProperty(e)&&t[e])return!1;return!0}function Zr(t,e,n,r){var i=document.createElement(t);if(n&&(i.className=n),r&&(i.style.cssText=r),"string"==typeof e)ei(i,e);else if(e)for(var o=0;e.length>o;++o)i.appendChild(e[o]);return i}function Qr(t){for(var e=t.childNodes.length;e>0;--e)t.removeChild(t.firstChild);return t}function ti(t,e){return Qr(t).appendChild(e)}function ei(t,e){vi?(t.innerHTML="",t.appendChild(document.createTextNode(e))):t.textContent=e}function ni(t){return t.getBoundingClientRect()}function ri(t){if(null!=vo)return vo;var e=Zr("div",null,null,"width: 50px; height: 50px; overflow-x: scroll");return ti(t,e),e.offsetWidth&&(vo=e.offsetHeight-e.clientHeight),vo||0}function ii(t){if(null==yo){var e=Zr("span","");ti(t,Zr("span",[e,document.createTextNode("x")])),0!=t.firstChild.offsetHeight&&(yo=1>=e.offsetWidth&&e.offsetHeight>2&&!mi)}return yo?Zr("span",""):Zr("span","",null,"display: inline-block; width: 1px; margin-right: -1px")}function oi(t,e,n,r){if(!t)return r(e,n,"ltr");for(var i=0;t.length>i;++i){var o=t[i];(n>o.from&&o.to>e||e==n&&o.to==e)&&r(Math.max(o.from,e),Math.min(o.to,n),1==o.level?"rtl":"ltr")}}function si(t){return t.level%2?t.to:t.from}function li(t){return t.level%2?t.from:t.to}function ai(t){var e=mr(t);return e?si(e[0]):0}function ui(t){var e=mr(t);return e?li(jr(e)):t.text.length}function ci(t,e){var n=ur(t.doc,e),r=Rn(t.doc,n);r!=n&&(e=dr(r));var i=mr(r),o=i?i[0].level%2?ui(r):ai(r):0;return Fe(e,o)}function hi(t,e){for(var n,r;n=In(r=ur(t.doc,e));)e=n.find().to.line;var i=mr(r),o=i?i[0].level%2?ai(r):ui(r):r.text.length;return Fe(e,o)}function fi(t,e,n,r){var i=mr(t);if(!i)return di(t,e,n,r);for(var o=r?function(e,n){do e+=n;while(e>0&&po.test(t.text.charAt(e)));return e}:function(t,e){return t+e},s=i[0].level,l=0;i.length>l;++l){var a=i[l],u=a.level%2==s;if(e>a.from&&a.to>e||u&&(a.from==e||a.to==e))break}for(var c=o(e,a.level%2?-n:n);null!=c;)if(a.level%2==s){if(!(a.from>c||c>a.to))break;a=i[l+=n],c=a&&(n>0==a.level%2?o(a.to,-1):o(a.from,1))}else if(c==si(a))a=i[--l],c=a&&li(a);else{if(c!=li(a))break;a=i[++l],c=a&&si(a)}return 0>c||c>t.text.length?null:c}function di(t,e,n,r){var i=e+n;if(r)for(;i>0&&po.test(t.text.charAt(i));)i+=n;return 0>i||i>t.text.length?null:i}var pi=/gecko\/\d/i.test(navigator.userAgent),gi=/MSIE \d/.test(navigator.userAgent),mi=gi&&(null==document.documentMode||8>document.documentMode),vi=gi&&(null==document.documentMode||9>document.documentMode),yi=/WebKit\//.test(navigator.userAgent),_i=yi&&/Qt\/\d+\.\d+/.test(navigator.userAgent),wi=/Chrome\//.test(navigator.userAgent),bi=/Opera\//.test(navigator.userAgent),xi=/Apple Computer/.test(navigator.vendor),Ci=/KHTML\//.test(navigator.userAgent),ki=/Mac OS X 1\d\D([7-9]|\d\d)\D/.test(navigator.userAgent),Li=/Mac OS X 1\d\D([8-9]|\d\d)\D/.test(navigator.userAgent),Si=/PhantomJS/.test(navigator.userAgent),Mi=/AppleWebKit/.test(navigator.userAgent)&&/Mobile\/\w+/.test(navigator.userAgent),Ti=Mi||/Android|webOS|BlackBerry|Opera Mini|Opera Mobi|IEMobile/i.test(navigator.userAgent),Ei=Mi||/Mac/.test(navigator.platform),Ai=/windows/i.test(navigator.platform),Oi=bi&&navigator.userAgent.match(/Version\/(\d*\.\d*)/);
Oi&&(Oi=Number(Oi[1]));var Ni,Hi,Pi,Ii=Ei&&(_i||bi&&(null==Oi||12.11>Oi)),Ri=pi||gi&&!vi,Di=!1,Wi=!1,Vi=0,zi=0,Fi=null;gi?Fi=-.53:pi?Fi=15:wi?Fi=-.7:xi&&(Fi=-1/3);var Bi,ji,$i=null;t.Pos=Fe,t.prototype={focus:function(){window.focus(),ue(this),Me(this),se(this)},setOption:function(t,e){var n=this.options,r=n[t];(n[t]!=e||"mode"==t)&&(n[t]=e,qi.hasOwnProperty(t)&&ee(this,qi[t])(this,e,r))},getOption:function(t){return this.options[t]},getDoc:function(){return this.doc},addKeyMap:function(t,e){this.state.keyMaps[e?"push":"unshift"](t)},removeKeyMap:function(t){for(var e=this.state.keyMaps,n=0;e.length>n;++n)if(("string"==typeof t?e[n].name:e[n])==t)return e.splice(n,1),!0},addOverlay:ee(null,function(e,n){var r=e.token?e:t.getMode(this.options,e);if(r.startState)throw Error("Overlays may not be stateful.");this.state.overlays.push({mode:r,modeSpec:e,opaque:n&&n.opaque}),this.state.modeGen++,ie(this)}),removeOverlay:ee(null,function(t){for(var e=this.state.overlays,n=0;e.length>n;++n)if(e[n].modeSpec==t)return e.splice(n,1),this.state.modeGen++,ie(this),void 0}),indentLine:ee(null,function(t,e,n){"string"!=typeof e&&(e=null==e?this.options.smartIndent?"smart":"prev":e?"add":"subtract"),Ke(this.doc,t)&&ln(this,t,e,n)}),indentSelection:ee(null,function(t){var e=this.doc.sel;if(Be(e.from,e.to))return ln(this,e.from.line,t);for(var n=e.to.line-(e.to.ch?0:1),r=e.from.line;n>=r;++r)ln(this,r,t)}),getTokenAt:function(t){var e=this.doc;t=Ue(e,t);for(var n=P(this,t.line),r=this.doc.mode,i=ur(e,t.line),o=new wn(i.text,this.options.tabSize);o.pos<t.ch&&!o.eol();){o.start=o.pos;var s=r.token(o,n)}return{start:o.start,end:o.pos,string:o.current(),className:s||null,type:s||null,state:n}},getStateAfter:function(t){var e=this.doc;return t=qe(e,null==t?e.first+e.size-1:t),P(this,t+1)},cursorCoords:function(t,e){var n,r=this.doc.sel;return n=null==t?r.head:"object"==typeof t?Ue(this.doc,t):t?r.from:r.to,G(this,n,e||"page")},charCoords:function(t,e){return U(this,Ue(this.doc,t),e||"page")},coordsChar:function(t,e){return t=q(this,t,e||"page"),J(this,t.left,t.top)},defaultTextHeight:function(){return Y(this.display)},defaultCharWidth:function(){return Z(this.display)},setGutterMarker:ee(null,function(t,e,n){return an(this,t,function(t){var r=t.gutterMarkers||(t.gutterMarkers={});return r[e]=n,!n&&Yr(r)&&(t.gutterMarkers=null),!0})}),clearGutter:ee(null,function(t){var e=this,n=e.doc,r=n.first;n.iter(function(n){n.gutterMarkers&&n.gutterMarkers[t]&&(n.gutterMarkers[t]=null,ie(e,r,r+1),Yr(n.gutterMarkers)&&(n.gutterMarkers=null)),++r})}),addLineClass:ee(null,function(t,e,n){return an(this,t,function(t){var r="text"==e?"textClass":"background"==e?"bgClass":"wrapClass";if(t[r]){if(RegExp("\\b"+n+"\\b").test(t[r]))return!1;t[r]+=" "+n}else t[r]=n;return!0})}),removeLineClass:ee(null,function(t,e,n){return an(this,t,function(t){var r="text"==e?"textClass":"background"==e?"bgClass":"wrapClass",i=t[r];if(!i)return!1;if(null==n)t[r]=null;else{var o=i.replace(RegExp("^"+n+"\\b\\s*|\\s*\\b"+n+"\\b"),"");if(o==i)return!1;t[r]=o||null}return!0})}),addLineWidget:ee(null,function(t,e,n){return jn(this,t,e,n)}),removeLineWidget:function(t){t.clear()},lineInfo:function(t){if("number"==typeof t){if(!Ke(this.doc,t))return null;var e=t;if(t=ur(this.doc,t),!t)return null}else{var e=dr(t);if(null==e)return null}return{line:e,handle:t,text:t.text,gutterMarkers:t.gutterMarkers,textClass:t.textClass,bgClass:t.bgClass,wrapClass:t.wrapClass,widgets:t.widgets}},getViewport:function(){return{from:this.display.showingFrom,to:this.display.showingTo}},addWidget:function(t,e,n,r,i){var o=this.display;t=G(this,Ue(this.doc,t));var s=t.bottom,l=t.left;if(e.style.position="absolute",o.sizer.appendChild(e),"over"==r)s=t.top;else if("above"==r||"near"==r){var a=Math.max(o.wrapper.clientHeight,this.doc.height),u=Math.max(o.sizer.clientWidth,o.lineSpace.clientWidth);("above"==r||t.bottom+e.offsetHeight>a)&&t.top>e.offsetHeight?s=t.top-e.offsetHeight:a>=t.bottom+e.offsetHeight&&(s=t.bottom),l+e.offsetWidth>u&&(l=u-e.offsetWidth)}e.style.top=s+I(o)+"px",e.style.left=e.style.right="","right"==i?(l=o.sizer.clientWidth-e.offsetWidth,e.style.right="0px"):("left"==i?l=0:"middle"==i&&(l=(o.sizer.clientWidth-e.offsetWidth)/2),e.style.left=l+"px"),n&&nn(this,l,s,l+e.offsetWidth,s+e.offsetHeight)},triggerOnKeyDown:ee(null,Le),execCommand:function(t){return Zi[t](this)},findPosH:function(t,e,n,r){var i=1;0>e&&(i=-1,e=-e);for(var o=0,s=Ue(this.doc,t);e>o&&(s=un(this.doc,s,i,n,r),!s.hitSide);++o);return s},moveH:ee(null,function(t,e){var n,r=this.doc.sel;n=r.shift||r.extend||Be(r.from,r.to)?un(this.doc,r.head,t,e,this.options.rtlMoveVisually):0>t?r.from:r.to,Je(this.doc,n,n,t)}),deleteH:ee(null,function(t,e){var n=this.doc.sel;Be(n.from,n.to)?ze(this.doc,"",n.from,un(this.doc,n.head,t,e,!1),"+delete"):ze(this.doc,"",n.from,n.to,"+delete"),this.curOp.userSelChange=!0}),findPosV:function(t,e,n,r){var i=1,o=r;0>e&&(i=-1,e=-e);for(var s=0,l=Ue(this.doc,t);e>s;++s){var a=G(this,l,"div");if(null==o?o=a.left:a.left=o,l=cn(this,a,i,n),l.hitSide)break}return l},moveV:ee(null,function(t,e){var n=this.doc.sel,r=G(this,n.head,"div");null!=n.goalColumn&&(r.left=n.goalColumn);var i=cn(this,r,t,e);"page"==e&&sn(this,0,U(this,i,"div").top-r.top),Je(this.doc,i,i,t),n.goalColumn=r.left}),toggleOverwrite:function(){(this.state.overwrite=!this.state.overwrite)?this.display.cursor.className+=" CodeMirror-overwrite":this.display.cursor.className=this.display.cursor.className.replace(" CodeMirror-overwrite","")},hasFocus:function(){return this.state.focused},scrollTo:ee(null,function(t,e){on(this,t,e)}),getScrollInfo:function(){var t=this.display.scroller,e=uo;return{left:t.scrollLeft,top:t.scrollTop,height:t.scrollHeight-e,width:t.scrollWidth-e,clientHeight:t.clientHeight-e,clientWidth:t.clientWidth-e}},scrollIntoView:ee(null,function(t,e){"number"==typeof t&&(t=Fe(t,0)),e||(e=0);var n=t;t&&null==t.line||(this.curOp.scrollToPos=t?Ue(this.doc,t):this.doc.sel.head,this.curOp.scrollToPosMargin=e,n=G(this,this.curOp.scrollToPos));var r=rn(this,n.left,n.top-e,n.right,n.bottom+e);on(this,r.scrollLeft,r.scrollTop)}),setSize:function(t,e){function n(t){return"number"==typeof t||/^\d+$/.test(t+"")?t+"px":t}null!=t&&(this.display.wrapper.style.width=n(t)),null!=e&&(this.display.wrapper.style.height=n(e)),this.refresh()},on:function(t,e){Pr(this,t,e)},off:function(t,e){Ir(this,t,e)},operation:function(t){return re(this,t)},refresh:ee(null,function(){j(this),on(this,this.doc.scrollLeft,this.doc.scrollTop),ie(this)}),swapDoc:ee(null,function(t){var e=this.doc;return e.cm=null,ar(this,t),j(this),ae(this,!0),on(this,t.scrollLeft,t.scrollTop),e}),getInputField:function(){return this.display.input},getWrapperElement:function(){return this.display.wrapper},getScrollerElement:function(){return this.display.scroller},getGutterElement:function(){return this.display.gutters}};var qi=t.optionHandlers={},Ui=t.defaults={},Gi=t.Init={toString:function(){return"CodeMirror.Init"}};dn("value","",function(t,e){t.setValue(e)},!0),dn("mode",null,function(t,e){t.doc.modeOption=e,n(t)},!0),dn("indentUnit",2,n,!0),dn("indentWithTabs",!1),dn("smartIndent",!0),dn("tabSize",4,function(t){n(t),j(t),ie(t)},!0),dn("electricChars",!0),dn("rtlMoveVisually",!Ai),dn("theme","default",function(t){l(t),a(t)},!0),dn("keyMap","default",s),dn("extraKeys",null),dn("onKeyEvent",null),dn("onDragEvent",null),dn("lineWrapping",!1,r,!0),dn("gutters",[],function(t){f(t.options),a(t)},!0),dn("fixedGutter",!0,function(t,e){t.display.gutters.style.left=e?y(t.display)+"px":"0",t.refresh()},!0),dn("lineNumbers",!1,function(t){f(t.options),a(t)},!0),dn("firstLineNumber",1,a,!0),dn("lineNumberFormatter",function(t){return t},a,!0),dn("showCursorWhenSelecting",!1,M,!0),dn("readOnly",!1,function(t,e){"nocursor"==e?(Te(t),t.display.input.blur()):e||ae(t,!0)}),dn("dragDrop",!0),dn("cursorBlinkRate",530),dn("cursorHeight",1),dn("workTime",100),dn("workDelay",100),dn("flattenSpans",!0),dn("pollInterval",100),dn("undoDepth",40,function(t,e){t.doc.history.undoDepth=e}),dn("historyEventDelay",500),dn("viewportMargin",10,function(t){t.refresh()},!0),dn("maxHighlightLength",1e4,function(t){n(t),t.refresh()},!0),dn("moveInputWithCursor",!0,function(t,e){e||(t.display.inputDiv.style.top=t.display.inputDiv.style.left=0)}),dn("tabindex",null,function(t,e){t.display.input.tabIndex=e||""}),dn("autofocus",null);var Ki=t.modes={},Ji=t.mimeModes={};t.defineMode=function(e,n){if(t.defaults.mode||"null"==e||(t.defaults.mode=e),arguments.length>2){n.dependencies=[];for(var r=2;arguments.length>r;++r)n.dependencies.push(arguments[r])}Ki[e]=n},t.defineMIME=function(t,e){Ji[t]=e},t.resolveMode=function(e){if("string"==typeof e&&Ji.hasOwnProperty(e))e=Ji[e];else if("string"==typeof e&&/^[\w\-]+\/[\w\-]+\+xml$/.test(e))return t.resolveMode("application/xml");return"string"==typeof e?{name:e}:e||{name:"null"}},t.getMode=function(e,n){n=t.resolveMode(n);var r=Ki[n.name];if(!r)return t.getMode(e,"text/plain");var i=r(e,n);if(Xi.hasOwnProperty(n.name)){var o=Xi[n.name];for(var s in o)o.hasOwnProperty(s)&&(i.hasOwnProperty(s)&&(i["_"+s]=i[s]),i[s]=o[s])}return i.name=n.name,i},t.defineMode("null",function(){return{token:function(t){t.skipToEnd()}}}),t.defineMIME("text/plain","null");var Xi=t.modeExtensions={};t.extendMode=function(t,e){var n=Xi.hasOwnProperty(t)?Xi[t]:Xi[t]={};Gr(e,n)},t.defineExtension=function(e,n){t.prototype[e]=n},t.defineDocExtension=function(t,e){io.prototype[t]=e},t.defineOption=dn;var Yi=[];t.defineInitHook=function(t){Yi.push(t)},t.copyState=pn,t.startState=gn,t.innerMode=function(t,e){for(;t.innerMode;){var n=t.innerMode(e);e=n.state,t=n.mode}return n||{mode:t,state:e}};var Zi=t.commands={selectAll:function(t){t.setSelection(Fe(t.firstLine(),0),Fe(t.lastLine()))},killLine:function(t){var e=t.getCursor(!0),n=t.getCursor(!1),r=!Be(e,n);r||t.getLine(e.line).length!=e.ch?t.replaceRange("",e,r?n:Fe(e.line),"+delete"):t.replaceRange("",e,Fe(e.line+1,0),"+delete")},deleteLine:function(t){var e=t.getCursor().line;t.replaceRange("",Fe(e,0),Fe(e),"+delete")},undo:function(t){t.undo()},redo:function(t){t.redo()},goDocStart:function(t){t.extendSelection(Fe(t.firstLine(),0))},goDocEnd:function(t){t.extendSelection(Fe(t.lastLine()))},goLineStart:function(t){t.extendSelection(ci(t,t.getCursor().line))},goLineStartSmart:function(t){var e=t.getCursor(),n=ci(t,e.line),r=t.getLineHandle(n.line),i=mr(r);if(i&&0!=i[0].level)t.extendSelection(n);else{var o=Math.max(0,r.text.search(/\S/)),s=e.line==n.line&&o>=e.ch&&e.ch;t.extendSelection(Fe(n.line,s?0:o))}},goLineEnd:function(t){t.extendSelection(hi(t,t.getCursor().line))},goLineRight:function(t){var e=t.charCoords(t.getCursor(),"div").top+5;t.extendSelection(t.coordsChar({left:t.display.lineDiv.offsetWidth+100,top:e},"div"))},goLineLeft:function(t){var e=t.charCoords(t.getCursor(),"div").top+5;t.extendSelection(t.coordsChar({left:0,top:e},"div"))},goLineUp:function(t){t.moveV(-1,"line")},goLineDown:function(t){t.moveV(1,"line")},goPageUp:function(t){t.moveV(-1,"page")},goPageDown:function(t){t.moveV(1,"page")},goCharLeft:function(t){t.moveH(-1,"char")},goCharRight:function(t){t.moveH(1,"char")},goColumnLeft:function(t){t.moveH(-1,"column")},goColumnRight:function(t){t.moveH(1,"column")},goWordLeft:function(t){t.moveH(-1,"word")},goGroupRight:function(t){t.moveH(1,"group")},goGroupLeft:function(t){t.moveH(-1,"group")},goWordRight:function(t){t.moveH(1,"word")},delCharBefore:function(t){t.deleteH(-1,"char")},delCharAfter:function(t){t.deleteH(1,"char")},delWordBefore:function(t){t.deleteH(-1,"word")},delWordAfter:function(t){t.deleteH(1,"word")},delGroupBefore:function(t){t.deleteH(-1,"group")},delGroupAfter:function(t){t.deleteH(1,"group")},indentAuto:function(t){t.indentSelection("smart")},indentMore:function(t){t.indentSelection("add")},indentLess:function(t){t.indentSelection("subtract")},insertTab:function(t){t.replaceSelection("	","end","+input")},defaultTab:function(t){t.somethingSelected()?t.indentSelection("add"):t.replaceSelection("	","end","+input")},transposeChars:function(t){var e=t.getCursor(),n=t.getLine(e.line);e.ch>0&&e.ch<n.length-1&&t.replaceRange(n.charAt(e.ch)+n.charAt(e.ch-1),Fe(e.line,e.ch-1),Fe(e.line,e.ch+1))},newlineAndIndent:function(t){ee(t,function(){t.replaceSelection("\n","end","+input"),t.indentLine(t.getCursor().line,null,!0)})()},toggleOverwrite:function(t){t.toggleOverwrite()}},Qi=t.keyMap={};Qi.basic={Left:"goCharLeft",Right:"goCharRight",Up:"goLineUp",Down:"goLineDown",End:"goLineEnd",Home:"goLineStartSmart",PageUp:"goPageUp",PageDown:"goPageDown",Delete:"delCharAfter",Backspace:"delCharBefore",Tab:"defaultTab","Shift-Tab":"indentAuto",Enter:"newlineAndIndent",Insert:"toggleOverwrite"},Qi.pcDefault={"Ctrl-A":"selectAll","Ctrl-D":"deleteLine","Ctrl-Z":"undo","Shift-Ctrl-Z":"redo","Ctrl-Y":"redo","Ctrl-Home":"goDocStart","Alt-Up":"goDocStart","Ctrl-End":"goDocEnd","Ctrl-Down":"goDocEnd","Ctrl-Left":"goGroupLeft","Ctrl-Right":"goGroupRight","Alt-Left":"goLineStart","Alt-Right":"goLineEnd","Ctrl-Backspace":"delGroupBefore","Ctrl-Delete":"delGroupAfter","Ctrl-S":"save","Ctrl-F":"find","Ctrl-G":"findNext","Shift-Ctrl-G":"findPrev","Shift-Ctrl-F":"replace","Shift-Ctrl-R":"replaceAll","Ctrl-[":"indentLess","Ctrl-]":"indentMore",fallthrough:"basic"},Qi.macDefault={"Cmd-A":"selectAll","Cmd-D":"deleteLine","Cmd-Z":"undo","Shift-Cmd-Z":"redo","Cmd-Y":"redo","Cmd-Up":"goDocStart","Cmd-End":"goDocEnd","Cmd-Down":"goDocEnd","Alt-Left":"goGroupLeft","Alt-Right":"goGroupRight","Cmd-Left":"goLineStart","Cmd-Right":"goLineEnd","Alt-Backspace":"delGroupBefore","Ctrl-Alt-Backspace":"delGroupAfter","Alt-Delete":"delGroupAfter","Cmd-S":"save","Cmd-F":"find","Cmd-G":"findNext","Shift-Cmd-G":"findPrev","Cmd-Alt-F":"replace","Shift-Cmd-Alt-F":"replaceAll","Cmd-[":"indentLess","Cmd-]":"indentMore",fallthrough:["basic","emacsy"]},Qi["default"]=Ei?Qi.macDefault:Qi.pcDefault,Qi.emacsy={"Ctrl-F":"goCharRight","Ctrl-B":"goCharLeft","Ctrl-P":"goLineUp","Ctrl-N":"goLineDown","Alt-F":"goWordRight","Alt-B":"goWordLeft","Ctrl-A":"goLineStart","Ctrl-E":"goLineEnd","Ctrl-V":"goPageDown","Shift-Ctrl-V":"goPageUp","Ctrl-D":"delCharAfter","Ctrl-H":"delCharBefore","Alt-D":"delWordAfter","Alt-Backspace":"delWordBefore","Ctrl-K":"killLine","Ctrl-T":"transposeChars"},t.lookupKey=vn,t.isModifierKey=yn,t.keyName=_n,t.fromTextArea=function(e,n){function r(){e.value=u.getValue()}if(n||(n={}),n.value=e.value,!n.tabindex&&e.tabindex&&(n.tabindex=e.tabindex),!n.placeholder&&e.placeholder&&(n.placeholder=e.placeholder),null==n.autofocus){var i=document.body;try{i=document.activeElement}catch(o){}n.autofocus=i==e||null!=e.getAttribute("autofocus")&&i==document.body}if(e.form&&(Pr(e.form,"submit",r),!n.leaveSubmitMethodAlone)){var s=e.form,l=s.submit;try{var a=s.submit=function(){r(),s.submit=l,s.submit(),s.submit=a}}catch(o){}}e.style.display="none";var u=t(function(t){e.parentNode.insertBefore(t,e.nextSibling)},n);return u.save=r,u.getTextArea=function(){return e},u.toTextArea=function(){r(),e.parentNode.removeChild(u.getWrapperElement()),e.style.display="",e.form&&(Ir(e.form,"submit",r),"function"==typeof e.form.submit&&(e.form.submit=l))},u},wn.prototype={eol:function(){return this.pos>=this.string.length},sol:function(){return 0==this.pos},peek:function(){return this.string.charAt(this.pos)||void 0},next:function(){return this.pos<this.string.length?this.string.charAt(this.pos++):void 0},eat:function(t){var e=this.string.charAt(this.pos);if("string"==typeof t)var n=e==t;else var n=e&&(t.test?t.test(e):t(e));return n?(++this.pos,e):void 0},eatWhile:function(t){for(var e=this.pos;this.eat(t););return this.pos>e},eatSpace:function(){for(var t=this.pos;/[\s\u00a0]/.test(this.string.charAt(this.pos));)++this.pos;return this.pos>t},skipToEnd:function(){this.pos=this.string.length},skipTo:function(t){var e=this.string.indexOf(t,this.pos);return e>-1?(this.pos=e,!0):void 0},backUp:function(t){this.pos-=t},column:function(){return this.lastColumnPos<this.start&&(this.lastColumnValue=Fr(this.string,this.start,this.tabSize,this.lastColumnPos,this.lastColumnValue),this.lastColumnPos=this.start),this.lastColumnValue},indentation:function(){return Fr(this.string,null,this.tabSize)},match:function(t,e,n){if("string"!=typeof t){var r=this.string.slice(this.pos).match(t);return r&&r.index>0?null:(r&&e!==!1&&(this.pos+=r[0].length),r)}var i=function(t){return n?t.toLowerCase():t},o=this.string.substr(this.pos,t.length);return i(o)==i(t)?(e!==!1&&(this.pos+=t.length),!0):void 0},current:function(){return this.string.slice(this.start,this.pos)}},t.StringStream=wn,t.TextMarker=bn,bn.prototype.clear=function(){if(!this.explicitlyCleared){var t=this.doc.cm,e=t&&!t.curOp;e&&Q(t);for(var n=null,r=null,i=0;this.lines.length>i;++i){var o=this.lines[i],s=Ln(o.markedSpans,this);null!=s.to&&(r=dr(o)),o.markedSpans=Sn(o.markedSpans,s),null!=s.from?n=dr(o):this.collapsed&&!Dn(this.doc,o)&&t&&fr(o,Y(t.display))}if(t&&this.collapsed&&!t.options.lineWrapping)for(var i=0;this.lines.length>i;++i){var l=Rn(t.doc,this.lines[i]),a=c(t.doc,l);a>t.display.maxLineLength&&(t.display.maxLine=l,t.display.maxLineLength=a,t.display.maxLineChanged=!0)}null!=n&&t&&ie(t,n,r+1),this.lines.length=0,this.explicitlyCleared=!0,this.collapsed&&this.doc.cantEdit&&(this.doc.cantEdit=!1,t&&Ze(t)),e&&te(t),Dr(this,"clear")}},bn.prototype.find=function(){for(var t,e,n=0;this.lines.length>n;++n){var r=this.lines[n],i=Ln(r.markedSpans,this);if(null!=i.from||null!=i.to){var o=dr(r);null!=i.from&&(t=Fe(o,i.from)),null!=i.to&&(e=Fe(o,i.to))}}return"bookmark"==this.type?t:t&&{from:t,to:e}},bn.prototype.getOptions=function(t){var e=this.replacedWith;return{className:this.className,inclusiveLeft:this.inclusiveLeft,inclusiveRight:this.inclusiveRight,atomic:this.atomic,collapsed:this.collapsed,replacedWith:t?e&&e.cloneNode(!0):e,readOnly:this.readOnly,startStyle:this.startStyle,endStyle:this.endStyle}},bn.prototype.attachLine=function(t){if(!this.lines.length&&this.doc.cm){var e=this.doc.cm.curOp;e.maybeHiddenMarkers&&-1!=qr(e.maybeHiddenMarkers,this)||(e.maybeUnhiddenMarkers||(e.maybeUnhiddenMarkers=[])).push(this)}this.lines.push(t)},bn.prototype.detachLine=function(t){if(this.lines.splice(qr(this.lines,t),1),!this.lines.length&&this.doc.cm){var e=this.doc.cm.curOp;(e.maybeHiddenMarkers||(e.maybeHiddenMarkers=[])).push(this)}},t.SharedTextMarker=Cn,Cn.prototype.clear=function(){if(!this.explicitlyCleared){this.explicitlyCleared=!0;for(var t=0;this.markers.length>t;++t)this.markers[t].clear();Dr(this,"clear")}},Cn.prototype.find=function(){return this.primary.find()},Cn.prototype.getOptions=function(t){var e=this.primary.getOptions(t);return e.shared=!0,e};var to=t.LineWidget=function(t,e,n){for(var r in n)n.hasOwnProperty(r)&&(this[r]=n[r]);this.cm=t,this.node=e};to.prototype.clear=Fn(function(){var t=this.line.widgets,e=dr(this.line);if(null!=e&&t){for(var n=0;t.length>n;++n)t[n]==this&&t.splice(n--,1);t.length||(this.line.widgets=null),fr(this.line,Math.max(0,this.line.height-Bn(this))),ie(this.cm,e,e+1)}}),to.prototype.changed=Fn(function(){var t=this.height;this.height=null;var e=Bn(this)-t;if(e){fr(this.line,this.line.height+e);var n=dr(this.line);ie(this.cm,n,n+1)}});var eo={},no=/[\t\u0000-\u0019\u00ad\u200b\u2028\u2029\uFEFF]/g;or.prototype={chunkSize:function(){return this.lines.length},removeInner:function(t,e){for(var n=t,r=t+e;r>n;++n){var i=this.lines[n];this.height-=i.height,Un(i),Dr(i,"delete")}this.lines.splice(t,e)},collapse:function(t){t.splice.apply(t,[t.length,0].concat(this.lines))},insertInner:function(t,e,n){this.height+=n,this.lines=this.lines.slice(0,t).concat(e).concat(this.lines.slice(t));for(var r=0,i=e.length;i>r;++r)e[r].parent=this},iterN:function(t,e,n){for(var r=t+e;r>t;++t)if(n(this.lines[t]))return!0}},sr.prototype={chunkSize:function(){return this.size},removeInner:function(t,e){this.size-=e;for(var n=0;this.children.length>n;++n){var r=this.children[n],i=r.chunkSize();if(i>t){var o=Math.min(e,i-t),s=r.height;if(r.removeInner(t,o),this.height-=s-r.height,i==o&&(this.children.splice(n--,1),r.parent=null),0==(e-=o))break;t=0}else t-=i}if(25>this.size-e){var l=[];this.collapse(l),this.children=[new or(l)],this.children[0].parent=this}},collapse:function(t){for(var e=0,n=this.children.length;n>e;++e)this.children[e].collapse(t)},insertInner:function(t,e,n){this.size+=e.length,this.height+=n;for(var r=0,i=this.children.length;i>r;++r){var o=this.children[r],s=o.chunkSize();if(s>=t){if(o.insertInner(t,e,n),o.lines&&o.lines.length>50){for(;o.lines.length>50;){var l=o.lines.splice(o.lines.length-25,25),a=new or(l);o.height-=a.height,this.children.splice(r+1,0,a),a.parent=this}this.maybeSpill()}break}t-=s}},maybeSpill:function(){if(!(10>=this.children.length)){var t=this;do{var e=t.children.splice(t.children.length-5,5),n=new sr(e);if(t.parent){t.size-=n.size,t.height-=n.height;var r=qr(t.parent.children,t);t.parent.children.splice(r+1,0,n)}else{var i=new sr(t.children);i.parent=t,t.children=[i,n],t=i}n.parent=t.parent}while(t.children.length>10);t.parent.maybeSpill()}},iterN:function(t,e,n){for(var r=0,i=this.children.length;i>r;++r){var o=this.children[r],s=o.chunkSize();if(s>t){var l=Math.min(e,s-t);if(o.iterN(t,l,n))return!0;if(0==(e-=l))break;t=0}else t-=s}}};var ro=0,io=t.Doc=function(t,e,n){if(!(this instanceof io))return new io(t,e,n);null==n&&(n=0),sr.call(this,[new or([$n("",null)])]),this.first=n,this.scrollTop=this.scrollLeft=0,this.cantEdit=!1,this.history=vr(),this.frontier=n;var r=Fe(n,0);this.sel={from:r,to:r,head:r,anchor:r,shift:!1,extend:!1,goalColumn:null},this.id=++ro,this.modeOption=e,"string"==typeof t&&(t=_o(t)),ir(this,{from:r,to:r,text:t},null,{head:r,anchor:r})};io.prototype=Ur(sr.prototype,{iter:function(t,e,n){n?this.iterN(t-this.first,e-t,n):this.iterN(this.first,this.first+this.size,t)},insert:function(t,e){for(var n=0,r=0,i=e.length;i>r;++r)n+=e[r].height;this.insertInner(t-this.first,e,n)},remove:function(t,e){this.removeInner(t-this.first,e)},getValue:function(t){var e=hr(this,this.first,this.first+this.size);return t===!1?e:e.join(t||"\n")},setValue:function(t){var e=Fe(this.first,0),n=this.first+this.size-1;Pe(this,{from:e,to:Fe(n,ur(this,n).text.length),text:_o(t),origin:"setValue"},{head:e,anchor:e},!0)},replaceRange:function(t,e,n,r){e=Ue(this,e),n=n?Ue(this,n):e,ze(this,t,e,n,r)},getRange:function(t,e,n){var r=cr(this,Ue(this,t),Ue(this,e));return n===!1?r:r.join(n||"\n")},getLine:function(t){var e=this.getLineHandle(t);return e&&e.text},setLine:function(t,e){Ke(this,t)&&ze(this,e,Fe(t,0),Ue(this,Fe(t)))},removeLine:function(t){t?ze(this,"",Ue(this,Fe(t-1)),Ue(this,Fe(t))):ze(this,"",Fe(0,0),Ue(this,Fe(1,0)))},getLineHandle:function(t){return Ke(this,t)?ur(this,t):void 0},getLineNumber:function(t){return dr(t)},lineCount:function(){return this.size},firstLine:function(){return this.first},lastLine:function(){return this.first+this.size-1},clipPos:function(t){return Ue(this,t)},getCursor:function(t){var e,n=this.sel;return e=null==t||"head"==t?n.head:"anchor"==t?n.anchor:"end"==t||t===!1?n.to:n.from,$e(e)},somethingSelected:function(){return!Be(this.sel.head,this.sel.anchor)},setCursor:ne(function(t,e,n){var r=Ue(this,"number"==typeof t?Fe(t,e||0):t);n?Je(this,r):Ye(this,r,r)}),setSelection:ne(function(t,e){Ye(this,Ue(this,t),Ue(this,e||t))}),extendSelection:ne(function(t,e){Je(this,Ue(this,t),e&&Ue(this,e))}),getSelection:function(t){return this.getRange(this.sel.from,this.sel.to,t)},replaceSelection:function(t,e,n){Pe(this,{from:this.sel.from,to:this.sel.to,text:_o(t),origin:n},e||"around")},undo:ne(function(){Re(this,"undo")}),redo:ne(function(){Re(this,"redo")}),setExtending:function(t){this.sel.extend=t},historySize:function(){var t=this.history;return{undo:t.done.length,redo:t.undone.length}},clearHistory:function(){this.history=vr()},markClean:function(){this.history.dirtyCounter=0,this.history.lastOp=this.history.lastOrigin=null},isClean:function(){return 0==this.history.dirtyCounter},getHistory:function(){return{done:Cr(this.history.done),undone:Cr(this.history.undone)}},setHistory:function(t){var e=this.history=vr();e.done=t.done.slice(0),e.undone=t.undone.slice(0)},markText:function(t,e,n){return xn(this,Ue(this,t),Ue(this,e),n,"range")},setBookmark:function(t,e){var n={replacedWith:e&&(null==e.nodeType?e.widget:e),insertLeft:e&&e.insertLeft};return t=Ue(this,t),xn(this,t,t,n,"bookmark")},findMarksAt:function(t){t=Ue(this,t);var e=[],n=ur(this,t.line).markedSpans;if(n)for(var r=0;n.length>r;++r){var i=n[r];(null==i.from||i.from<=t.ch)&&(null==i.to||i.to>=t.ch)&&e.push(i.marker.parent||i.marker)}return e},getAllMarks:function(){var t=[];return this.iter(function(e){var n=e.markedSpans;if(n)for(var r=0;n.length>r;++r)null!=n[r].from&&t.push(n[r].marker)}),t},posFromIndex:function(t){var e,n=this.first;return this.iter(function(r){var i=r.text.length+1;return i>t?(e=t,!0):(t-=i,++n,void 0)}),Ue(this,Fe(n,e))},indexFromPos:function(t){t=Ue(this,t);var e=t.ch;return t.line<this.first||0>t.ch?0:(this.iter(this.first,t.line,function(t){e+=t.text.length+1}),e)},copy:function(t){var e=new io(hr(this,this.first,this.first+this.size),this.modeOption,this.first);return e.scrollTop=this.scrollTop,e.scrollLeft=this.scrollLeft,e.sel={from:this.sel.from,to:this.sel.to,head:this.sel.head,anchor:this.sel.anchor,shift:this.sel.shift,extend:!1,goalColumn:this.sel.goalColumn},t&&(e.history.undoDepth=this.history.undoDepth,e.setHistory(this.getHistory())),e},linkedDoc:function(t){t||(t={});var e=this.first,n=this.first+this.size;null!=t.from&&t.from>e&&(e=t.from),null!=t.to&&n>t.to&&(n=t.to);var r=new io(hr(this,e,n),t.mode||this.modeOption,e);return t.sharedHist&&(r.history=this.history),(this.linked||(this.linked=[])).push({doc:r,sharedHist:t.sharedHist}),r.linked=[{doc:this,isParent:!0,sharedHist:t.sharedHist}],r},unlinkDoc:function(e){if(e instanceof t&&(e=e.doc),this.linked)for(var n=0;this.linked.length>n;++n){var r=this.linked[n];if(r.doc==e){this.linked.splice(n,1),e.unlinkDoc(this);break}}if(e.history==this.history){var i=[e.id];lr(e,function(t){i.push(t.id)},!0),e.history=vr(),e.history.done=Cr(this.history.done,i),e.history.undone=Cr(this.history.undone,i)}},iterLinkedDocs:function(t){lr(this,t)},getMode:function(){return this.mode},getEditor:function(){return this.cm}}),io.prototype.eachLine=io.prototype.iter;var oo="iter insert remove copy getEditor".split(" ");for(var so in io.prototype)io.prototype.hasOwnProperty(so)&&0>qr(oo,so)&&(t.prototype[so]=function(t){return function(){return t.apply(this.doc,arguments)}}(io.prototype[so]));t.e_stop=Or,t.e_preventDefault=Er,t.e_stopPropagation=Ar;var lo,ao=0;t.on=Pr,t.off=Ir,t.signal=Rr;var uo=30,co=t.Pass={toString:function(){return"CodeMirror.Pass"}};zr.prototype={set:function(t,e){clearTimeout(this.id),this.id=setTimeout(e,t)}},t.countColumn=Fr;var ho=[""],fo=/[\u3040-\u309f\u30a0-\u30ff\u3400-\u4db5\u4e00-\u9fcc]/,po=/[\u0300-\u036F\u0483-\u0487\u0488-\u0489\u0591-\u05BD\u05BF\u05C1-\u05C2\u05C4-\u05C5\u05C7\u0610-\u061A\u064B-\u065F\u0670\u06D6-\u06DC\u06DF-\u06E4\u06E7-\u06E8\u06EA-\u06ED\uA66F\uA670-\uA672\uA674-\uA67D\uA69F\udc00-\udfff]/;t.replaceGetRect=function(t){ni=t};var go=function(){if(vi)return!1;var t=Zr("div");return"draggable"in t||"dragDrop"in t}(),mo=/^$/;pi?mo=/$'/:xi&&!/Version\/([6-9]|\d\d)\b/.test(navigator.userAgent)?mo=/\-[^ \-?]|\?[^ !'\"\),.\-\/:;\?\]\}]/:yi&&(mo=/[~!#%&*)=+}\]|\"\.>,:;][({[<]|-[^\-?\.]|\?[\w~`@#$%\^&*(_=+{[|><]/);var vo,yo,_o=3!="\n\nb".split(/\n/).length?function(t){for(var e=0,n=[],r=t.length;r>=e;){var i=t.indexOf("\n",e);-1==i&&(i=t.length);var o=t.slice(e,"\r"==t.charAt(i-1)?i-1:i),s=o.indexOf("\r");-1!=s?(n.push(o.slice(0,s)),e+=s+1):(n.push(o),e=i+1)}return n}:function(t){return t.split(/\r\n?|\n/)};t.splitLines=_o;var wo=window.getSelection?function(t){try{return t.selectionStart!=t.selectionEnd}catch(e){return!1}}:function(t){try{var e=t.ownerDocument.selection.createRange()}catch(n){}return e&&e.parentElement()==t?0!=e.compareEndPoints("StartToEnd",e):!1},bo=function(){var t=Zr("div");return"oncopy"in t?!0:(t.setAttribute("oncopy","return;"),"function"==typeof t.oncopy)}(),xo={3:"Enter",8:"Backspace",9:"Tab",13:"Enter",16:"Shift",17:"Ctrl",18:"Alt",19:"Pause",20:"CapsLock",27:"Esc",32:"Space",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"Left",38:"Up",39:"Right",40:"Down",44:"PrintScrn",45:"Insert",46:"Delete",59:";",91:"Mod",92:"Mod",93:"Mod",109:"-",107:"=",127:"Delete",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'",63276:"PageUp",63277:"PageDown",63275:"End",63273:"Home",63234:"Left",63232:"Up",63235:"Right",63233:"Down",63302:"Insert",63272:"Delete"};t.keyNames=xo,function(){for(var t=0;10>t;t++)xo[t+48]=t+"";for(var t=65;90>=t;t++)xo[t]=String.fromCharCode(t);for(var t=1;12>=t;t++)xo[t+111]=xo[t+63235]="F"+t}();var Co=function(){function t(t){return 255>=t?e.charAt(t):t>=1424&&1524>=t?"R":t>=1536&&1791>=t?n.charAt(t-1536):t>=1792&&2220>=t?"r":"L"}var e="bbbbbbbbbtstwsbbbbbbbbbbbbbbssstwNN%%%NNNNNN,N,N1111111111NNNNNNNLLLLLLLLLLLLLLLLLLLLLLLLLLNNNNNNLLLLLLLLLLLLLLLLLLLLLLLLLLNNNNbbbbbbsbbbbbbbbbbbbbbbbbbbbbbbbbb,N%%%%NNNNLNNNNN%%11NLNNN1LNNNNNLLLLLLLLLLLLLLLLLLLLLLLNLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLNLLLLLLLL",n="rrrrrrrrrrrr,rNNmmmmmmrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrmmmmmmmmmmmmmmrrrrrrrnnnnnnnnnn%nnrrrmrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrmmmmmmmmmmmmmmmmmmmNmmmmrrrrrrrrrrrrrrrrrr",r=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac]/,i=/[stwN]/,o=/[LRr]/,s=/[Lb1n]/,l=/[1n]/,a="L";return function(e){if(!r.test(e))return!1;for(var n,u=e.length,c=[],h=0;u>h;++h)c.push(n=t(e.charCodeAt(h)));for(var h=0,f=a;u>h;++h){var n=c[h];"m"==n?c[h]=f:f=n}for(var h=0,d=a;u>h;++h){var n=c[h];"1"==n&&"r"==d?c[h]="n":o.test(n)&&(d=n,"r"==n&&(c[h]="R"))}for(var h=1,f=c[0];u-1>h;++h){var n=c[h];"+"==n&&"1"==f&&"1"==c[h+1]?c[h]="1":","!=n||f!=c[h+1]||"1"!=f&&"n"!=f||(c[h]=f),f=n}for(var h=0;u>h;++h){var n=c[h];if(","==n)c[h]="N";else if("%"==n){for(var p=h+1;u>p&&"%"==c[p];++p);for(var g=h&&"!"==c[h-1]||u-1>p&&"1"==c[p]?"1":"N",m=h;p>m;++m)c[m]=g;h=p-1}}for(var h=0,d=a;u>h;++h){var n=c[h];"L"==d&&"1"==n?c[h]="L":o.test(n)&&(d=n)}for(var h=0;u>h;++h)if(i.test(c[h])){for(var p=h+1;u>p&&i.test(c[p]);++p);for(var v="L"==(h?c[h-1]:a),y="L"==(u-1>p?c[p]:a),g=v||y?"L":"R",m=h;p>m;++m)c[m]=g;h=p-1}for(var _,w=[],h=0;u>h;)if(s.test(c[h])){var b=h;for(++h;u>h&&s.test(c[h]);++h);w.push({from:b,to:h,level:0})}else{var x=h,C=w.length;for(++h;u>h&&"L"!=c[h];++h);for(var m=x;h>m;)if(l.test(c[m])){m>x&&w.splice(C,0,{from:x,to:m,level:1});var k=m;for(++m;h>m&&l.test(c[m]);++m);w.splice(C,0,{from:k,to:m,level:2}),x=m}else++m;h>x&&w.splice(C,0,{from:x,to:h,level:1})}return 1==w[0].level&&(_=e.match(/^\s+/))&&(w[0].from=_[0].length,w.unshift({from:0,to:_[0].length,level:0})),1==jr(w).level&&(_=e.match(/\s+$/))&&(jr(w).to-=_[0].length,w.push({from:u-_[0].length,to:u,level:0})),w[0].level!=jr(w).level&&w.push({from:u,to:u,level:w[0].level}),w}}();return t.version="3.11 +",t}();(function(){"use strict";var t=/^(\s*)([*+-]|(\d+)\.)(\s*)/,e="*+-";o.commands.newlineAndIndentContinueMarkdownList=function(n){var r,i=n.getCursor(),o=n.getStateAfter(i.line).list;if(!o||!(r=n.getLine(i.line).match(t)))return n.execCommand("newlineAndIndent"),void 0;var s=r[1],l=r[4],a=e.indexOf(r[2])>=0?r[2]:parseInt(r[3],10)+1+".";n.replaceSelection("\n"+s+a+l,"end")}})(),o.defineMode("xml",function(t,e){function n(t,e){function n(n){return e.tokenize=n,n(t,e)}var i=t.next();if("<"==i){if(t.eat("!"))return t.eat("[")?t.match("CDATA[")?n(o("atom","]]>")):null:t.match("--")?n(o("comment","-->")):t.match("DOCTYPE",!0,!0)?(t.eatWhile(/[\w\._\-]/),n(s(1))):null;if(t.eat("?"))return t.eatWhile(/[\w\._\-]/),e.tokenize=o("meta","?>"),"meta";var l=t.eat("/");_="";for(var a;a=t.eat(/[^\s\u00a0=<>\"\'\/?]/);)_+=a;return _?(w=l?"closeTag":"openTag",e.tokenize=r,"tag"):"error"}if("&"==i){var u;
return u=t.eat("#")?t.eat("x")?t.eatWhile(/[a-fA-F\d]/)&&t.eat(";"):t.eatWhile(/[\d]/)&&t.eat(";"):t.eatWhile(/[\w\.\-:]/)&&t.eat(";"),u?"atom":"error"}return t.eatWhile(/[^&<]/),null}function r(t,e){var r=t.next();return">"==r||"/"==r&&t.eat(">")?(e.tokenize=n,w=">"==r?"endTag":"selfcloseTag","tag"):"="==r?(w="equals",null):/[\'\"]/.test(r)?(e.tokenize=i(r),e.tokenize(t,e)):(t.eatWhile(/[^\s\u00a0=<>\"\']/),"word")}function i(t){return function(e,n){for(;!e.eol();)if(e.next()==t){n.tokenize=r;break}return"string"}}function o(t,e){return function(r,i){for(;!r.eol();){if(r.match(e)){i.tokenize=n;break}r.next()}return t}}function s(t){return function(e,r){for(var i;null!=(i=e.next());){if("<"==i)return r.tokenize=s(t+1),r.tokenize(e,r);if(">"==i){if(1==t){r.tokenize=n;break}return r.tokenize=s(t-1),r.tokenize(e,r)}}return"meta"}}function l(){for(var t=arguments.length-1;t>=0;t--)b.cc.push(arguments[t])}function a(){return l.apply(null,arguments),!0}function u(t,e){var n=S.doNotIndent.hasOwnProperty(t)||b.context&&b.context.noIndent;b.context={prev:b.context,tagName:t,indent:b.indented,startOfLine:e,noIndent:n}}function c(){b.context&&(b.context=b.context.prev)}function h(t){if("openTag"==t)return b.tagName=_,b.tagStart=x.column(),a(g,f(b.startOfLine));if("closeTag"==t){var e=!1;return b.context?b.context.tagName!=_&&(S.implicitlyClosed.hasOwnProperty(b.context.tagName.toLowerCase())&&c(),e=!b.context||b.context.tagName!=_):e=!0,e&&(C="error"),a(d(e))}return a()}function f(t){return function(e){var n=b.tagName;return b.tagName=b.tagStart=null,"selfcloseTag"==e||"endTag"==e&&S.autoSelfClosers.hasOwnProperty(n.toLowerCase())?(p(n.toLowerCase()),a()):"endTag"==e?(p(n.toLowerCase()),u(n,t),a()):a()}}function d(t){return function(e){return t&&(C="error"),"endTag"==e?(c(),a()):(C="error",a(arguments.callee))}}function p(t){for(var e;;){if(!b.context)return;if(e=b.context.tagName.toLowerCase(),!S.contextGrabbers.hasOwnProperty(e)||!S.contextGrabbers[e].hasOwnProperty(t))return;c()}}function g(t){return"word"==t?(C="attribute",a(m,g)):"endTag"==t||"selfcloseTag"==t?l():(C="error",a(g))}function m(t){return"equals"==t?a(v,g):(S.allowMissing?"word"==t&&(C="attribute"):C="error","endTag"==t||"selfcloseTag"==t?l():a())}function v(t){return"string"==t?a(y):"word"==t&&S.allowUnquoted?(C="string",a()):(C="error","endTag"==t||"selfCloseTag"==t?l():a())}function y(t){return"string"==t?a(y):l()}var _,w,b,x,C,k=t.indentUnit,L=e.multilineTagIndentFactor||1,S=e.htmlMode?{autoSelfClosers:{area:!0,base:!0,br:!0,col:!0,command:!0,embed:!0,frame:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0},implicitlyClosed:{dd:!0,li:!0,optgroup:!0,option:!0,p:!0,rp:!0,rt:!0,tbody:!0,td:!0,tfoot:!0,th:!0,tr:!0},contextGrabbers:{dd:{dd:!0,dt:!0},dt:{dd:!0,dt:!0},li:{li:!0},option:{option:!0,optgroup:!0},optgroup:{optgroup:!0},p:{address:!0,article:!0,aside:!0,blockquote:!0,dir:!0,div:!0,dl:!0,fieldset:!0,footer:!0,form:!0,h1:!0,h2:!0,h3:!0,h4:!0,h5:!0,h6:!0,header:!0,hgroup:!0,hr:!0,menu:!0,nav:!0,ol:!0,p:!0,pre:!0,section:!0,table:!0,ul:!0},rp:{rp:!0,rt:!0},rt:{rp:!0,rt:!0},tbody:{tbody:!0,tfoot:!0},td:{td:!0,th:!0},tfoot:{tbody:!0},th:{td:!0,th:!0},thead:{tbody:!0,tfoot:!0},tr:{tr:!0}},doNotIndent:{pre:!0},allowUnquoted:!0,allowMissing:!0}:{autoSelfClosers:{},implicitlyClosed:{},contextGrabbers:{},doNotIndent:{},allowUnquoted:!1,allowMissing:!1},M=e.alignCDATA;return{startState:function(){return{tokenize:n,cc:[],indented:0,startOfLine:!0,tagName:null,tagStart:null,context:null}},token:function(t,e){if(!e.tagName&&t.sol()&&(e.startOfLine=!0,e.indented=t.indentation()),t.eatSpace())return null;C=w=_=null;var n=e.tokenize(t,e);if(e.type=w,(n||w)&&"comment"!=n)for(b=e,x=t;;){var r=e.cc.pop()||h;if(r(w||n))break}return e.startOfLine=!1,C||n},indent:function(t,e,i){var o=t.context;if(t.tokenize!=r&&t.tokenize!=n||o&&o.noIndent)return i?i.match(/^(\s*)/)[0].length:0;if(t.tagName)return t.tagStart+k*L;if(M&&/<!\[CDATA\[/.test(e))return 0;for(o&&/^<\//.test(e)&&(o=o.prev);o&&!o.startOfLine;)o=o.prev;return o?o.indent+k:0},electricChars:"/",configuration:e.htmlMode?"html":"xml"}}),o.defineMIME("text/xml","xml"),o.defineMIME("application/xml","xml"),o.mimeModes.hasOwnProperty("text/html")||o.defineMIME("text/html",{name:"xml",htmlMode:!0}),o.defineMode("markdown",function(t,e){function n(t,e,n){return e.f=e.inline=n,n(t,e)}function r(t,e,n){return e.f=e.block=n,n(t,e)}function i(t){return t.linkTitle=!1,t.em=!1,t.strong=!1,t.quote=0,v||t.f!=l||(t.f=h,t.block=s),t.thisLineHasContent=!1,null}function s(t,i){var o=i.list!==!1;if(i.list!==!1&&i.indentationDiff>=0?(4>i.indentationDiff&&(i.indentation-=i.indentationDiff),i.list=null):i.list!==!1&&i.indentation>0?(i.list=null,i.listDepth=Math.floor(i.indentation/4)):i.list!==!1&&(i.list=!1,i.listDepth=0),i.indentationDiff>=4)return i.indentation-=4,t.skipToEnd(),C;if(t.eatSpace())return null;if("#"===t.peek()||i.prevLineHasContent&&t.match(F))i.header=!0;else if(t.eat(">"))for(i.indentation++,i.quote=1,t.eatSpace();t.eat(">");)t.eatSpace(),i.quote++;else{if("["===t.peek())return n(t,i,d);if(t.match(D,!0))return E;if(i.prevLineHasContent&&!o||!t.match(W,!0)&&!t.match(V,!0)){if(e.fencedCodeBlocks&&t.match(/^```([\w+#]*)/,!0))return i.localMode=w(RegExp.$1),i.localMode&&(i.localState=i.localMode.startState()),r(t,i,a),C}else i.indentation+=4,i.list=!0,i.listDepth++,e.taskLists&&t.match(z,!1)&&(i.taskList=!0)}return n(t,i,i.inline)}function l(t,e){var n=y.token(t,e.htmlState);return v&&"tag"===n&&"openTag"!==e.htmlState.type&&!e.htmlState.context&&(e.f=h,e.block=s),e.md_inside&&-1!=t.current().indexOf(">")&&(e.f=h,e.block=s,e.htmlState.context=void 0),n}function a(t,e){return t.sol()&&t.match(/^```/,!0)?(e.localMode=e.localState=null,e.f=h,e.block=s,C):e.localMode?e.localMode.token(t,e.localState):(t.skipToEnd(),C)}function u(t){var e=[];if(t.taskOpen)return"meta";if(t.taskClosed)return"property";if(t.strong&&e.push(R),t.em&&e.push(I),t.linkText&&e.push(H),t.code&&e.push(C),t.header&&e.push(x),t.quote&&e.push(t.quote%2?k:L),t.list!==!1){var n=(t.listDepth-1)%3;n?1===n?e.push(M):e.push(T):e.push(S)}return e.length?e.join(" "):null}function c(t,e){return t.match(B,!0)?u(e):void 0}function h(t,i){var o=i.text(t,i);if(o!==void 0)return o;if(i.list)return i.list=null,u(i);if(i.taskList){var s="x"!==t.match(z,!0)[1];return s?i.taskOpen=!0:i.taskClosed=!0,i.taskList=!1,u(i)}i.taskOpen=!1,i.taskClosed=!1;var a=t.next();if("\\"===a)return t.next(),u(i);if(i.linkTitle){i.linkTitle=!1;var c=a;"("===a&&(c=")"),c=(c+"").replace(/([.?*+^$[\]\\(){}|-])/g,"\\$1");var h="^\\s*(?:[^"+c+"\\\\]+|\\\\\\\\|\\\\.)"+c;if(t.match(RegExp(h),!0))return P}if("`"===a){var d=u(i),p=t.pos;t.eatWhile("`");var g=1+t.pos-p;return i.code?g===b?(i.code=!1,d):u(i):(b=g,i.code=!0,u(i))}if(i.code)return u(i);if("!"===a&&t.match(/\[[^\]]*\] ?(?:\(|\[)/,!1))return t.match(/\[[^\]]*\]/),i.inline=i.f=f,A;if("["===a&&t.match(/.*\](\(| ?\[)/,!1))return i.linkText=!0,u(i);if("]"===a&&i.linkText){var v=u(i);return i.linkText=!1,i.inline=i.f=f,v}if("<"===a&&t.match(/^(https?|ftps?):\/\/(?:[^\\>]|\\.)+>/,!0))return n(t,i,m(O,">"));if("<"===a&&t.match(/^[^> \\]+@(?:[^\\>]|\\.)+>/,!0))return n(t,i,m(N,">"));if("<"===a&&t.match(/^\w/,!1)){if(-1!=t.string.indexOf(">")){var y=t.string.substring(1,t.string.indexOf(">"));/markdown\s*=\s*('|"){0,1}1('|"){0,1}/.test(y)&&(i.md_inside=!0)}return t.backUp(1),r(t,i,l)}if("<"===a&&t.match(/^\/\w*?>/))return i.md_inside=!1,"tag";var _=!1;if(!e.underscoresBreakWords&&"_"===a&&"_"!==t.peek()&&t.match(/(\w)/,!1)){var w=t.pos-2;if(w>=0){var x=t.string.charAt(w);"_"!==x&&x.match(/(\w)/,!1)&&(_=!0)}}var d=u(i);if("*"===a||"_"===a&&!_){if(i.strong===a&&t.eat(a))return i.strong=!1,d;if(!i.strong&&t.eat(a))return i.strong=a,u(i);if(i.em===a)return i.em=!1,d;if(!i.em)return i.em=a,u(i)}else if(" "===a&&(t.eat("*")||t.eat("_"))){if(" "===t.peek())return u(i);t.backUp(1)}return u(i)}function f(t,e){if(t.eatSpace())return null;var r=t.next();return"("===r||"["===r?n(t,e,m(P,"("===r?")":"]")):"error"}function d(t,e){return t.match(/^[^\]]*\]:/,!0)?(e.f=p,H):n(t,e,h)}function p(t,e){return t.eatSpace()?null:(t.match(/^[^\s]+/,!0),void 0===t.peek()?e.linkTitle=!0:t.match(/^(?:\s+(?:"(?:[^"\\]|\\\\|\\.)+"|'(?:[^'\\]|\\\\|\\.)+'|\((?:[^)\\]|\\\\|\\.)+\)))?/,!0),e.f=e.inline=h,P)}function g(t){return j[t]||(t=(t+"").replace(/([.?*+^$[\]\\(){}|-])/g,"\\$1"),j[t]=RegExp("^(?:[^\\\\]|\\\\.)*?("+t+")")),j[t]}function m(t,e,n){return n=n||h,function(r,i){return r.match(g(e)),i.inline=i.f=n,t}}var v=o.mimeModes.hasOwnProperty("text/html"),y=o.getMode(t,v?"text/html":"text/plain"),_={html:"htmlmixed",js:"javascript",json:"application/json",c:"text/x-csrc","c++":"text/x-c++src",java:"text/x-java",csharp:"text/x-csharp","c#":"text/x-csharp",scala:"text/x-scala"},w=function(){var e,n,r={},i={},s=[];for(var l in o.modes)o.modes.propertyIsEnumerable(l)&&s.push(l);for(e=0;s.length>e;e++)r[s[e]]=s[e];var a=[];for(var l in o.mimeModes)o.mimeModes.propertyIsEnumerable(l)&&a.push({mime:l,mode:o.mimeModes[l]});for(e=0;a.length>e;e++)n=a[e].mime,i[n]=a[e].mime;for(var u in _)(_[u]in r||_[u]in i)&&(r[u]=_[u]);return function(e){return r[e]?o.getMode(t,r[e]):null}}();void 0===e.underscoresBreakWords&&(e.underscoresBreakWords=!0),void 0===e.fencedCodeBlocks&&(e.fencedCodeBlocks=!1),void 0===e.taskLists&&(e.taskLists=!1);var b=0,x="header",C="comment",k="atom",L="number",S="variable-2",M="variable-3",T="keyword",E="hr",A="tag",O="link",N="link",H="link",P="string",I="em",R="strong",D=/^([*\-=_])(?:\s*\1){2,}\s*$/,W=/^[*\-+]\s+/,V=/^[0-9]+\.\s+/,z=/^\[(x| )\](?=\s)/,F=/^(?:\={1,}|-{1,})$/,B=/^[^!\[\]*_\\<>` "'(]+/,j=[];return{startState:function(){return{f:s,prevLineHasContent:!1,thisLineHasContent:!1,block:s,htmlState:o.startState(y),indentation:0,inline:h,text:c,linkText:!1,linkTitle:!1,em:!1,strong:!1,header:!1,taskList:!1,list:!1,listDepth:0,quote:0}},copyState:function(t){return{f:t.f,prevLineHasContent:t.prevLineHasContent,thisLineHasContent:t.thisLineHasContent,block:t.block,htmlState:o.copyState(y,t.htmlState),indentation:t.indentation,localMode:t.localMode,localState:t.localMode?o.copyState(t.localMode,t.localState):null,inline:t.inline,text:t.text,linkTitle:t.linkTitle,em:t.em,strong:t.strong,header:t.header,taskList:t.taskList,list:t.list,listDepth:t.listDepth,quote:t.quote,md_inside:t.md_inside}},token:function(t,e){if(t.sol()){if(t.match(/^\s*$/,!0))return e.prevLineHasContent=!1,i(e);e.prevLineHasContent=e.thisLineHasContent,e.thisLineHasContent=!0,e.header=!1,e.taskList=!1,e.code=!1,e.f=e.block;var n=t.match(/^\s*/,!0)[0].replace(/\t/g,"    ").length,r=4*Math.floor((n-e.indentation)/4);r>4&&(r=4);var o=e.indentation+r;if(e.indentationDiff=o-e.indentation,e.indentation=o,n>0)return null}return e.f(t,e)},blankLine:i,getType:u}},"xml"),o.defineMIME("text/x-markdown","markdown");var s={bold:"Cmd-B",italic:"Cmd-I",link:"Cmd-K",image:"Cmd-Alt-I",quote:"Cmd-'","ordered-list":"Cmd-Alt-L","unordered-list":"Cmd-L"},l=["bold","italic","|","quote","unordered-list","ordered-list","|","link","image","|","undo","redo","|",{name:"info",action:"http://lab.lepture.com/editor/markdown"},"preview","fullscreen"],a=/Mac/.test(navigator.platform);e.prototype.init=function(t){t=t||{},t.element&&(this.element=t.element),t.toolbar=t.toolbar||l,t.hasOwnProperty("status")||(t.status=["lines","words","cursor"]),this.options=t},e.prototype.render=function(t){t||(t=this.element||document.getElementsByTagName("textarea")[0]),this.element=t;var e=this.options,n=this,i={};for(var l in s)(function(t){i[r(s[t])]=function(e){n.action(t,e)}})(l);i.Enter="newlineAndIndentContinueMarkdownList",this.codemirror=o.fromTextArea(t,{mode:"markdown",theme:"paper",indentWithTabs:!0,lineNumbers:!1,extraKeys:i}),e.toolbar!==!1&&this.createToolbar(),e.status!==!1&&this.createStatusbar()},e.prototype.createToolbar=function(t){if(t=t||this.options.toolbar,t&&0!==t.length){var e=document.createElement("div");e.className="editor-toolbar";var r,i=this;i.toolbar={};for(var o=0;t.length>o;o++)(function(t){var n,o,s,l;t.name?(n=t.name,o=t.shortcut,s=t.action,l=t.className):n=t,r=u(n,{className:l,shortcut:o}),s?"function"==typeof s?r.onclick=s:"string"==typeof s&&(r.href=s,r.target="_blank"):r.onclick=function(){return i.action(n)},i.toolbar[n]=r,e.appendChild(r)})(t[o]);var s=this.codemirror;s.on("cursorActivity",function(){var t=n(s);for(var e in i.toolbar)(function(e){var n=i.toolbar[e];t[e]?n.classList.add("active"):n.classList.remove("active")})(e)});var l=s.getWrapperElement();return l.parentNode.insertBefore(e,l),e}},e.prototype.createStatusbar=function(t){if(t=t||this.options.status,t&&0!==t.length){var e=document.createElement("div");e.className="editor-statusbar";for(var n,r=this.codemirror,i=0;t.length>i;i++)(function(t){var i=document.createElement("span");i.className=t,"words"===t?(i.innerHTML="0",r.on("update",function(){i.innerHTML=r.getValue().length})):"lines"===t?(i.innerHTML="0",r.on("update",function(){i.innerHTML=r.lineCount()})):"cursor"===t&&(i.innerHTML="0:0",r.on("cursorActivity",function(){n=r.getCursor(),i.innerHTML=n.line+":"+n.ch})),e.appendChild(i)})(t[i]);var o=this.codemirror.getWrapperElement();return o.parentNode.insertBefore(e,o.nextSibling),e}},e.prototype.action=function(t,e){if(e=e||this.codemirror){var r=n(e),o=function(n,i){var o,s=e.getCursor("start"),l=e.getCursor("end");return r[t]?(o=e.getLine(s.line),n=o.slice(0,s.ch),i=o.slice(s.ch),"bold"===t?(n=n.replace(/^(.*)?(\*|\_){2}(\S+.*)?$/,"$1$3"),i=i.replace(/^(.*\S+)?(\*|\_){2}(\s+.*)?$/,"$1$3"),s.ch-=2,l.ch-=2):"italic"===t&&(n=n.replace(/^(.*)?(\*|\_)(\S+.*)?$/,"$1$3"),i=i.replace(/^(.*\S+)?(\*|\_)(\s+.*)?$/,"$1$3"),s.ch-=1,l.ch-=1),e.setLine(s.line,n+i),e.setSelection(s,l),e.focus(),void 0):(i=null===i?"":i||n,o=e.getSelection(),e.replaceSelection(n+o+i),s.ch+=n.length,l.ch+=n.length,e.setSelection(s,l),e.focus(),void 0)},s=function(){for(var n=e.getCursor("start"),i=e.getCursor("end"),o={quote:/^(\s*)\>\s+/,"unordered-list":/^(\s*)(\*|\-|\+)\s+/,"ordered-list":/^(\s*)\d+\.\s+/},s={quote:"> ","unordered-list":"* ","ordered-list":"1. "},l=n.line;i.line>=l;l++)(function(n){var i=e.getLine(n);i=r[t]?i.replace(o[t],"$1"):s[t]+i,e.setLine(n,i)})(l);e.focus()};switch(t){case"bold":o("**");break;case"italic":o("*");break;case"link":o("[","](http://)");break;case"image":o("![","](http://)");break;case"quote":case"unordered-list":case"ordered-list":s();break;case"undo":e.undo(),e.focus();break;case"redo":e.redo(),e.focus();break;case"fullscreen":i(e.getWrapperElement())}}};var u=function(t,e){e=e||{};var n;if("|"===t)return n=document.createElement("i"),n.className="separator",n.innerHTML="|",n;n=document.createElement("a");var i=e.shortcut||s[t];return i&&(i=r(i),n.title=i,n.title=n.title.replace("Cmd",""),a&&(n.title=n.title.replace("Alt",""))),n.className=e.className||"icon-"+t,n};t.Editor=e})(this);